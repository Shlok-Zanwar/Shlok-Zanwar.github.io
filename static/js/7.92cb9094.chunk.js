/*! For license information please see 7.92cb9094.chunk.js.LICENSE.txt */
(this["webpackJsonpshlok-zanwar"]=this["webpackJsonpshlok-zanwar"]||[]).push([[7],{432:function(t,e,n){t.exports=n(201)},464:function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}n.d(e,"a",(function(){return i}))},465:function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",(function(){return r}))},490:function(t,e,n){"use strict";function r(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(c){return void n(c)}a.done?e(u):Promise.resolve(u).then(r,i)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(i,o){var s=t.apply(e,n);function a(t){r(s,i,o,a,u,"next",t)}function u(t){r(s,i,o,a,u,"throw",t)}a(void 0)}))}}n.d(e,"a",(function(){return i}))},586:function(t,e,n){"use strict";n.r(e),n.d(e,"firebase",(function(){return j}));var r=function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.create;Object.create;var i=n(818);var o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function s(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(e){o(e)}}function a(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function a(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}Object.create;function u(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(a){i={error:a}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function h(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t}Object.create;var l=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),f="[DEFAULT]",p=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return t.prototype.get=function(t){void 0===t&&(t=f);var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new i.a;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(o){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=o({identifier:f,optional:!1},t),n=e.identifier,r=e.optional,i=this.normalizeInstanceIdentifier(n);try{var s=this.getOrInitializeService({instanceIdentifier:i});if(!s){if(r)return null;throw Error("Service "+this.name+" is not available")}return s}catch(a){if(r)return null;throw a}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:f})}catch(p){}try{for(var r=u(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=c(i.value,2),s=o[0],a=o[1],h=this.normalizeInstanceIdentifier(s);try{var l=this.getOrInitializeService({instanceIdentifier:h});a.resolve(l)}catch(p){}}}catch(d){e={error:d}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.clearInstance=function(t){void 0===t&&(t=f),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return s(this,void 0,void 0,(function(){var t;return a(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(h(h([],c(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),c(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=f),this.instances.has(t)},t.prototype.initialize=function(t){void 0===t&&(t={});var e=t.instanceIdentifier,n=void 0===e?f:e,r=t.options,i=void 0===r?{}:r,o=this.normalizeInstanceIdentifier(n);if(this.isInitialized(o))throw Error(this.name+"("+o+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");return this.getOrInitializeService({instanceIdentifier:o,options:i})},t.prototype.getOrInitializeService=function(t){var e,n=t.instanceIdentifier,r=t.options,i=void 0===r?{}:r,o=this.instances.get(n);return!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,e===f?void 0:e),options:i}),this.instances.set(n,o)),o||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:f:t},t}();var d,y=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new p(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();function g(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}var v,m=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(v||(v={}));var b,w={debug:v.DEBUG,verbose:v.VERBOSE,info:v.INFO,warn:v.WARN,error:v.ERROR,silent:v.SILENT},E=v.INFO,_=((d={})[v.DEBUG]="log",d[v.VERBOSE]="log",d[v.INFO]="info",d[v.WARN]="warn",d[v.ERROR]="error",d),I=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=_[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,g(["["+i+"]  "+t.name+":"],n))}},T=function(){function t(t){this.name=t,this._logLevel=E,this._logHandler=I,this._userLogHandler=null,m.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in v))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"===typeof t?w[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!==typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,g([this,v.DEBUG],t)),this._logHandler.apply(this,g([this,v.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,g([this,v.VERBOSE],t)),this._logHandler.apply(this,g([this,v.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,g([this,v.INFO],t)),this._logHandler.apply(this,g([this,v.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,g([this,v.WARN],t)),this._logHandler.apply(this,g([this,v.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,g([this,v.ERROR],t)),this._logHandler.apply(this,g([this,v.ERROR],t))},t}();function S(t){m.forEach((function(e){e.setLogLevel(t)}))}var D,A=((b={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",b["bad-app-name"]="Illegal App name: '{$appName}",b["duplicate-app"]="Firebase App named '{$appName}' already exists",b["app-deleted"]="Firebase App named '{$appName}' already deleted",b["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",b["invalid-log-argument"]="First argument to `onLog` must be null or a function.",b),N=new i.b("app","Firebase",A),C="@firebase/app",k="[DEFAULT]",O=((D={})[C]="fire-core",D["@firebase/analytics"]="fire-analytics",D["@firebase/auth"]="fire-auth",D["@firebase/database"]="fire-rtdb",D["@firebase/functions"]="fire-fn",D["@firebase/installations"]="fire-iid",D["@firebase/messaging"]="fire-fcm",D["@firebase/performance"]="fire-perf",D["@firebase/remote-config"]="fire-rc",D["@firebase/storage"]="fire-gcs",D["@firebase/firestore"]="fire-fst",D["fire-js"]="fire-js",D["firebase-wrapper"]="fire-js-all",D),x=new T("@firebase/app"),R=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=Object(i.e)(t),this.container=new y(e.name),this._addComponent(new l("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(t){return r._addComponent(t)}))}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){return void 0===e&&(e=k),this.checkDestroyed_(),this.container.getProvider(t).getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=k),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){x.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw N.create("app-deleted",{appName:this.name_})},t}();R.prototype.name&&R.prototype.options||R.prototype.delete||console.log("dc");function L(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,o){void 0===o&&(o={});if("object"!==typeof o||null===o){o={name:o}}var s=o;void 0===s.name&&(s.name=k);var a=s.name;if("string"!==typeof a||!a)throw N.create("bad-app-name",{appName:String(a)});if(Object(i.c)(e,a))throw N.create("duplicate-app",{appName:a});var u=new t(n,s,r);return e[a]=u,u},app:o,registerVersion:function(t,e,n){var r,i=null!==(r=O[t])&&void 0!==r?r:t;n&&(i+="-"+n);var o=i.match(/\s|\//),a=e.match(/\s|\//);if(o||a){var u=['Unable to register library "'+i+'" with version "'+e+'":'];return o&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),o&&a&&u.push("and"),a&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void x.warn(u.join(" "))}s(new l(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:S,onLog:function(t,e){if(null!==t&&"function"!==typeof t)throw N.create("invalid-log-argument");!function(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=w[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var s=i.map((function(t){if(null==t)return null;if("string"===typeof t)return t;if("number"===typeof t||"boolean"===typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(e){return null}})).filter((function(t){return t})).join(" ");n>=(null!==r&&void 0!==r?r:e.logLevel)&&t({level:v[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=m;r<i.length;r++)n(i[r])}(t,e)},apps:null,SDK_VERSION:"8.3.1",INTERNAL:{registerComponent:s,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){if("serverAuth"===e)return null;return e}}};function o(t){if(t=t||k,!Object(i.c)(e,t))throw N.create("no-app",{appName:t});return e[t]}function s(s){var a=s.name;if(n.has(a))return x.debug("There were multiple attempts to register component "+a+"."),"PUBLIC"===s.type?r[a]:null;if(n.set(a,s),"PUBLIC"===s.type){var u=function(t){if(void 0===t&&(t=o()),"function"!==typeof t[a])throw N.create("invalid-app-argument",{appName:a});return t[a]()};void 0!==s.serviceProps&&Object(i.f)(u,s.serviceProps),r[a]=u,t.prototype[a]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,a);return n.apply(this,s.multipleInstances?t:[])}}for(var c=0,h=Object.keys(e);c<h.length;c++){var l=h[c];e[l]._addComponent(s)}return"PUBLIC"===s.type?r[a]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),o.App=t,r}var P=function t(){var e=L(R);return e.INTERNAL=r(r({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){Object(i.f)(e,t)},createSubscribe:i.d,ErrorFactory:i.b,deepExtend:i.f}),e}(),M=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null===e||void 0===e?void 0:e.type)}(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();if(Object(i.g)()&&void 0!==self.firebase){x.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var F=self.firebase.SDK_VERSION;F&&F.indexOf("LITE")>=0&&x.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var V=P.initializeApp;P.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Object(i.h)()&&x.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),V.apply(void 0,t)};var q,U,j=P;(q=j).INTERNAL.registerComponent(new l("platform-logger",(function(t){return new M(t)}),"PRIVATE")),q.registerVersion(C,"0.6.17",U),q.registerVersion("fire-js","");e.default=j},817:function(t,e,n){"use strict";var r=n(586);n.d(e,"a",(function(){return r.default}));r.default.registerVersion("firebase","8.3.1","app")},818:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return l})),n.d(e,"c",(function(){return d})),n.d(e,"d",(function(){return y})),n.d(e,"e",(function(){return o})),n.d(e,"f",(function(){return s})),n.d(e,"g",(function(){return c})),n.d(e,"h",(function(){return u}));var r=n(952),i=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296===(64512&i)&&r+1<t.length&&56320===(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e};function o(t){return s(void 0,t)}function s(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=s(t[n],e[n]));return t}var a=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"===typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();function u(){try{return"[object process]"===Object.prototype.toString.call(t.process)}catch(e){return!1}}function c(){return"object"===typeof self&&self.self===self}var h=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,l.prototype.create),o}return Object(r.a)(e,t),e}(Error),l=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?f(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",u=new h(i,a,r);return u},t}();function f(t,e){return t.replace(p,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var p=/\{\$([^}]+)}/g;function d(t,e){return Object.prototype.hasOwnProperty.call(t,e)}!function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"===typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,s,a=this.chain_[0],u=this.chain_[1],c=this.chain_[2],h=this.chain_[3],l=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(o=h^u&(c^h),s=1518500249):(o=u^c^h,s=1859775393):r<60?(o=u&c|h&(u|c),s=2400959708):(o=u^c^h,s=3395469782);i=(a<<5|a>>>27)+o+l+s+n[r]&4294967295;l=h,h=c,c=4294967295&(u<<30|u>>>2),u=a,a=i}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"===typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t}}();function y(t,e){var n=new g(t,e);return n.subscribe.bind(n)}var g=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!==typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"===typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(r.next=v),void 0===r.error&&(r.error=v),void 0===r.complete&&(r.complete=v);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(r){"undefined"!==typeof console&&console.error&&console.error(r)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function v(){}}).call(this,n(82))},819:function(t,e,n){(function(t,e){!function(n){"use strict";try{(function(){function r(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var i,o=r(n),s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function u(t,e,n,r){return new(n=n||Promise)((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):((e=t.value)instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function c(t,e){var n,r,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s={next:a(0),throw:a(1),return:a(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,(s=i?[2&s[0],i.value]:s)[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=0<(i=o.trys).length&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(a){s=[6,a],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}function h(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t}function l(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=d[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,h(["["+i+"]  "+t.name+":"],n))}}(Te=i=i||{})[Te.DEBUG=0]="DEBUG",Te[Te.VERBOSE=1]="VERBOSE",Te[Te.INFO=2]="INFO",Te[Te.WARN=3]="WARN",Te[Te.ERROR=4]="ERROR",Te[Te.SILENT=5]="SILENT";var f={debug:i.DEBUG,verbose:i.VERBOSE,info:i.INFO,warn:i.WARN,error:i.ERROR,silent:i.SILENT},p=i.INFO,d=((Se={})[i.DEBUG]="log",Se[i.VERBOSE]="log",Se[i.INFO]="info",Se[i.WARN]="warn",Se[i.ERROR]="error",Se),y=(Object.defineProperty(g.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in i))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),g.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?f[t]:t},Object.defineProperty(g.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),g.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,i.DEBUG],t)),this._logHandler.apply(this,h([this,i.DEBUG],t))},g.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,i.VERBOSE],t)),this._logHandler.apply(this,h([this,i.VERBOSE],t))},g.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,i.INFO],t)),this._logHandler.apply(this,h([this,i.INFO],t))},g.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,i.WARN],t)),this._logHandler.apply(this,h([this,i.WARN],t))},g.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,i.ERROR],t)),this._logHandler.apply(this,h([this,i.ERROR],t))},g);function g(t){this.name=t,this._logLevel=p,this._logHandler=l,this._userLogHandler=null}function v(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var m,b="FirebaseError",w=(a(E,m=Error),E);function E(t,e,n){return(e=m.call(this,e)||this).code=t,e.customData=n,e.name=b,Object.setPrototypeOf(e,E.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,_.prototype.create),e}var _=(I.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t;return t=(t=this.errors[t])?(r=i,t.replace(T,(function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"}))):"Error",t=this.serviceName+": "+t+" ("+o+").",new w(o,t,i)},I);function I(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var T=/\{\$([^}]+)}/g,S=function(t,e){return(S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function D(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof t?t:"undefined"!=typeof self?self:{},C={},k=N||self;function O(){}function x(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function R(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var L="closure_uid_"+(1e9*Math.random()>>>0),P=0;function M(t,e,n){return t.call.apply(t.bind,arguments)}function F(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function V(t,e,n){return(V=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?M:F).apply(null,arguments)}function q(t){var e=Array.prototype.slice.call(arguments,1);return function(){var n=e.slice();return n.push.apply(n,arguments),t.apply(this,n)}}function U(){return Date.now()}function j(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,(t.prototype.constructor=t).Kb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function B(){this.j=this.j,this.i=this.i}B.prototype.j=!1,B.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,L)&&t[L]||(t[L]=++P))},B.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var G=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},K=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function z(){return Array.prototype.concat.apply([],arguments)}function H(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Q(t){return/^[\s\xa0]*$/.test(t)}var W,Y=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function J(t,e){return t<e?-1:e<t?1:0}var $=k.navigator;function Z(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function tt(t){var e,n={};for(e in t)n[e]=t[e];return n}W=$&&($=$.userAgent)?$:"";var et="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function nt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<et.length;i++)e=et[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function rt(t){return rt[" "](t),t}rt[" "]=O;var it,ot=X(W,"Opera"),st=X(W,"Trident")||X(W,"MSIE"),at=X(W,"Edge"),ut=at||st,ct=X(W,"Gecko")&&!(X(W.toLowerCase(),"webkit")&&!X(W,"Edge"))&&!(X(W,"Trident")||X(W,"MSIE"))&&!X(W,"Edge"),ht=X(W.toLowerCase(),"webkit")&&!X(W,"Edge");function lt(){var t=k.document;return t?t.documentMode:void 0}var ft="",pt=(pt=W,ct?/rv:([^\);]+)(\)|;)/.exec(pt):at?/Edge\/([\d\.]+)/.exec(pt):st?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(pt):ht?/WebKit\/(\S+)/.exec(pt):ot?/(?:Version)[ \/]?(\S+)/.exec(pt):void 0);pt&&(ft=pt?pt[1]:""),it=st&&null!=(pt=lt())&&pt>parseFloat(ft)?String(pt):ft;var dt={};function yt(t){return e=t,n=function(){for(var e=0,n=Y(String(it)).split("."),r=Y(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++)for(var s=n[o]||"",a=r[o]||"";s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],(0!=s[0].length||0!=a[0].length)&&(e=J(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||J(0==s[2].length,0==a[2].length)||J(s[2],a[2]),s=s[3],a=a[3],0==e););return 0<=e},r=dt,Object.prototype.hasOwnProperty.call(r,e)?r[e]:r[e]=n(e);var e,n,r}var gt=k.document&&st&&(lt()||parseInt(it,10))||void 0,vt=!st||9<=Number(gt),mt=st&&!yt("9"),bt=function(){if(!k.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{k.addEventListener("test",O,e),k.removeEventListener("test",O,e)}catch(t){}return t}();function wt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Et(t,e){if(wt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ct){t:{try{rt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:_t[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}wt.prototype.b=function(){this.defaultPrevented=!0},j(Et,wt);var _t={2:"touch",3:"pen",4:"mouse"};Et.prototype.b=function(){Et.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,mt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var It="closure_listenable_"+(1e6*Math.random()|0),Tt=0;function St(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Tt,this.Y=this.Z=!1}function Dt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function At(t){this.src=t,this.a={},this.b=0}function Nt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=G(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Dt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Ct(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}At.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Ct(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new St(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var kt="closure_lm_"+(1e6*Math.random()|0),Ot={};function xt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Ut(r),e&&e[It]?e.wa(n,r,R(i)?!!i.capture:!!i,o):Rt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)xt(t,e[o],n,r,i);return null}return n=Ut(n),t&&t[It]?t.va(e,n,R(r)?!!r.capture:!!r,i):Rt(t,e,n,!1,r,i)}function Rt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=R(i)?!!i.capture:!!i;if(s&&!vt)return null;var a,u,c=Vt(t);if(c||(t[kt]=c=new At(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(a=Ft,r=u=vt?function(t){return a.call(u.src,u.listener,t)}:function(t){if(!(t=a.call(u.src,u.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)void 0===(i=bt?i:s)&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Pt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Lt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[It]?Nt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Pt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Vt(e))?(Nt(n,t),0==n.b&&(n.src=null,e[kt]=null)):Dt(t)))}function Pt(t){return t in Ot?Ot[t]:Ot[t]="on"+t}function Mt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Lt(t),n.call(r,e)}function Ft(t,e){if(t.Y)return!0;if(vt)return Mt(t,new Et(e,this));if(!e)t:{e=["window","event"];for(var n=k,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Mt(t,e=new Et(e,this))}function Vt(t){return(t=t[kt])instanceof At?t:null}var qt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ut(t){return"function"==typeof t?t:(t[qt]||(t[qt]=function(e){return t.handleEvent(e)}),t[qt])}function jt(){B.call(this),this.c=new At(this),(this.J=this).C=null}function Bt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new wt(e,t):e instanceof wt?e.target=e.target||t:(s=e,nt(e=new wt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Gt(o,r,!0,e)&&s;if(s=Gt(o=e.a=t,r,!0,e)&&s,s=Gt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Gt(o=e.a=n[i],r,!1,e)&&s}function Gt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,a,u=e[o];u&&!u.Y&&u.capture==n&&(s=u.listener,a=u.ca||u.src,u.Z&&Nt(t.c,u),i=!1!==s.call(a,r)&&i)}return i&&!r.defaultPrevented}j(jt,B),jt.prototype[It]=!0,(A=jt.prototype).addEventListener=function(t,e,n,r){xt(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=R(i)?!!i.capture:!!i,r=Ut(r),e&&e[It]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Ct(s=e.a[n],r,i,o))&&(Dt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Vt(e))&&(n=e.a[n.toString()],(r=(e=-1)<(e=n?Ct(n,r,i,o):e)?n[e]:null)&&Lt(r))}(this,t,e,n,r)},A.G=function(){if(jt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Dt(n[r]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Kt=k.JSON.stringify;function zt(){this.b=this.a=null}var Ht,Qt=(Wt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Wt((function(){return new Yt}),(function(t){t.reset()})));function Wt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Yt(){this.next=this.b=this.a=null}function Xt(t,e){var n;Ht||(n=k.Promise.resolve(void 0),Ht=function(){n.then(Zt)}),Jt||(Ht(),Jt=!0),$t.add(t,e)}zt.prototype.add=function(t,e){var n=Qt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Yt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Jt=!(Yt.prototype.reset=function(){this.next=this.b=this.a=null}),$t=new zt;function Zt(){for(var t,e;n=e=void 0,n=null,(e=$t).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){k.setTimeout((function(){throw t}),0)}(t)}var n=Qt;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}Jt=!1}function te(t,e){jt.call(this),this.b=t||1,this.a=e||k,this.f=V(this.Za,this),this.g=U()}function ee(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ne(t,e,n){if("function"==typeof t)n&&(t=V(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=V(t.handleEvent,t)}return 2147483647<Number(e)?-1:k.setTimeout(t,e||0)}j(te,jt),(A=te.prototype).aa=!1,A.M=null,A.Za=function(){var t;this.aa&&(0<(t=U()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Bt(this,"tick"),this.aa&&(ee(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=U())},A.G=function(){te.X.G.call(this),ee(this),delete this.a};var re,ie,oe,se=(S(ie=ue,oe=re=B),ie.prototype=null===oe?Object.create(oe):(ae.prototype=oe.prototype,new ae),ue.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ne((function(){e.a=null,e.c&&(e.c=!1,t(e))}),e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ue.prototype.G=function(){re.prototype.G.call(this),this.a&&(k.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ue);function ae(){this.constructor=ie}function ue(t,e){var n=re.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function ce(t){B.call(this),this.b=t,this.a={}}j(ce,B);var he=[];function le(t,e,n,r){Array.isArray(n)||(n&&(he[0]=n.toString()),n=he);for(var i=0;i<n.length;i++){var o=xt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function fe(t){Z(t.a,(function(t,e){this.a.hasOwnProperty(e)&&Lt(t)}),t),t.a={}}function pe(){this.a=!0}function de(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return Kt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}ce.prototype.G=function(){ce.X.G.call(this),fe(this)},ce.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},pe.prototype.info=function(){};var ye={},ge=null;function ve(){return ge=ge||new jt}function me(t){wt.call(this,ye.Fa,t)}function be(t){var e=ve();Bt(e,new me(e))}function we(t,e){wt.call(this,ye.STAT_EVENT,t),this.stat=e}function Ee(t){var e=ve();Bt(e,new we(e,t))}function _e(t){wt.call(this,ye.Ga,t)}function Ie(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return k.setTimeout((function(){t()}),e)}ye.Fa="serverreachability",j(me,wt),ye.STAT_EVENT="statevent",j(we,wt),ye.Ga="timingevent",j(_e,wt);var Te={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},Se={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function De(){}function Ae(t){var e;return(e=t.a)?e:t.a={}}function Ne(){}function Ce(){wt.call(this,"d")}function ke(){wt.call(this,"c")}function Oe(){}function xe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ce(this),this.P=Le,t=ut?125:void 0,this.R=new te(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}De.prototype.a=null,N={OPEN:"a",eb:"b",Ea:"c",qb:"d"},j(Ce,wt),j(ke,wt),j(Oe,De);var Re=new Oe,Le=45e3,Pe={},Me={};function Fe(t,e,n){t.H=1,t.i=on($e(e)),t.j=n,t.I=!0,Ve(t,null)}function Ve(t,e){t.u=U(),Ue(t),t.l=$e(t.i);var n,r,i,o,s,a,u=t.l,c=t.S;Array.isArray(c)||(c=[String(c)]),mn(u.b,"t",c),t.D=0,t.a=lr(t.g,t.g.C?e:null),0<t.O&&(t.F=new se(V(t.Ca,t,t.a),t.O)),le(t.J,t.a,"readystatechange",t.Xa),e=t.B?tt(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),be(1),n=t.c,r=t.m,i=t.l,o=t.f,s=t.S,a=t.j,n.info((function(){if(n.a)if(a)for(var t="",e=a.split("&"),u=0;u<e.length;u++){var c,h,l=e[u].split("=");1<l.length&&(c=l[0],l=l[1],t=2<=(h=c.split("_")).length&&"type"==h[1]?t+(c+"=")+l+"&":t+(c+"=redacted&"))}else t=null;else t=a;return"XMLHTTP REQ ("+o+") [attempt "+s+"]: "+r+"\n"+i+"\n"+t}))}function qe(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var a=(a=n,o=i=void 0,i=(r=t).D,-1==(o=a.indexOf("\n",i))?Me:(i=Number(a.substring(i,o)),isNaN(i)?Pe:(o+=1)+i>a.length?Me:(a=a.substr(o,i),r.D=o+i,a)));if(a==Me){4==e&&(t.h=4,Ee(14),s=!1),de(t.c,t.f,null,"[Incomplete Response]");break}if(a==Pe){t.h=4,Ee(15),de(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}de(t.c,t.f,a,null),ze(t,a)}4==e&&0==n.length&&(t.h=1,Ee(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),rr(e),e.F=!0,Ee(11))):(de(t.c,t.f,n,"[Invalid Chunked Response]"),Ke(t),Ge(t))}function Ue(t){t.T=U()+t.P,je(t,t.P)}function je(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ie(V(t.Va,t),e)}function Be(t){t.o&&(k.clearTimeout(t.o),t.o=null)}function Ge(t){0==t.g.v||t.A||sr(t.g,t)}function Ke(t){Be(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ee(t.R),fe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function ze(t,e){try{var n,r,i,o,s,a=t.g;if(0!=a.v&&(a.a==t||Sn(a.b,t)))if(a.I=t.N,!t.C&&Sn(a.b,t)&&3==a.v){try{var u=a.ka.a.parse(e)}catch(t){u=null}if(Array.isArray(u)&&3==u.length){var c=u;if(0==c[0]){t:if(!a.j){if(a.a){if(!(a.a.u+3e3<t.u))break t;or(a),Wn(a)}nr(a),Ee(18)}}else a.oa=c[1],0<a.oa-a.P&&c[2]<37500&&a.H&&0==a.o&&!a.m&&(a.m=Ie(V(a.Sa,a),6e3));if(Tn(a.b)<=1&&a.ea){try{a.ea()}catch(t){}a.ea=void 0}}else ur(a,11)}else if(!t.C&&a.a!=t||or(a),!Q(e))for(e=u=a.ka.a.parse(e),u=0;u<e.length;u++)c=e[u],a.P=c[0],c=c[1],2==a.v?"c"==c[0]?(a.J=c[1],a.ga=c[2],null!=(r=c[3])&&(a.ha=r,a.c.info("VER="+a.ha)),null!=(o=c[4])&&(a.pa=o,a.c.info("SVER="+a.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,a.D=n,a.c.info("backChannelRequestTimeoutMs_="+n)),n=a,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(X(r,"spdy")||X(r,"quic")||X(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(Dn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,rn(n.B,n.A,s))),a.v=3,a.f&&a.f.ta(),a.U&&(a.N=U()-t.u,a.c.info("Handshake RTT: "+a.N+"ms")),i=t,(n=a).la=hr(n,n.C?n.ga:null,n.fa),i.C?(An(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Be(o),Ue(o)),n.a=i):er(n),0<a.g.length&&Jn(a)):"stop"!=c[0]&&"close"!=c[0]||ur(a,7):3==a.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?ur(a,7):Qn(a):"noop"!=c[0]&&a.f&&a.f.sa(c),a.o=0);be(4)}catch(t){}}function He(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(x(t)||"string"==typeof t)K(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(x(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(x(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Qe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function We(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ye(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Ye(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ye(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=xe.prototype).setTimeout=function(t){this.P=t},A.Xa=function(t){t=t.target;var e=this.F;e&&3==Gn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=Gn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!ut&&!this.a.$())){this.A||4!=e||7==n||be(8==n||r<=0?3:2),Be(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,r=this.c,u=this.m,c=this.l,h=this.f,l=this.S,f=e,p=i,r.info((function(){return"XMLHTTP RESP ("+h+") [ attempt "+l+"]: "+u+"\n"+c+"\n"+f+" "+p})),this.b){if(this.U&&!this.C){e:{if(this.a){var s=this.a;if((s=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Q(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,Ee(12),Ke(this),Ge(this);break t}de(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,ze(this,a)}this.I?(qe(this,e,o),ut&&this.b&&3==e&&(le(this.J,this.R,"tick",this.Wa),this.R.start())):(de(this.c,this.f,o,null),ze(this,o)),4==e&&Ke(this),this.b&&!this.A&&(4==e?sr(this.g,this):(this.b=!1,Ue(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,Ee(12)):(this.h=0,Ee(13)),Ke(this),Ge(this)}}}catch(t){}var u,c,h,l,f,p},A.Wa=function(){var t,e;this.a&&(t=Gn(this.a),e=this.a.$(),this.D<e.length&&(Be(this),qe(this,t,e),this.b&&4!=t&&Ue(this)))},A.cancel=function(){this.A=!0,Ke(this)},A.Va=function(){this.o=null;var t,e,n=U();0<=n-this.T?(t=this.c,e=this.l,t.info((function(){return"TIMEOUT: "+e})),2!=this.H&&(be(3),Ee(17)),Ke(this),this.h=2,Ge(this)):je(this,this.T-n)},(A=Qe.prototype).K=function(){We(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return We(this),this.a.concat()},A.get=function(t,e){return Ye(this.b,t)?this.b[t]:e},A.set=function(t,e){Ye(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Xe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Je(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Je?(this.a=void 0!==e?e:t.a,Ze(this,t.f),this.j=t.j,tn(this,t.c),en(this,t.h),this.g=t.g,e=t.b,(n=new dn).c=e.c,e.a&&(n.a=new Qe(e.a),n.b=e.b),nn(this,n),this.i=t.i):t&&(n=String(t).match(Xe))?(this.a=!!e,Ze(this,n[1]||"",!0),this.j=sn(n[2]||""),tn(this,n[3]||"",!0),en(this,n[4]),this.g=sn(n[5]||"",!0),nn(this,n[6]||"",!0),this.i=sn(n[7]||"")):(this.a=!!e,this.b=new dn(null,this.a))}function $e(t){return new Je(t)}function Ze(t,e,n){t.f=n?sn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function tn(t,e,n){t.c=n?sn(e,!0):e}function en(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function nn(t,e,n){var r,i;e instanceof dn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(yn(r),r.c=null,r.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(gn(this,e),mn(this,n,t))}),r)),r.f=i):(n||(e=an(e,fn)),t.b=new dn(e,t.a))}function rn(t,e,n){t.b.set(e,n)}function on(t){return rn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^U()).toString(36)),t}function sn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function an(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,un),t=n?t.replace(/%25([0-9a-fA-F]{2})/g,"%$1"):t):null}function un(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Je.prototype.toString=function(){var t=[],e=this.f;e&&t.push(an(e,cn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(an(e,cn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(an(n,"/"==n.charAt(0)?ln:hn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",an(n,pn)),t.join("")};var cn=/[#\/\?@]/g,hn=/[#\?:]/g,ln=/[#\?]/g,fn=/[#\?@]/g,pn=/#/g;function dn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function yn(t){t.a||(t.a=new Qe,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function gn(t,e){yn(t),e=bn(t,e),Ye(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ye((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&We(t)))}function vn(t,e){return yn(t),e=bn(t,e),Ye(t.a.b,e)}function mn(t,e,n){gn(t,e),0<n.length&&(t.c=null,t.a.set(bn(t,e),H(n)),t.b+=n.length)}function bn(t,e){return e=String(e),t.f?e.toLowerCase():e}(A=dn.prototype).add=function(t,e){yn(this),this.c=null,t=bn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(t,e){yn(this),this.a.forEach((function(n,r){K(n,(function(n){t.call(e,n,r,this)}),this)}),this)},A.L=function(){yn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.K=function(t){yn(this);var e=[];if("string"==typeof t)vn(this,t)&&(e=z(e,this.a.get(bn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},A.set=function(t,e){return yn(this),this.c=null,vn(this,t=bn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),o=(r=this.K(r),0);o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var wn=function(t,e){this.b=t,this.a=e};function En(t){this.g=t||_n,t=k.PerformanceNavigationTiming?0<(t=k.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(k.ia&&k.ia.ya&&k.ia.ya()&&k.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var _n=10;function In(t){return t.b||t.a&&t.a.size>=t.f}function Tn(t){return t.b?1:t.a?t.a.size:0}function Sn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Dn(t,e){t.a?t.a.add(e):t.b=e}function An(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Nn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return H(t.c);var r=t.c;try{for(var i=D(t.a.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Cn(){}function kn(){this.a=new Cn}function On(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}En.prototype.cancel=function(){var t,e;if(this.c=Nn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=D(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Cn.prototype.stringify=function(t){return k.JSON.stringify(t,void 0)},Cn.prototype.parse=function(t){return k.JSON.parse(t,void 0)};var xn=k.JSON.parse;function Rn(t){jt.call(this),this.headers=new Qe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Ln,this.D=this.F=!1}j(Rn,jt);var Ln="",Pn=/^https?$/i,Mn=["POST","PUT"];function Fn(t){return"content-type"==t.toLowerCase()}function Vn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,qn(t),jn(t)}function qn(t){t.u||(t.u=!0,Bt(t,"complete"),Bt(t,"error"))}function Un(t){if(t.b&&void 0!==C&&(!t.s[1]||4!=Gn(t)||2!=t.W()))if(t.l&&4==Gn(t))ne(t.za,0,t);else if(Bt(t,"readystatechange"),4==Gn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Xe)[1]||null)&&k.self&&k.self.location&&(i=(r=k.self.location.protocol).substr(0,r.length-1)),n=!Pn.test(i?i.toLowerCase():"")),e=n),e)Bt(t,"complete"),Bt(t,"success");else{t.h=6;try{var a=2<Gn(t)?t.a.statusText:""}catch(o){a=""}t.f=a+" ["+t.W()+"]",qn(t)}}finally{jn(t)}}}function jn(t,e){if(t.a){Bn(t);var n=t.a,r=t.s[0]?O:null;t.a=null,t.s=null,e||Bt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Bn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(k.clearTimeout(t.m),t.m=null)}function Gn(t){return t.a?t.a.readyState:0}function Kn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Z(n,(function(t,e){i+=e,i+=":",i+=t,i+="\r\n"})),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):rn(t,e,n))}function zn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Hn(t){this.pa=0,this.g=[],this.c=new pe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=zn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=zn("baseRetryDelayMs",5e3,t),this.Ra=zn("retryDelaySeedMs",1e4,t),this.Ma=zn("forwardChannelMaxRetries",2,t),this.ma=zn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new En(t&&t.concurrentRequestLimit),this.ka=new kn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Qn(t){var e,n;Yn(t),3==t.v&&(e=t.R++,rn(n=$e(t.B),"SID",t.J),rn(n,"RID",e),rn(n,"TYPE","terminate"),Zn(t,n),(e=new xe(t,t.c,e,void 0)).H=2,e.i=on($e(n)),n=!1,!(n=k.navigator&&k.navigator.sendBeacon?k.navigator.sendBeacon(e.i.toString(),""):n)&&k.Image&&((new Image).src=e.i,n=!0),n||(e.a=lr(e.g,null),e.a.ba(e.i)),e.u=U(),Ue(e)),cr(t)}function Wn(t){t.a&&(rr(t),t.a.cancel(),t.a=null)}function Yn(t){Wn(t),t.j&&(k.clearTimeout(t.j),t.j=null),or(t),t.b.cancel(),t.h&&("number"==typeof t.h&&k.clearTimeout(t.h),t.h=null)}function Xn(t,e){t.g.push(new wn(t.Oa++,e)),3==t.v&&Jn(t)}function Jn(t){In(t.b)||t.h||(t.h=!0,Xt(t.Ba,t),t.u=0)}function $n(t,e){var n=e?e.f:t.R++,r=$e(t.B);rn(r,"SID",t.J),rn(r,"RID",n),rn(r,"AID",t.P),Zn(t,r),t.i&&t.l&&Kn(r,t.i,t.l),n=new xe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=tr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Dn(t.b,n),Fe(n,r,e)}function Zn(t,e){t.f&&He({},(function(t,n){rn(e,n,t)}))}function tr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?V(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].b,h=i[u].a;if((c-=o)<0)o=Math.max(0,i[u].b-100),a=!1;else try{!function(t,e,n){var r=n||"";try{He(t,(function(t,n){var i=t;R(t)&&(i=Kt(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(a){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function er(t){t.a||t.j||(t.T=1,Xt(t.Aa,t),t.o=0)}function nr(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=Ie(V(t.Aa,t),ar(t,t.o)),t.o++,1)}function rr(t){null!=t.s&&(k.clearTimeout(t.s),t.s=null)}function ir(t){t.a=new xe(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=$e(t.la);rn(e,"RID","rpc"),rn(e,"SID",t.J),rn(e,"CI",t.H?"0":"1"),rn(e,"AID",t.P),Zn(t,e),rn(e,"TYPE","xmlhttp"),t.i&&t.l&&Kn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=on($e(e)),n.j=null,n.I=!0,Ve(n,t)}function or(t){null!=t.m&&(k.clearTimeout(t.m),t.m=null)}function sr(t,e){var n,r,i,o=null;if(t.a==e){or(t),rr(t),t.a=null;var s=2}else{if(!Sn(t.b,e))return;o=e.s,An(t.b,e),s=1}if(t.I=e.N,0!=t.v)if(e.b)1==s?(o=e.j?e.j.length:0,e=U()-e.u,n=t.u,Bt(s=ve(),new _e(s)),Jn(t)):er(t);else if(3==(n=e.h)||0==n&&0<t.I||(1!=s||(i=e,Tn((r=t).b)>=r.b.f-(r.h?1:0)||(r.h?(r.g=i.s.concat(r.g),0):1==r.v||2==r.v||r.u>=(r.La?0:r.Ma)||(r.h=Ie(V(r.Ba,r,i),ar(r,r.u)),r.u++,0))))&&(2!=s||!nr(t)))switch(o&&0<o.length&&(e=t.b,e.c=e.c.concat(o)),n){case 1:ur(t,5);break;case 4:ur(t,10);break;case 3:ur(t,6);break;default:ur(t,2)}}function ar(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function ur(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=V(t.Ya,t),r||(r=new Je("//www.google.com/images/cleardot.gif"),k.location&&"http"==k.location.protocol||Ze(r,"https"),on(r)),n=r.toString(),r=o,o=new pe,k.Image?((i=new Image).onload=q(On,o,i,"TestLoadImage: loaded",!0,r),i.onerror=q(On,o,i,"TestLoadImage: error",!1,r),i.onabort=q(On,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=q(On,o,i,"TestLoadImage: timeout",!1,r),k.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=n):r(!1)):Ee(2),t.v=0,t.f&&t.f.ra(e),cr(t),Yn(t)}function cr(t){t.v=0,t.I=-1,t.f&&(0==Nn(t.b).length&&0==t.g.length||(t.b.c.length=0,H(t.g),t.g.length=0),t.f.qa())}function hr(t,e,n){var r,i,o,s,a,u=(s=n)instanceof Je?$e(s):new Je(s,void 0);return""!=u.c?(e&&tn(u,e+"."+u.c),en(u,u.h)):(r=(a=k.location).protocol,i=e?e+"."+a.hostname:a.hostname,o=+a.port,s=n,a=new Je(null,void 0),r&&Ze(a,r),i&&tn(a,i),o&&en(a,o),s&&(a.g=s),u=a),t.V&&Z(t.V,(function(t,e){rn(u,e,t)})),e=t.A,n=t.na,e&&n&&rn(u,e,n),rn(u,"VER",t.ha),Zn(t,u),u}function lr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Rn(t.Na)).F=t.C,e}function fr(){}function pr(){if(st&&!(10<=Number(gt)))throw Error("Environmental error: no available transport.")}function dr(t,e){jt.call(this),this.a=new Hn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!Q(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Q(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new vr(this)}function yr(t){Ce.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function gr(){ke.call(this),this.status=1}function vr(t){this.a=t}(A=Rn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ae(this.H):Ae(Re),this.a.onreadystatechange=V(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Vn(this,t)}t=n||"";var i,o=new Qe(this.headers);r&&He(r,(function(t,e){o.set(e,t)})),r=function(t){t:{for(var e=Fn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=k.FormData&&t instanceof k.FormData,0<=G(Mn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Bn(this),0<this.o&&((this.D=(i=this.a,st&&yt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=V(this.xa,this)):this.m=ne(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Vn(this,t)}},A.xa=function(){void 0!==C&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Bt(this,"timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Bt(this,"complete"),Bt(this,"abort"),jn(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),jn(this,!0)),Rn.X.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?Un(this):this.Ua())},A.Ua=function(){Un(this)},A.W=function(){try{return 2<Gn(this)?this.a.status:-1}catch(r){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(r){return""}},A.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),xn(e)}},A.ua=function(){return this.h},A.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=Hn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new xe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?nt(r=tt(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=tr(this,n,e),rn(i=$e(this.B),"RID",t),rn(i,"CVER",22),this.A&&rn(i,"X-HTTP-Session-Id",this.A),Zn(this,i),this.i&&r&&Kn(i,this.i,r),Dn(this.b,n),this.Ia&&rn(i,"TYPE","init"),this.da?(rn(i,"$req",e),rn(i,"SID","null"),n.U=!0,Fe(n,i,null)):Fe(n,i,e),this.v=2}}else 3==this.v&&(t?$n(this,t):0==this.g.length||In(this.b)||$n(this))},A.Aa=function(){var t;this.j=null,ir(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ie(V(this.Ta,this),t))},A.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Ee(10),Wn(this),ir(this))},A.Sa=function(){null!=this.m&&(this.m=null,Wn(this),nr(this),Ee(19))},A.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),Ee(2)):(this.c.info("Failed to ping google.com"),Ee(1))},(A=fr.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ja=function(){},pr.prototype.a=function(t,e){return new dr(t,e)},j(dr,jt),dr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;Ee(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=hr(t,null,t.fa),Jn(t)},dr.prototype.close=function(){Qn(this.a)},dr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Xn(this.a,e)):this.l?((e={}).__data__=Kt(t),Xn(this.a,e)):Xn(this.a,t)},dr.prototype.G=function(){this.a.f=null,delete this.f,Qn(this.a),delete this.a,dr.X.G.call(this)},j(yr,Ce),j(gr,ke),j(vr,fr),vr.prototype.ta=function(){Bt(this.a,"a")},vr.prototype.sa=function(t){Bt(this.a,new yr(t))},vr.prototype.ra=function(t){Bt(this.a,new gr)},vr.prototype.qa=function(){Bt(this.a,"b")},pr.prototype.createWebChannel=pr.prototype.a,dr.prototype.send=dr.prototype.h,dr.prototype.open=dr.prototype.g,Te.NO_ERROR=0,Te.TIMEOUT=8,Te.HTTP_ERROR=6,Se.COMPLETE="complete",(Ne.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",jt.prototype.listen=jt.prototype.va,Rn.prototype.listenOnce=Rn.prototype.wa,Rn.prototype.getLastError=Rn.prototype.Qa,Rn.prototype.getLastErrorCode=Rn.prototype.ua,Rn.prototype.getStatus=Rn.prototype.W,Rn.prototype.getResponseJson=Rn.prototype.Pa,Rn.prototype.getResponseText=Rn.prototype.$,Rn.prototype.send=Rn.prototype.ba;var mr=ve,br=Te,wr=Se,Er=ye,_r=10,Ir=11,Tr=Ne,Sr=Rn,Dr=(Ar.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Ar.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},Ar);function Ar(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}Dr.o=-1;var Nr=new y("@firebase/firestore");function Cr(){return Nr.logLevel}function kr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=i.DEBUG&&(e=n.map(Rr),Nr.debug.apply(Nr,h(["Firestore (8.3.1): "+t],e)))}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=i.ERROR&&(e=n.map(Rr),Nr.error.apply(Nr,h(["Firestore (8.3.1): "+t],e)))}function xr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=i.WARN&&(e=n.map(Rr),Nr.warn.apply(Nr,h(["Firestore (8.3.1): "+t],e)))}function Rr(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(r){return t}}function Lr(t){throw Or(t="FIRESTORE (8.3.1) INTERNAL ASSERTION FAILED: "+(t=void 0===t?"Unexpected state":t)),new Error(t)}function Pr(t){t||Lr()}var Mr=(Fr.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Fr);function Fr(){}function Vr(t,e){return t<e?-1:e<t?1:0}function qr(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function Ur(t){return t+"\0"}function jr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Br(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Gr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Kr(t){return null==t}function zr(t){return 0===t&&1/t==-1/0}function Hr(t){return"number"==typeof t&&Number.isInteger(t)&&!zr(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Qr,Wr,Yr,Xr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Jr=(a(ui,Yr=Error),ui),$r=(Object.defineProperty(ai.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),ai.prototype.isEqual=function(t){return 0===ai.comparator(this,t)},ai.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ai?t.forEach((function(t){e.push(t)})):e.push(t),this.construct(e)},ai.prototype.limit=function(){return this.offset+this.length},ai.prototype.popFirst=function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)},ai.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},ai.prototype.firstSegment=function(){return this.segments[this.offset]},ai.prototype.lastSegment=function(){return this.get(this.length-1)},ai.prototype.get=function(t){return this.segments[this.offset+t]},ai.prototype.isEmpty=function(){return 0===this.length},ai.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ai.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ai.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ai.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},ai.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},a(si,Wr=Se=ai),si.prototype.construct=function(t,e,n){return new si(t,e,n)},si.prototype.canonicalString=function(){return this.toArray().join("/")},si.prototype.toString=function(){return this.canonicalString()},si.fromString=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Jr(Xr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter((function(t){return 0<t.length})))}return new si(n)},si.emptyPath=function(){return new si([])},si),Zr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ti=(a(oi,Qr=Se),oi.prototype.construct=function(t,e,n){return new oi(t,e,n)},oi.isValidIdentifier=function(t){return Zr.test(t)},oi.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),oi.isValidIdentifier(t)?t:"`"+t+"`"})).join(".")},oi.prototype.toString=function(){return this.canonicalString()},oi.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},oi.keyField=function(){return new oi(["__name__"])},oi.fromServerFormat=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Jr(Xr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Jr(Xr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[r+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new Jr(Xr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=a,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Jr(Xr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new oi(e)},oi.emptyPath=function(){return new oi([])},oi),ei=(ii.fromPath=function(t){return new ii($r.fromString(t))},ii.fromName=function(t){return new ii($r.fromString(t).popFirst(5))},ii.prototype.hasCollectionId=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ii.prototype.isEqual=function(t){return null!==t&&0===$r.comparator(this.path,t.path)},ii.prototype.toString=function(){return this.path.toString()},ii.comparator=function(t,e){return $r.comparator(t.path,e.path)},ii.isDocumentKey=function(t){return t.length%2==0},ii.fromSegments=function(t){return new ii(new $r(t.slice()))},ii),ni=(ri.fromBase64String=function(t){return new ri(atob(t))},ri.fromUint8Array=function(t){return new ri(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},ri.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},ri.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},ri.prototype.approximateByteSize=function(){return 2*this.binaryString.length},ri.prototype.compareTo=function(t){return Vr(this.binaryString,t.binaryString)},ri.prototype.isEqual=function(t){return this.binaryString===t.binaryString},ri);function ri(t){this.binaryString=t}function ii(t){this.path=t}function oi(){return null!==Qr&&Qr.apply(this,arguments)||this}function si(){return null!==Wr&&Wr.apply(this,arguments)||this}function ai(t,e,n){void 0===e?e=0:e>t.length&&Lr(),void 0===n?n=t.length-e:n>t.length-e&&Lr(),this.segments=t,this.offset=e,this.len=n}function ui(t,e){var n=this;return(n=Yr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}ni.EMPTY_BYTE_STRING=new ni("");var ci=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function hi(t){if(Pr(!!t),"string"!=typeof t)return{seconds:li(t.seconds),nanos:li(t.nanos)};var e=0,n=ci.exec(t);return Pr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function li(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function fi(t){return"string"==typeof t?ni.fromBase64String(t):ni.fromUint8Array(t)}var pi=(di.now=function(){return di.fromMillis(Date.now())},di.fromDate=function(t){return di.fromMillis(t.getTime())},di.fromMillis=function(t){var e=Math.floor(t/1e3);return new di(e,1e6*(t-1e3*e))},di.prototype.toDate=function(){return new Date(this.toMillis())},di.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},di.prototype._compareTo=function(t){return this.seconds===t.seconds?Vr(this.nanoseconds,t.nanoseconds):Vr(this.seconds,t.seconds)},di.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},di.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},di.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},di.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},di);function di(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Jr(Xr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Jr(Xr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Jr(Xr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Jr(Xr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function yi(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function gi(t){return t=hi(t.mapValue.fields.__local_write_time__.timestampValue),new pi(t.seconds,t.nanos)}function vi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?yi(t)?4:10:Lr()}function mi(t,e){var n,r,i=vi(t);if(i!==vi(e))return!1;switch(i){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return gi(t).isEqual(gi(e));case 3:return function(e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=hi(t.timestampValue);return e=hi(e.timestampValue),n.seconds===e.seconds&&n.nanos===e.nanos}(e);case 5:return t.stringValue===e.stringValue;case 6:return r=e,fi(t.bytesValue).isEqual(fi(r.bytesValue));case 7:return t.referenceValue===e.referenceValue;case 8:return n=e,li((r=t).geoPointValue.latitude)===li(n.geoPointValue.latitude)&&li(r.geoPointValue.longitude)===li(n.geoPointValue.longitude);case 2:return function(t,e){return"integerValue"in t&&"integerValue"in e?li(t.integerValue)===li(e.integerValue):"doubleValue"in t&&"doubleValue"in e&&((t=li(t.doubleValue))===(e=li(e.doubleValue))?zr(t)===zr(e):isNaN(t)&&isNaN(e))}(t,e);case 9:return qr(t.arrayValue.values||[],e.arrayValue.values||[],mi);case 10:return function(){var n,r=t.mapValue.fields||{},i=e.mapValue.fields||{};if(jr(r)!==jr(i))return!1;for(n in r)if(r.hasOwnProperty(n)&&(void 0===i[n]||!mi(r[n],i[n])))return!1;return!0}();default:return Lr()}}function bi(t,e){return void 0!==(t.values||[]).find((function(t){return mi(t,e)}))}function wi(t,e){var n,r,i,o=vi(t),s=vi(e);if(o!==s)return Vr(o,s);switch(o){case 0:return 0;case 1:return Vr(t.booleanValue,e.booleanValue);case 2:return r=e,(i=li(t.integerValue||t.doubleValue))<(r=li(r.integerValue||r.doubleValue))?-1:r<i?1:i===r?0:isNaN(i)?isNaN(r)?0:-1:1;case 3:return Ei(t.timestampValue,e.timestampValue);case 4:return Ei(gi(t),gi(e));case 5:return Vr(t.stringValue,e.stringValue);case 6:return function(t,e){return t=fi(t),e=fi(e),t.compareTo(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Vr(n[i],r[i]);if(0!==o)return o}return Vr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,i=e.geoPointValue,0!==(r=Vr(li(n.latitude),li(i.latitude)))?r:Vr(li(n.longitude),li(i.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=wi(n[i],r[i]);if(o)return o}return Vr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=Vr(r[s],o[s]);if(0!==a)return a;if(0!==(a=wi(n[r[s]],i[o[s]])))return a}return Vr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Lr()}}function Ei(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Vr(t,e);var n=hi(t);return t=hi(e),0!==(e=Vr(n.seconds,t.seconds))?e:Vr(n.nanos,t.nanos)}function _i(t){return function t(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(t){return"time("+(t=hi(t)).seconds+","+t.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?fi(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,ei.fromName(n).toString()):"geoPointValue"in e?"geo("+(n=e.geoPointValue).latitude+","+n.longitude+")":"arrayValue"in e?function(e){for(var n="[",r=!0,i=0,o=e.values||[];i<o.length;i++)r?r=!1:n+=",",n+=t(o[i]);return n+"]"}(e.arrayValue):"mapValue"in e?function(e){for(var n="{",r=!0,i=0,o=Object.keys(e.fields||{}).sort();i<o.length;i++){var s=o[i];r?r=!1:n+=",",n+=s+":"+t(e.fields[s])}return n+"}"}(e.mapValue):Lr();var n}(t)}function Ii(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function Ti(t){return t&&"integerValue"in t}function Si(t){return!!t&&"arrayValue"in t}function Di(t){return t&&"nullValue"in t}function Ai(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ni(t){return t&&"mapValue"in t}var Ci,ki,Oi,xi=(a(Vi,Oi=y=function(t,e){this.key=t,this.version=e}),Vi.prototype.field=function(t){return this.objectValue.field(t)},Vi.prototype.data=function(){return this.objectValue},Vi.prototype.toProto=function(){return this.objectValue.proto},Vi.prototype.isEqual=function(t){return t instanceof Vi&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.hasLocalMutations===t.hasLocalMutations&&this.hasCommittedMutations===t.hasCommittedMutations&&this.objectValue.isEqual(t.objectValue)},Vi.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.objectValue.toString()+", {hasLocalMutations: "+this.hasLocalMutations+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Vi.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Vi),Ri=(a(Fi,ki=y),Fi.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Fi.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Fi.prototype.isEqual=function(t){return t instanceof Fi&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Fi),Li=(a(Mi,Ci=y),Mi.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Mi.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Mi.prototype.isEqual=function(t){return t instanceof Mi&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Mi),Pi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};function Mi(){return null!==Ci&&Ci.apply(this,arguments)||this}function Fi(t,e,n){var r=this;return(r=ki.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Vi(t,e,n,r){var i=this;return(i=Oi.call(this,t,e)||this).objectValue=n,i.hasLocalMutations=!!r.hasLocalMutations,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function qi(t,e,n,r,i,o,s){return new Pi(t,e=void 0===e?null:e,n=void 0===n?[]:n,r=void 0===r?[]:r,i=void 0===i?null:i,o=void 0===o?null:o,s=void 0===s?null:s)}function Ui(t){var e=t;return null===e.h&&(t=e.path.canonicalString(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((function(t){return(t=t).field.canonicalString()+t.op.toString()+_i(t.value)})).join(","),t+="|ob:",t+=e.orderBy.map((function(t){return(t=t).field.canonicalString()+t.dir})).join(","),Kr(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=go(e.startAt)),e.endAt&&(t+="|ub:",t+=go(e.endAt)),e.h=t),e.h}function ji(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,a=0;a<t.filters.length;a++)if(o=t.filters[a],s=e.filters[a],o.op!==s.op||!o.field.isEqual(s.field)||!mi(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!bo(t.startAt,e.startAt)&&bo(t.endAt,e.endAt)}function Bi(t){return ei.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Gi,Ki=(a(zi,Gi=function(){}),zi.create=function(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.l(t,e,n):new Yi(t,e,n):"array-contains"===e?new so(t,n):"in"===e?new ao(t,n):"not-in"===e?new uo(t,n):"array-contains-any"===e?new co(t,n):new zi(t,e,n)},zi.l=function(t,e,n){return new("in"===e?Xi:Ji)(t,n)},zi.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this.m(wi(t,this.value)):null!==t&&vi(this.value)===vi(t)&&this.m(wi(t,this.value))},zi.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Lr()}},zi.prototype.g=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},zi);function zi(t,e,n){var r=this;return(r=Gi.call(this)||this).field=t,r.op=e,r.value=n,r}var Hi,Qi,Wi,Yi=(a(to,Wi=Ki),to.prototype.matches=function(t){return t=ei.comparator(t.key,this.key),this.m(t)},to),Xi=(a(Zi,Qi=Ki),Zi.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},Zi),Ji=(a($i,Hi=Ki),$i.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},$i);function $i(t,e){var n=this;return(n=Hi.call(this,t,"not-in",e)||this).keys=eo(0,e),n}function Zi(t,e){var n=this;return(n=Qi.call(this,t,"in",e)||this).keys=eo(0,e),n}function to(t,e,n){var r=this;return(r=Wi.call(this,t,e,n)||this).key=ei.fromName(n.referenceValue),r}function eo(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map((function(t){return ei.fromName(t.referenceValue)}))}var no,ro,io,oo,so=(a(yo,oo=Ki),yo.prototype.matches=function(t){return Si(t=t.field(this.field))&&bi(t.arrayValue,this.value)},yo),ao=(a(po,io=Ki),po.prototype.matches=function(t){return null!==(t=t.field(this.field))&&bi(this.value.arrayValue,t)},po),uo=(a(fo,ro=Ki),fo.prototype.matches=function(t){return!bi(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&null!==(t=t.field(this.field))&&!bi(this.value.arrayValue,t)},fo),co=(a(lo,no=Ki),lo.prototype.matches=function(t){var e=this;return!(!Si(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some((function(t){return bi(e.value.arrayValue,t)}))},lo),ho=function(t,e){this.position=t,this.before=e};function lo(t,e){return no.call(this,t,"array-contains-any",e)||this}function fo(t,e){return ro.call(this,t,"not-in",e)||this}function po(t,e){return io.call(this,t,"in",e)||this}function yo(t,e){return oo.call(this,t,"array-contains",e)||this}function go(t){return(t.before?"b":"a")+":"+t.position.map(_i).join(",")}var vo=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function mo(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.isKeyField()?ei.comparator(ei.fromName(s.referenceValue),n.key):wi(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function bo(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!mi(t.position[n],e.position[n]))return!1;return!0}var wo=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null,this.startAt,this.endAt};function Eo(t,e,n,r,i,o,s,a){return new wo(t,e,n,r,i,o,s,a)}function _o(t){return new wo(t)}function Io(t){return!Kr(t.limit)&&"F"===t.limitType}function To(t){return!Kr(t.limit)&&"L"===t.limitType}function So(t){return 0<t.explicitOrderBy.length?t.explicitOrderBy[0].field:null}function Do(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function Ao(t){return null!==t.collectionGroup}function No(t){var e=t;if(null===e.p){e.p=[];var n=Do(e);if(t=So(e),null!==n&&null===t)n.isKeyField()||e.p.push(new vo(n)),e.p.push(new vo(ti.keyField(),"asc"));else{for(var r=!1,i=0,o=e.explicitOrderBy;i<o.length;i++){var s=o[i];e.p.push(s),s.field.isKeyField()&&(r=!0)}r||(n=0<e.explicitOrderBy.length?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc",e.p.push(new vo(ti.keyField(),n)))}}return e.p}function Co(t){var e=t;if(!e.T)if("F"===e.limitType)e.T=qi(e.path,e.collectionGroup,No(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=No(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new vo(o.field,s))}var a=e.endAt?new ho(e.endAt.position,!e.endAt.before):null;t=e.startAt?new ho(e.startAt.position,!e.startAt.before):null,e.T=qi(e.path,e.collectionGroup,n,e.filters,e.limit,a,t)}return e.T}function ko(t,e,n){return new wo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Oo(t,e){return ji(Co(t),Co(e))&&t.limitType===e.limitType}function xo(t){return Ui(Co(t))+"|lt:"+t.limitType}function Ro(t){return"Query(target="+(n=(e=Co(t)).path.canonicalString(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map((function(t){return(t=t).field.canonicalString()+" "+t.op+" "+_i(t.value)})).join(", ")+"]"),Kr(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map((function(t){return(t=t).field.canonicalString()+" ("+t.dir+")"})).join(", ")+"]"),e.startAt&&(n+=", startAt: "+go(e.startAt)),e.endAt&&(n+=", endAt: "+go(e.endAt)),"Target("+n+"); limitType=")+t.limitType+")";var e,n}function Lo(t,e){return n=t,r=e.key.path,(null!==n.collectionGroup?e.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(r):ei.isDocumentKey(n.path)?n.path.isEqual(r):n.path.isImmediateParentOf(r))&&function(e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.field(i.field))return}return 1}(e)&&function(e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return;return 1}(e)&&(r=e,(!(e=t).startAt||mo(e.startAt,No(e),r))&&(!e.endAt||!mo(e.endAt,No(e),r)));var n,r}function Po(t){return function(e,n){for(var r=!1,i=0,o=No(t);i<o.length;i++){var s=o[i],a=function(t,e,n){var r=t.field.isKeyField()?ei.comparator(e.key,n.key):function(t,n){var r=e.field(t);return t=n.field(t),null!==r&&null!==t?wi(r,t):Lr()}(t.field,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Lr()}}(s,e,n);if(0!==a)return a;r=r||s.field.isKeyField()}return 0}}var Mo=(Go.fromTimestamp=function(t){return new Go(t)},Go.min=function(){return new Go(new pi(0,0))},Go.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},Go.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Go.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Go.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Go.prototype.toTimestamp=function(){return this.timestamp},Go),Fo=(Bo.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},Bo.prototype.isEqual=function(t){return qr(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},Bo),Vo=(jo.empty=function(){return new jo({mapValue:{}})},jo.prototype.field=function(t){if(t.isEmpty())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Ni(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},jo.prototype.isEqual=function(t){return mi(this.proto,t.proto)},jo),qo=(Uo.prototype.set=function(t,e){return this.R(t,e),this},Uo.prototype.delete=function(t){return this.R(t,null),this},Uo.prototype.R=function(t,e){for(var n=this.A,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map||(o=o&&10===vi(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),n=o}n.set(t.lastSegment(),e)},Uo.prototype.v=function(){var t=this.P(ti.emptyPath(),this.A);return null!=t?new Vo(t):this.I},Uo.prototype.P=function(t,e){var n=this,r=!1,i=this.I.field(t),o=Ni(i)?Object.assign({},i.mapValue.fields):{};return e.forEach((function(e,i){var s;e instanceof Map?null!=(s=n.P(t.child(i),e))&&(o[i]=s,r=!0):null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)})),r?{mapValue:{fields:o}}:null},Uo);function Uo(t){void 0===t&&(t=Vo.empty()),this.I=t,this.A=new Map}function jo(t){this.proto=t}function Bo(t){(this.fields=t).sort(ti.comparator)}function Go(t){this.timestamp=t}function Ko(t,e){if(t.V){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zr(e)?"-0":e}}function zo(t){return{integerValue:""+t}}function Ho(t,e){return Hr(e)?zo(e):Ko(t,e)}function Qo(t,e){return t instanceof ss?Ti(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var Wo,Yo,Xo=(a(Zo,Yo=Se=function(){this._=void 0}),Zo),Jo=(a($o,Wo=Se),$o);function $o(t){var e=this;return(e=Wo.call(this)||this).elements=t,e}function Zo(){return null!==Yo&&Yo.apply(this,arguments)||this}function ts(t,e){for(var n=cs(e),r=0,i=t.elements;r<i.length;r++)!function(t){n.some((function(e){return mi(e,t)}))||n.push(t)}(i[r]);return{arrayValue:{values:n}}}var es,ns=(a(rs,es=Se),rs);function rs(t){var e=this;return(e=es.call(this)||this).elements=t,e}function is(t,e){for(var n=cs(e),r=0,i=t.elements;r<i.length;r++)!function(t){n=n.filter((function(e){return!mi(e,t)}))}(i[r]);return{arrayValue:{values:n}}}var os,ss=(a(as,os=Se),as);function as(t,e){var n=this;return(n=os.call(this)||this).D=t,n.S=e,n}function us(t){return li(t.integerValue||t.doubleValue)}function cs(t){return Si(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function hs(t,e){this.version=t,this.transformResults=e}var ls=function(t,e){this.field=t,this.transform=e},fs=(ps.none=function(){return new ps},ps.exists=function(t){return new ps(void 0,t)},ps.updateTime=function(t){return new ps(t)},Object.defineProperty(ps.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),ps.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},ps);function ps(t,e){this.updateTime=t,this.exists=e}function ds(t,e){return void 0!==t.updateTime?e instanceof xi&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof xi}function ys(t,e,n){return t instanceof ws?function(t,e,n){if(!ds(t.precondition,e))return e;var r=t.value;return n=Ds(t.fieldTransforms,n,e),r=As(t.fieldTransforms,r,n),e=vs(e),new xi(t.key,e,r,{hasLocalMutations:!0})}(t,e,n):t instanceof Es?function(t,e,n){if(!ds(t.precondition,e))return e;var r=vs(e);return e=Ts(t,e,Ds(t.fieldTransforms,n,e)),new xi(t.key,r,e,{hasLocalMutations:!0})}(t,e,n):(e=e,ds((t=t).precondition,e)?new Ri(t.key,Mo.min()):e)}function gs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&(n=t.fieldTransforms,r=e.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&qr(n,r,(function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof Jo&&e instanceof Jo||t instanceof ns&&e instanceof ns?qr(t.elements,e.elements,mi):t instanceof ss&&e instanceof ss?mi(t.S,e.S):t instanceof Xo&&e instanceof Xo)}))))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask));var n,r}function vs(t){return t instanceof xi?t.version:Mo.min()}var ms,bs,ws=(a(Is,bs=y=function(){}),Is),Es=(a(_s,ms=y),_s);function _s(t,e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=ms.call(this)||this).key=t,o.data=e,o.fieldMask=n,o.precondition=r,o.fieldTransforms=i,o.type=1,o}function Is(t,e,n,r){void 0===r&&(r=[]);var i=this;return(i=bs.call(this)||this).key=t,i.value=e,i.precondition=n,i.fieldTransforms=r,i.type=0,i}function Ts(t,e,n){var r,i,o;return i=t,e=r=e instanceof xi?e.data():Vo.empty(),o=new qo(e),i.fieldMask.fields.forEach((function(t){var e;t.isEmpty()||(null!==(e=i.data.field(t))?o.set(t,e):o.delete(t))})),r=o.v(),As(t.fieldTransforms,r,n)}function Ss(t,e,n){var r=[];Pr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=null;e instanceof xi&&(a=e.field(o.field)),r.push((o=s,s=a,a=n[i],o instanceof Jo?ts(o,s):o instanceof ns?is(o,s):a))}return r}function Ds(t,e,n){for(var r,i=[],o=0,s=t;o<s.length;o++){var a=s[o],u=a.transform,c=null;n instanceof xi&&(c=n.field(a.field)),i.push((r=c,a=e,c=void 0,(u=u)instanceof Xo?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},r&&(c.fields.__previous_value__=r),{mapValue:c}):u instanceof Jo?ts(u,r):u instanceof ns?is(u,r):(r=us(u=Qo(c=u,r))+us(c.S),Ti(u)&&Ti(c.S)?zo(r):Ko(c.D,r))))}return i}function As(t,e,n){for(var r=new qo(e),i=0;i<t.length;i++){var o=t[i];r.set(o.field,n[i])}return r.v()}function Ns(t){this.count=t}var Cs,ks,Os,xs=(a(Ps,Os=y),Ps),Rs=(a(Ls,ks=y),Ls);function Ls(t,e){var n=this;return(n=ks.call(this)||this).key=t,n.precondition=e,n.type=3,n.fieldTransforms=[],n}function Ps(t,e){var n=this;return(n=Os.call(this)||this).key=t,n.precondition=e,n.type=2,n.fieldTransforms=[],n}function Ms(t){switch(t){case Xr.OK:return Lr(),0;case Xr.CANCELLED:case Xr.UNKNOWN:case Xr.DEADLINE_EXCEEDED:case Xr.RESOURCE_EXHAUSTED:case Xr.INTERNAL:case Xr.UNAVAILABLE:case Xr.UNAUTHENTICATED:return;case Xr.INVALID_ARGUMENT:case Xr.NOT_FOUND:case Xr.ALREADY_EXISTS:case Xr.PERMISSION_DENIED:case Xr.FAILED_PRECONDITION:case Xr.ABORTED:case Xr.OUT_OF_RANGE:case Xr.UNIMPLEMENTED:case Xr.DATA_LOSS:return 1;default:return Lr(),0}}function Fs(t){if(void 0===t)return Or("GRPC error has no .code"),Xr.UNKNOWN;switch(t){case Cs.OK:return Xr.OK;case Cs.CANCELLED:return Xr.CANCELLED;case Cs.UNKNOWN:return Xr.UNKNOWN;case Cs.DEADLINE_EXCEEDED:return Xr.DEADLINE_EXCEEDED;case Cs.RESOURCE_EXHAUSTED:return Xr.RESOURCE_EXHAUSTED;case Cs.INTERNAL:return Xr.INTERNAL;case Cs.UNAVAILABLE:return Xr.UNAVAILABLE;case Cs.UNAUTHENTICATED:return Xr.UNAUTHENTICATED;case Cs.INVALID_ARGUMENT:return Xr.INVALID_ARGUMENT;case Cs.NOT_FOUND:return Xr.NOT_FOUND;case Cs.ALREADY_EXISTS:return Xr.ALREADY_EXISTS;case Cs.PERMISSION_DENIED:return Xr.PERMISSION_DENIED;case Cs.FAILED_PRECONDITION:return Xr.FAILED_PRECONDITION;case Cs.ABORTED:return Xr.ABORTED;case Cs.OUT_OF_RANGE:return Xr.OUT_OF_RANGE;case Cs.UNIMPLEMENTED:return Xr.UNIMPLEMENTED;case Cs.DATA_LOSS:return Xr.DATA_LOSS;default:return Lr()}}(Se=Cs=Cs||{})[Se.OK=0]="OK",Se[Se.CANCELLED=1]="CANCELLED",Se[Se.UNKNOWN=2]="UNKNOWN",Se[Se.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Se[Se.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Se[Se.NOT_FOUND=5]="NOT_FOUND",Se[Se.ALREADY_EXISTS=6]="ALREADY_EXISTS",Se[Se.PERMISSION_DENIED=7]="PERMISSION_DENIED",Se[Se.UNAUTHENTICATED=16]="UNAUTHENTICATED",Se[Se.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Se[Se.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Se[Se.ABORTED=10]="ABORTED",Se[Se.OUT_OF_RANGE=11]="OUT_OF_RANGE",Se[Se.UNIMPLEMENTED=12]="UNIMPLEMENTED",Se[Se.INTERNAL=13]="INTERNAL",Se[Se.UNAVAILABLE=14]="UNAVAILABLE",Se[Se.DATA_LOSS=15]="DATA_LOSS";var Vs=(Gs.prototype.insert=function(t,e){return new Gs(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Us.BLACK,null,null))},Gs.prototype.remove=function(t){return new Gs(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Us.BLACK,null,null))},Gs.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Gs.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Gs.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(Gs.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Gs.prototype.minKey=function(){return this.root.minKey()},Gs.prototype.maxKey=function(){return this.root.maxKey()},Gs.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},Gs.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},Gs.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},Gs.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},Gs.prototype.getIterator=function(){return new qs(this.root,null,this.comparator,!1)},Gs.prototype.getIteratorFrom=function(t){return new qs(this.root,t,this.comparator,!1)},Gs.prototype.getReverseIterator=function(){return new qs(this.root,null,this.comparator,!0)},Gs.prototype.getReverseIteratorFrom=function(t){return new qs(this.root,t,this.comparator,!0)},Gs),qs=(Bs.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},Bs.prototype.hasNext=function(){return 0<this.nodeStack.length},Bs.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},Bs),Us=(js.prototype.copy=function(t,e,n,r,i){return new js(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},js.prototype.isEmpty=function(){return!1},js.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},js.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},js.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},js.prototype.minKey=function(){return this.min().key},js.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},js.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},js.prototype.removeMin=function(){if(this.left.isEmpty())return js.EMPTY;var t=this;return(t=(t=t.left.isRed()||t.left.left.isRed()?t:t.moveRedLeft()).copy(null,null,null,t.left.removeMin(),null)).fixUp()},js.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r=(r=r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()?r:r.moveRedLeft()).copy(null,null,null,r.left.remove(t,e),null);else{if(0===e(t,(r=(r=r.left.isRed()?r.rotateRight():r).right.isEmpty()||r.right.isRed()||r.right.left.isRed()?r:r.moveRedRight()).key)){if(r.right.isEmpty())return js.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.fixUp()},js.prototype.isRed=function(){return this.color},js.prototype.fixUp=function(){var t=this;return(t=(t=t.right.isRed()&&!t.left.isRed()?t.rotateLeft():t).left.isRed()&&t.left.left.isRed()?t.rotateRight():t).left.isRed()&&t.right.isRed()?t.colorFlip():t},js.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()?(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip():t},js.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()?(t=t.rotateRight()).colorFlip():t},js.prototype.rotateLeft=function(){var t=this.copy(null,null,js.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},js.prototype.rotateRight=function(){var t=this.copy(null,null,js.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},js.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},js.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},js.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw Lr();if(this.right.isRed())throw Lr();var t=this.left.check();if(t!==this.right.check())throw Lr();return t+(this.isRed()?0:1)},js);function js(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:js.RED,this.left=null!=r?r:js.EMPTY,this.right=null!=i?i:js.EMPTY,this.size=this.left.size+1+this.right.size}function Bs(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}function Gs(t,e){this.comparator=t,this.root=e||Us.EMPTY}function Ks(){this.size=0}Us.EMPTY=null,Us.RED=!0,Us.BLACK=!1,Us.EMPTY=(Object.defineProperty(Ks.prototype,"key",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ks.prototype,"value",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ks.prototype,"color",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ks.prototype,"left",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ks.prototype,"right",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Ks.prototype.copy=function(t,e,n,r,i){return this},Ks.prototype.insert=function(t,e,n){return new Us(t,e)},Ks.prototype.remove=function(t,e){return this},Ks.prototype.isEmpty=function(){return!0},Ks.prototype.inorderTraversal=function(t){return!1},Ks.prototype.reverseTraversal=function(t){return!1},Ks.prototype.minKey=function(){return null},Ks.prototype.maxKey=function(){return null},Ks.prototype.isRed=function(){return!1},Ks.prototype.checkMaxDepth=function(){return!0},Ks.prototype.check=function(){return 0},new Ks);var zs=(Ys.prototype.has=function(t){return null!==this.data.get(t)},Ys.prototype.first=function(){return this.data.minKey()},Ys.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(Ys.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Ys.prototype.indexOf=function(t){return this.data.indexOf(t)},Ys.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},Ys.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(0<=this.comparator(r.key,t[1]))return;e(r.key)}},Ys.prototype.forEachWhile=function(t,e){for(var n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},Ys.prototype.firstAfterOrEqual=function(t){return(t=this.data.getIteratorFrom(t)).hasNext()?t.getNext().key:null},Ys.prototype.getIterator=function(){return new Hs(this.data.getIterator())},Ys.prototype.getIteratorFrom=function(t){return new Hs(this.data.getIteratorFrom(t))},Ys.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},Ys.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Ys.prototype.isEmpty=function(){return this.data.isEmpty()},Ys.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},Ys.prototype.isEqual=function(t){if(!(t instanceof Ys))return!1;if(this.size!==t.size)return!1;for(var e=this.data.getIterator(),n=t.data.getIterator();e.hasNext();){var r=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(r,i))return!1}return!0},Ys.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},Ys.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},Ys.prototype.copy=function(t){var e=new Ys(this.comparator);return e.data=t,e},Ys),Hs=(Ws.prototype.getNext=function(){return this.iter.getNext().key},Ws.prototype.hasNext=function(){return this.iter.hasNext()},Ws),Qs=new Vs(ei.comparator);function Ws(t){this.iter=t}function Ys(t){this.comparator=t,this.data=new Vs(this.comparator)}var Xs=new Vs(ei.comparator),Js=new Vs(ei.comparator),$s=new zs(ei.comparator);function Zs(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=$s,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var ta=new zs(Vr),ea=(la.createSynthesizedRemoteEventForCurrentChange=function(t,e){var n=new Map;return n.set(t,na.createSynthesizedTargetChangeForCurrentChange(t,e)),new la(Mo.min(),n,ta,Qs,Zs())},la),na=(ha.createSynthesizedTargetChangeForCurrentChange=function(t,e){return new ha(ni.EMPTY_BYTE_STRING,e,Zs(),Zs(),Zs())},ha),ra=function(t,e,n,r){this.C=t,this.removedTargetIds=e,this.key=n,this.N=r},ia=function(t,e){this.targetId=t,this.$=e},oa=function(t,e,n,r){void 0===n&&(n=ni.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},sa=(Object.defineProperty(ca.prototype,"current",{get:function(){return this.M},enumerable:!1,configurable:!0}),Object.defineProperty(ca.prototype,"resumeToken",{get:function(){return this.k},enumerable:!1,configurable:!0}),Object.defineProperty(ca.prototype,"B",{get:function(){return 0!==this.F},enumerable:!1,configurable:!0}),Object.defineProperty(ca.prototype,"q",{get:function(){return this.L},enumerable:!1,configurable:!0}),ca.prototype.U=function(t){0<t.approximateByteSize()&&(this.L=!0,this.k=t)},ca.prototype.K=function(){var t=Zs(),e=Zs(),n=Zs();return this.O.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Lr()}})),new na(this.k,this.M,t,e,n)},ca.prototype.W=function(){this.L=!1,this.O=pa()},ca.prototype.j=function(t,e){this.L=!0,this.O=this.O.insert(t,e)},ca.prototype.G=function(t){this.L=!0,this.O=this.O.remove(t)},ca.prototype.H=function(){this.F+=1},ca.prototype.J=function(){--this.F},ca.prototype.Y=function(){this.L=!0,this.M=!0},ca),aa=(ua.prototype.st=function(t){for(var e=0,n=t.C;e<n.length;e++){var r=n[e];t.N instanceof xi?this.it(r,t.N):t.N instanceof Ri&&this.rt(r,t.key,t.N)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.rt(r,t.key,t.N)},ua.prototype.ot=function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.ct(n);switch(t.state){case 0:e.at(n)&&r.U(t.resumeToken);break;case 1:r.J(),r.B||r.W(),r.U(t.resumeToken);break;case 2:r.J(),r.B||e.removeTarget(n);break;case 3:e.at(n)&&(r.Y(),r.U(t.resumeToken));break;case 4:e.at(n)&&(e.ut(n),r.U(t.resumeToken));break;default:Lr()}}))},ua.prototype.forEachTarget=function(t,e){var n=this;0<t.targetIds.length?t.targetIds.forEach(e):this.Z.forEach((function(t,r){n.at(r)&&e(r)}))},ua.prototype.ht=function(t){var e=t.targetId,n=t.$.count;(t=this.lt(e))&&(Bi(t=t.target)?0===n?(t=new ei(t.path),this.rt(e,t,new Ri(t,Mo.min()))):Pr(1===n):this.ft(e)!==n&&(this.ut(e),this.nt=this.nt.add(e)))},ua.prototype.dt=function(t){var e=this,n=new Map;this.Z.forEach((function(r,i){var o=e.lt(i);o&&(r.current&&Bi(o.target)&&(o=new ei(o.target.path),null!==e.tt.get(o)||e.wt(i,o)||e.rt(i,o,new Ri(o,t))),r.q&&(n.set(i,r.K()),r.W()))}));var r=Zs();this.et.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){return!(t=e.lt(t))||2===t.purpose||(i=!1)})),i&&(r=r.add(t))}));var i=new ea(t,n,this.nt,this.tt,r);return this.tt=Qs,this.et=fa(),this.nt=new zs(Vr),i},ua.prototype.it=function(t,e){var n;this.at(t)&&(n=this.wt(t,e.key)?2:0,this.ct(t).j(e.key,n),this.tt=this.tt.insert(e.key,e),this.et=this.et.insert(e.key,this._t(e.key).add(t)))},ua.prototype.rt=function(t,e,n){var r;this.at(t)&&(r=this.ct(t),this.wt(t,e)?r.j(e,1):r.G(e),this.et=this.et.insert(e,this._t(e).delete(t)),n&&(this.tt=this.tt.insert(e,n)))},ua.prototype.removeTarget=function(t){this.Z.delete(t)},ua.prototype.ft=function(t){var e=this.ct(t).K();return this.X.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},ua.prototype.H=function(t){this.ct(t).H()},ua.prototype.ct=function(t){var e=this.Z.get(t);return e||(e=new sa,this.Z.set(t,e)),e},ua.prototype._t=function(t){var e=this.et.get(t);return e||(e=new zs(Vr),this.et=this.et.insert(t,e)),e},ua.prototype.at=function(t){var e=null!==this.lt(t);return e||kr("WatchChangeAggregator","Detected inactive target",t),e},ua.prototype.lt=function(t){var e=this.Z.get(t);return e&&e.B?null:this.X.yt(t)},ua.prototype.ut=function(t){var e=this;this.Z.set(t,new sa),this.X.getRemoteKeysForTarget(t).forEach((function(n){e.rt(t,n,null)}))},ua.prototype.wt=function(t,e){return this.X.getRemoteKeysForTarget(t).has(e)},ua);function ua(t){this.X=t,this.Z=new Map,this.tt=Qs,this.et=fa(),this.nt=new zs(Vr)}function ca(){this.F=0,this.O=pa(),this.k=ni.EMPTY_BYTE_STRING,this.M=!1,this.L=!0}function ha(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}function la(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}function fa(){return new Vs(ei.comparator)}function pa(){return new Vs(ei.comparator)}var da={asc:"ASCENDING",desc:"DESCENDING"},ya={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ga=function(t,e){this.databaseId=t,this.V=e};function va(t,e){return t.V?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function ma(t,e){return t.V?e.toBase64():e.toUint8Array()}function ba(t){return Pr(!!t),Mo.fromTimestamp((t=hi(t),new pi(t.seconds,t.nanos)))}function wa(t,e){return new $r(["projects",t.projectId,"databases",t.database]).child("documents").child(e).canonicalString()}function Ea(t){return Pr(ja(t=$r.fromString(t))),t}function _a(t,e){return wa(t.databaseId,e.path)}function Ia(t,e){if((e=Ea(e)).get(1)!==t.databaseId.projectId)throw new Jr(Xr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.databaseId.projectId);if(e.get(3)!==t.databaseId.database)throw new Jr(Xr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.databaseId.database);return new ei(Aa(e))}function Ta(t,e){return wa(t.databaseId,e)}function Sa(t){return 4===(t=Ea(t)).length?$r.emptyPath():Aa(t)}function Da(t){return new $r(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Aa(t){return Pr(4<t.length&&"documents"===t.get(4)),t.popFirst(5)}function Na(t,e,n){return{name:_a(t,e),fields:n.proto.mapValue.fields}}function Ca(t,e,n){var r=Ia(t,e.name);return t=ba(e.updateTime),e=new Vo({mapValue:{fields:e.fields}}),new xi(r,t,e,{hasCommittedMutations:!!n})}function ka(t,e){var n,r,i;if(e instanceof ws)n={update:Na(t,e.key,e.value)};else if(e instanceof xs)n={delete:_a(t,e.key)};else if(e instanceof Es)n={update:Na(t,e.key,e.data),updateMask:(i=e.fieldMask,r=[],i.fields.forEach((function(t){return r.push(t.canonicalString())})),{fieldPaths:r})};else{if(!(e instanceof Rs))return Lr();n={verify:_a(t,e.key)}}return 0<e.fieldTransforms.length&&(n.updateTransforms=e.fieldTransforms.map((function(t){var e=t.transform;if(e instanceof Xo)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(e instanceof Jo)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:e.elements}};if(e instanceof ns)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:e.elements}};if(e instanceof ss)return{fieldPath:t.field.canonicalString(),increment:e.S};throw Lr()}))),e.precondition.isNone||(n.currentDocument=void 0!==(i=e.precondition).updateTime?{updateTime:(e=t,t=i.updateTime,va(e,t.toTimestamp()))}:void 0!==i.exists?{exists:i.exists}:Lr()),n}function Oa(t,e){var n=e.currentDocument?void 0!==(s=e.currentDocument).updateTime?fs.updateTime(ba(s.updateTime)):void 0!==s.exists?fs.exists(s.exists):fs.none():fs.none(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n,r=null;return"setToServerValue"in e?(Pr("REQUEST_TIME"===e.setToServerValue),r=new Xo):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],r=new Jo(n)):"removeAllFromArray"in e?(n=e.removeAllFromArray.values||[],r=new ns(n)):"increment"in e?r=new ss(t,e.increment):Lr(),e=ti.fromServerFormat(e.fieldPath),new ls(e,r)}(t,e)})):[];if(e.update){e.update.name;var i=Ia(t,e.update.name),o=new Vo({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=(s=e.updateMask.fieldPaths||[],new Fo(s.map((function(t){return ti.fromServerFormat(t)}))));return new Es(i,o,s,n,r)}return new ws(i,o,n,r)}return e.delete?(r=Ia(t,e.delete),new xs(r,n)):e.verify?(e=Ia(t,e.verify),new Rs(e,n)):Lr()}function xa(t,e){return{documents:[Ta(t,e.path)]}}function Ra(t,e){var n={structuredQuery:{}},r=e.path;return null!==e.collectionGroup?(n.parent=Ta(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Ta(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),(r=function(t){if(0!==t.length)return 1===(t=t.map((function(t){if("=="===t.op){if(Ai(t.value))return{unaryFilter:{field:Fa(t.field),op:"IS_NAN"}};if(Di(t.value))return{unaryFilter:{field:Fa(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Ai(t.value))return{unaryFilter:{field:Fa(t.field),op:"IS_NOT_NAN"}};if(Di(t.value))return{unaryFilter:{field:Fa(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fa(t.field),op:(e=t.op,ya[e]),value:t.value}};var e}))).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(e.filters))&&(n.structuredQuery.where=r),(r=function(t){if(0!==t.length)return t.map((function(t){return{field:Fa((t=t).field),direction:(t=t.dir,da[t])}}))}(e.orderBy))&&(n.structuredQuery.orderBy=r),r=e.limit,null!==(r=t.V||Kr(r)?r:{value:r})&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=Pa(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Pa(e.endAt)),n}function La(t){var e=Sa(t.parent),n=t.structuredQuery,r=null;0<(s=n.from?n.from.length:0)&&(Pr(1===s),(a=n.from[0]).allDescendants?r=a.collectionId:e=e.child(a.collectionId));var i=[];n.where&&(i=function t(e){return e?void 0!==e.unaryFilter?[Ua(e)]:void 0!==e.fieldFilter?[qa(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((function(e){return t(e)})).reduce((function(t,e){return t.concat(e)})):Lr():[]}(n.where));var o=[],s=(t=null,null),a=null;return Eo(e,r,o=n.orderBy?n.orderBy.map((function(t){return new vo(Va((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e})):o,i,t=n.limit?Kr(i="object"==typeof(i=n.limit)?i.value:i)?null:i:t,"F",s=n.startAt?Ma(n.startAt):s,a=n.endAt?Ma(n.endAt):a)}function Pa(t){return{before:t.before,values:t.position}}function Ma(t){var e=!!t.before;return t=t.values||[],new ho(t,e)}function Fa(t){return{fieldPath:t.canonicalString()}}function Va(t){return ti.fromServerFormat(t.fieldPath)}function qa(t){return Ki.create(Va(t.fieldFilter.field),function(){switch(t.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Lr()}}(),t.fieldFilter.value)}function Ua(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Va(t.unaryFilter.field);return Ki.create(e,"==",{doubleValue:NaN});case"IS_NULL":return e=Va(t.unaryFilter.field),Ki.create(e,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var n=Va(t.unaryFilter.field);return Ki.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return n=Va(t.unaryFilter.field),Ki.create(n,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Lr()}}function ja(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Ba(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=Ga(e)),e=function(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}(t.get(n),e);return Ga(e)}function Ga(t){return t+"\x01\x01"}function Ka(t){var e=t.length;if(Pr(2<=e),2===e)return Pr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),$r.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||n<s)&&Lr(),t.charAt(s+1)){case"\x01":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:Lr()}o=s+2}return new $r(r)}function za(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}var Ha=function(t,e){this.seconds=t,this.nanoseconds=e};function Qa(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}function Wa(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}za.store="owner",za.key="owner",Qa.store="mutationQueues",Qa.keyPath="userId",Wa.store="mutations",Wa.keyPath="batchId",Wa.userMutationsIndex="userMutationsIndex",Wa.userMutationsKeyPath=["userId","batchId"];var Ya=(Xa.prefixForUser=function(t){return[t]},Xa.prefixForPath=function(t,e){return[t,Ba(e)]},Xa.key=function(t,e,n){return[t,Ba(e),n]},Xa);function Xa(){}function Ja(t,e){this.path=t,this.readTime=e}function $a(t,e){this.path=t,this.version=e}Ya.store="documentMutations",Ya.PLACEHOLDER=new Ya;var Za=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};function tu(t){this.byteSize=t}function eu(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s}Za.store="remoteDocuments",Za.readTimeIndex="readTimeIndex",Za.readTimeIndexPath="readTime",Za.collectionReadTimeIndex="collectionReadTimeIndex",Za.collectionReadTimeIndexPath=["parentPath","readTime"],tu.store="remoteDocumentGlobal",tu.key="remoteDocumentGlobalKey",eu.store="targets",eu.keyPath="targetId",eu.queryTargetsIndexName="queryTargetsIndex",eu.queryTargetsKeyPath=["canonicalId","targetId"];var nu=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};function ru(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}function iu(t,e){this.collectionId=t,this.parent=e}function ou(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r}function su(t,e,n){this.bundleId=t,this.createTime=e,this.version=n}function au(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n}nu.store="targetDocuments",nu.keyPath=["targetId","path"],nu.documentTargetsIndex="documentTargetsIndex",nu.documentTargetsKeyPath=["path","targetId"],ru.key="targetGlobalKey",ru.store="targetGlobal",iu.store="collectionParents",iu.keyPath=["collectionId","parent"],ou.store="clientMetadata",ou.keyPath="clientId",su.store="bundles",su.keyPath="bundleId",au.store="namedQueries",au.keyPath="name";var uu,cu=h(h([],h(h([],h(h([],h(h([],[Qa.store,Wa.store,Ya.store,Za.store,eu.store,za.store,ru.store,nu.store]),[ou.store])),[tu.store])),[iu.store])),[su.store,au.store]),hu="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",lu=(_u.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},_u.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},y=_u,function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}),fu=(Eu.prototype.catch=function(t){return this.next(void 0,t)},Eu.prototype.next=function(t,e){var n=this;return this.callbackAttached&&Lr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new Eu((function(r,i){n.nextCallback=function(e){n.wrapSuccess(t,e).next(r,i)},n.catchCallback=function(t){n.wrapFailure(e,t).next(r,i)}}))},Eu.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},Eu.prototype.wrapUserFunction=function(t){try{var e=t();return e instanceof Eu?e:Eu.resolve(e)}catch(t){return Eu.reject(t)}},Eu.prototype.wrapSuccess=function(t,e){return t?this.wrapUserFunction((function(){return t(e)})):Eu.resolve(e)},Eu.prototype.wrapFailure=function(t,e){return t?this.wrapUserFunction((function(){return t(e)})):Eu.reject(e)},Eu.resolve=function(t){return new Eu((function(e,n){e(t)}))},Eu.reject=function(t){return new Eu((function(e,n){n(t)}))},Eu.waitFor=function(t){return new Eu((function(e,n){var r=0,i=0,o=!1;t.forEach((function(t){++r,t.next((function(){++i,o&&i===r&&e()}),(function(t){return n(t)}))})),o=!0,i===r&&e()}))},Eu.or=function(t){for(var e=Eu.resolve(!1),n=0,r=t;n<r.length;n++)!function(t){e=e.next((function(e){return e?Eu.resolve(e):t()}))}(r[n]);return e},Eu.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)},Eu),pu=(wu.open=function(t,e,n,r){try{return new wu(e,t.transaction(r,n))}catch(t){throw new gu(e,t)}},Object.defineProperty(wu.prototype,"Et",{get:function(){return this.gt.promise},enumerable:!1,configurable:!0}),wu.prototype.abort=function(t){t&&this.gt.reject(t),this.aborted||(kr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},wu.prototype.store=function(t){return t=this.transaction.objectStore(t),new Tu(t)},wu),du=(bu.delete=function(t){return kr("SimpleDb","Removing database:",t),Du(window.indexedDB.deleteDatabase(t)).toPromise()},bu.At=function(){if("undefined"==typeof indexedDB)return!1;if(bu.Rt())return!0;var t=v(),e=0<(n=bu.It(t))&&n<10,n=0<(n=bu.bt(t))&&n<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||e||n)},bu.Rt=function(){var t;return"undefined"!=typeof e&&"YES"===(null===(t=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_GA_4_ID:"G-CNF32VVWZE"}))||void 0===t?void 0:t.vt)},bu.Pt=function(t,e){return t.store(e)},bu.It=function(t){return t=(t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i))?t[1].split("_").slice(0,2).join("."):"-1",Number(t)},bu.bt=function(t){return t=(t=t.match(/Android ([\d.]+)/i))?t[1].split(".").slice(0,2).join("."):"-1",Number(t)},bu.prototype.Vt=function(t){return u(this,void 0,void 0,(function(){var e,n=this;return c(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(kr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){t=t.target.result,e(t)},i.onblocked=function(){r(new gu(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){"VersionError"===(e=e.target.error).name?r(new Jr(Xr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new gu(t,e))},i.onupgradeneeded=function(t){kr("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.Tt.St(e,i.transaction,t.oldVersion,n.version).next((function(){kr("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Dt&&(this.db.onversionchange=function(t){return n.Dt(t)}),this.db)]}}))}))},bu.prototype.Ct=function(t){this.Dt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},bu.prototype.runTransaction=function(t,e,n,r){return u(this,void 0,void 0,(function(){var i,o,s,a;return c(this,(function(u){switch(u.label){case 0:i="readonly"===e,o=0,a=function(){var e,a,u;return c(this,(function(c){switch(c.label){case 0:++o,c.label=1;case 1:return c.trys.push([1,4,,5]),[4,s.Vt(t)];case 2:return s.db=c.sent(),e=pu.open(s.db,t,i?"readonly":"readwrite",n),a=r(e).catch((function(t){return e.abort(t),fu.reject(t)})).toPromise(),u={},a.catch((function(){})),[4,e.Et];case 3:return[2,(u.value=(c.sent(),a),u)];case 4:return a=c.sent(),u="FirebaseError"!==a.name&&o<3,kr("SimpleDb","Transaction failed with error:",a.message,"Retrying:",u),s.close(),u?[3,5]:[2,{value:Promise.reject(a)}];case 5:return[2]}}))},s=this,u.label=1;case 1:return[5,a()];case 2:if("object"==typeof(a=u.sent()))return[2,a.value];u.label=3;case 3:return[3,1];case 4:return[2]}}))}))},bu.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},bu),yu=(Object.defineProperty(mu.prototype,"isDone",{get:function(){return this.Nt},enumerable:!1,configurable:!0}),Object.defineProperty(mu.prototype,"Ft",{get:function(){return this.$t},enumerable:!1,configurable:!0}),Object.defineProperty(mu.prototype,"cursor",{set:function(t){this.xt=t},enumerable:!1,configurable:!0}),mu.prototype.done=function(){this.Nt=!0},mu.prototype.Ot=function(t){this.$t=t},mu.prototype.delete=function(){return Du(this.xt.delete())},mu),gu=(a(vu,uu=Jr),vu);function vu(t,e){var n=this;return(n=uu.call(this,Xr.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function mu(t){this.xt=t,this.Nt=!1,this.$t=null}function bu(t,e,n){this.name=t,this.version=e,this.Tt=n,12.2===bu.It(v())&&Or("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function wu(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.gt=new lu,this.transaction.oncomplete=function(){n.gt.resolve()},this.transaction.onabort=function(){e.error?n.gt.reject(new gu(t,e.error)):n.gt.resolve()},this.transaction.onerror=function(e){e=Nu(e.target.error),n.gt.reject(new gu(t,e))}}function Eu(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}function _u(){this.onCommittedListeners=[]}function Iu(t){return"IndexedDbTransactionError"===t.name}var Tu=(Su.prototype.put=function(t,e){return Du(t=void 0!==e?(kr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(kr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},Su.prototype.add=function(t){return kr("SimpleDb","ADD",this.store.name,t,t),Du(this.store.add(t))},Su.prototype.get=function(t){var e=this;return Du(this.store.get(t)).next((function(n){return void 0===n&&(n=null),kr("SimpleDb","GET",e.store.name,t,n),n}))},Su.prototype.delete=function(t){return kr("SimpleDb","DELETE",this.store.name,t),Du(this.store.delete(t))},Su.prototype.count=function(){return kr("SimpleDb","COUNT",this.store.name),Du(this.store.count())},Su.prototype.kt=function(t,e){e=this.cursor(this.options(t,e));var n=[];return this.Mt(e,(function(t,e){n.push(e)})).next((function(){return n}))},Su.prototype.Lt=function(t,e){return kr("SimpleDb","DELETE ALL",this.store.name),(e=this.options(t,e)).Bt=!1,e=this.cursor(e),this.Mt(e,(function(t,e,n){return n.delete()}))},Su.prototype.qt=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.Mt(n,e)},Su.prototype.Ut=function(t){var e=this.cursor({});return new fu((function(n,r){e.onerror=function(t){t=Nu(t.target.error),r(t)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},Su.prototype.Mt=function(t,e){var n=[];return new fu((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i,o=t.target.result;o?(i=new yu(o),(t=e(o.primaryKey,o.value,i))instanceof fu&&(t=t.catch((function(t){return i.done(),fu.reject(t)})),n.push(t)),i.isDone?r():null===i.Ft?o.continue():o.continue(i.Ft)):r()}})).next((function(){return fu.waitFor(n)}))},Su.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Su.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Bt?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Su);function Su(t){this.store=t}function Du(t){return new fu((function(e,n){t.onsuccess=function(t){t=t.target.result,e(t)},t.onerror=function(t){t=Nu(t.target.error),n(t)}}))}var Au=!1;function Nu(t){var e=du.It(v());if(12.2<=e&&e<13&&(e="An internal error was encountered in the Indexed Database server",0<=t.message.indexOf(e))){var n=new Jr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Au||(Au=!0,setTimeout((function(){throw n}),0)),n}return t}var Cu,ku=(a(Ou,Cu=y),Ou);function Ou(t,e){var n=this;return(n=Cu.call(this)||this).Qt=t,n.currentSequenceNumber=e,n}function xu(t,e){return du.Pt(t.Qt,e)}var Ru=(qu.prototype.applyToRemoteDocument=function(t,e,n){for(var r,i,o,s,a,u,c=n.mutationResults,h=0;h<this.mutations.length;h++){var l=this.mutations[h];l.key.isEqual(t)&&(r=l,i=e,o=c[h],l=u=a=s=void 0,e=r instanceof ws?(a=o,u=(s=r).value,l=Ss(s.fieldTransforms,i,a.transformResults),u=As(s.fieldTransforms,u,l),new xi(s.key,a.version,u,{hasCommittedMutations:!0})):r instanceof Es?function(t,e,n){return ds(t.precondition,e)?(e=Ts(t,e,Ss(t.fieldTransforms,e,n.transformResults)),new xi(t.key,n.version,e,{hasCommittedMutations:!0})):new Li(t.key,n.version)}(r,i,o):new Ri(r.key,o.version,{hasCommittedMutations:!0}))}return e},qu.prototype.applyToLocalView=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++)(i=r[n]).key.isEqual(t)&&(e=ys(i,e,this.localWriteTime));for(var i,o=0,s=this.mutations;o<s.length;o++)(i=s[o]).key.isEqual(t)&&(e=ys(i,e,this.localWriteTime));return e},qu.prototype.applyToLocalDocumentSet=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.applyToLocalView(r.key,t.get(r.key));i&&(n=n.insert(r.key,i))})),n},qu.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),Zs())},qu.prototype.isEqual=function(t){return this.batchId===t.batchId&&qr(this.mutations,t.mutations,gs)&&qr(this.baseMutations,t.baseMutations,gs)},qu),Lu=(Vu.from=function(t,e,n){Pr(t.mutations.length===n.length);for(var r=Js,i=t.mutations,o=0;o<i.length;o++)r=r.insert(i[o].key,n[o].version);return new Vu(t,e,n,r)},Vu),Pu=(Fu.prototype.withSequenceNumber=function(t){return new Fu(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Fu.prototype.withResumeToken=function(t,e){return new Fu(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Fu.prototype.withLastLimboFreeSnapshotVersion=function(t){return new Fu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)},Fu),Mu=function(t){this.Kt=t};function Fu(t,e,n,r,i,o,s){void 0===i&&(i=Mo.min()),void 0===o&&(o=Mo.min()),void 0===s&&(s=ni.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Vu(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}function qu(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}function Uu(t,e){if(e.document)return Ca(t.Kt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=ei.fromSegments(e.noDocument.path),r=zu(e.noDocument.readTime);return new Ri(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}return e.unknownDocument?(n=ei.fromSegments(e.unknownDocument.path),r=zu(e.unknownDocument.version),new Li(n,r)):Lr()}function ju(t,e,n){var r=Bu(n);if(n=e.key.path.popLast().toArray(),e instanceof xi){var i={name:_a(o=t.Kt,(s=e).key),fields:s.toProto().mapValue.fields,updateTime:va(o,s.version.toTimestamp())},o=e.hasCommittedMutations;return new Za(null,null,i,o,r,n)}if(e instanceof Ri){var s=e.key.path.toArray();return i=Ku(e.version),o=e.hasCommittedMutations,new Za(null,new Ja(s,i),null,o,r,n)}return e instanceof Li?(o=e.key.path.toArray(),e=Ku(e.version),new Za(new $a(o,e),null,null,!0,r,n)):Lr()}function Bu(t){return[(t=t.toTimestamp()).seconds,t.nanoseconds]}function Gu(t){return t=new pi(t[0],t[1]),Mo.fromTimestamp(t)}function Ku(t){return t=t.toTimestamp(),new Ha(t.seconds,t.nanoseconds)}function zu(t){return t=new pi(t.seconds,t.nanoseconds),Mo.fromTimestamp(t)}function Hu(t,e){for(var n=(e.baseMutations||[]).map((function(e){return Oa(t.Kt,e)})),r=0;r<e.mutations.length-1;++r){var i,o=e.mutations[r];r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform&&(i=e.mutations[r+1],o.updateTransforms=i.transform.fieldTransforms,e.mutations.splice(r+1,1),++r)}var s=e.mutations.map((function(e){return Oa(t.Kt,e)})),a=pi.fromMillis(e.localWriteTimeMs);return new Ru(e.batchId,a,n,s)}function Qu(t){var e=zu(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?zu(t.lastLimboFreeSnapshotVersion):Mo.min(),r=void 0!==t.query.documents?(Pr(1===(r=t.query).documents.length),Co(_o(Sa(r.documents[0])))):Co(La(t.query));return new Pu(r,t.targetId,0,t.lastListenSequenceNumber,e,n,ni.fromBase64String(t.resumeToken))}function Wu(t,e){var n=Ku(e.snapshotVersion),r=Ku(e.lastLimboFreeSnapshotVersion),i=(Bi(e.target)?xa:Ra)(t.Kt,e.target);return t=e.resumeToken.toBase64(),new eu(e.targetId,Ui(e.target),n,t,e.sequenceNumber,r,i)}function Yu(t){var e=La({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?ko(e,e.limit,"L"):e}var Xu=(Ju.prototype.getBundleMetadata=function(t,e){return $u(t).get(e).next((function(t){if(t)return{id:(t=t).bundleId,createTime:zu(t.createTime),version:t.version}}))},Ju.prototype.saveBundleMetadata=function(t,e){return $u(t).put({bundleId:(e=e).id,createTime:Ku(ba(e.createTime)),version:e.version})},Ju.prototype.getNamedQuery=function(t,e){return Zu(t).get(e).next((function(t){if(t)return{name:(t=t).name,query:Yu(t.bundledQuery),readTime:zu(t.readTime)}}))},Ju.prototype.saveNamedQuery=function(t,e){return Zu(t).put({name:(e=e).name,readTime:Ku(ba(e.readTime)),bundledQuery:e.bundledQuery})},Ju);function Ju(){}function $u(t){return xu(t,su.store)}function Zu(t){return xu(t,au.store)}var tc=(oc.prototype.addToCollectionParentIndex=function(t,e){return this.Wt.add(e),fu.resolve()},oc.prototype.getCollectionParents=function(t,e){return fu.resolve(this.Wt.getEntries(e))},oc),ec=(ic.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new zs($r.comparator);return t=!r.has(n),this.index[e]=r.add(n),t},ic.prototype.has=function(t){var e=t.lastSegment();return t=t.popLast(),(e=this.index[e])&&e.has(t)},ic.prototype.getEntries=function(t){return(this.index[t]||new zs($r.comparator)).toArray()},ic),nc=(rc.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(this.jt.has(e))return fu.resolve();var r=e.lastSegment(),i=e.popLast();return t.addOnCommittedListener((function(){n.jt.add(e)})),i={collectionId:r,parent:Ba(i)},sc(t).put(i)},rc.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Ur(e),""],!1,!0);return sc(t).kt(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Ka(o.parent))}return n}))},rc);function rc(){this.jt=new ec}function ic(){this.index={}}function oc(){this.Wt=new ec}function sc(t){return xu(t,iu.store)}var ac={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},uc=(cc.withCacheSize=function(t){return new cc(t,cc.DEFAULT_COLLECTION_PERCENTILE,cc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},cc);function cc(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}function hc(t,e,n){var r=t.store(Wa.store),i=t.store(Ya.store),o=[],s=(t=IDBKeyRange.only(n.batchId),0);t=r.qt({range:t},(function(t,e,n){return s++,n.delete()})),o.push(t.next((function(){Pr(1===s)})));for(var a=[],u=0,c=n.mutations;u<c.length;u++){var h=c[u],l=Ya.key(e,h.key.path,n.batchId);o.push(i.delete(l)),a.push(h.key)}return fu.waitFor(o).next((function(){return a}))}function lc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Lr();e=t.noDocument}return JSON.stringify(e).length}uc.DEFAULT_COLLECTION_PERCENTILE=10,uc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,uc.DEFAULT=new uc(41943040,uc.DEFAULT_COLLECTION_PERCENTILE,uc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),uc.DISABLED=new uc(-1,0,0);var fc=(pc.Ht=function(t,e,n,r){return Pr(""!==t.uid),new pc(t.isAuthenticated()?t.uid:"",e,n,r)},pc.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return yc(t).qt({index:Wa.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},pc.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=gc(t),s=yc(t);return s.add({}).next((function(a){Pr("number"==typeof a);for(var u,c,h,l,f,p=new Ru(a,e,n,r),d=(u=i.D,c=i.userId,l=(h=p).baseMutations.map((function(t){return ka(u.Kt,t)})),f=h.mutations.map((function(t){return ka(u.Kt,t)})),new Wa(c,h.batchId,h.localWriteTime.toMillis(),l,f)),y=[],g=new zs((function(t,e){return Vr(t.canonicalString(),e.canonicalString())})),v=0,m=r;v<m.length;v++){var b=m[v],w=Ya.key(i.userId,b.key.path,a);g=g.add(b.key.path.popLast()),y.push(s.put(d)),y.push(o.put(w,Ya.PLACEHOLDER))}return g.forEach((function(e){y.push(i.Gt.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){i.zt[a]=p.keys()})),fu.waitFor(y).next((function(){return p}))}))},pc.prototype.lookupMutationBatch=function(t,e){var n=this;return yc(t).get(e).next((function(t){return t?(Pr(t.userId===n.userId),Hu(n.D,t)):null}))},pc.prototype.Jt=function(t,e){var n=this;return this.zt[e]?fu.resolve(this.zt[e]):this.lookupMutationBatch(t,e).next((function(t){return t?(t=t.keys(),n.zt[e]=t):null}))},pc.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=(e=IDBKeyRange.lowerBound([this.userId,r]),null);return yc(t).qt({index:Wa.userMutationsIndex,range:e},(function(t,e,o){e.userId===n.userId&&(Pr(e.batchId>=r),i=Hu(n.D,e)),o.done()})).next((function(){return i}))},pc.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return yc(t).qt({index:Wa.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},pc.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return yc(t).kt(Wa.userMutationsIndex,n).next((function(t){return t.map((function(t){return Hu(e.D,t)}))}))},pc.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=Ya.prefixForPath(this.userId,e.path),i=(r=IDBKeyRange.lowerBound(r),[]);return gc(t).qt({range:r},(function(r,o,s){var a=r[0],u=r[1];if(r=r[2],u=Ka(u),a===n.userId&&e.path.isEqual(u))return yc(t).get(r).next((function(t){if(!t)throw Lr();Pr(t.userId===n.userId),i.push(Hu(n.D,t))}));s.done()})).next((function(){return i}))},pc.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new zs(Vr),i=[];return e.forEach((function(e){var o=Ya.prefixForPath(n.userId,e.path);o=IDBKeyRange.lowerBound(o),o=gc(t).qt({range:o},(function(t,i,o){var s=t[0],a=t[1];t=t[2],a=Ka(a),s===n.userId&&e.path.isEqual(a)?r=r.add(t):o.done()})),i.push(o)})),fu.waitFor(i).next((function(){return n.Yt(t,r)}))},pc.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=(e=Ya.prefixForPath(this.userId,r),e=IDBKeyRange.lowerBound(e),new zs(Vr));return gc(t).qt({range:e},(function(t,e,s){var a=t[0],u=t[1];t=t[2],u=Ka(u),a===n.userId&&r.isPrefixOf(u)?u.length===i&&(o=o.add(t)):s.done()})).next((function(){return n.Yt(t,o)}))},pc.prototype.Yt=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(yc(t).get(e).next((function(t){if(null===t)throw Lr();Pr(t.userId===n.userId),r.push(Hu(n.D,t))})))})),fu.waitFor(i).next((function(){return r}))},pc.prototype.removeMutationBatch=function(t,e){var n=this;return hc(t.Qt,this.userId,e).next((function(r){return t.addOnCommittedListener((function(){n.Xt(e.batchId)})),fu.forEach(r,(function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)}))}))},pc.prototype.Xt=function(t){delete this.zt[t]},pc.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return fu.resolve();n=IDBKeyRange.lowerBound(Ya.prefixForUser(e.userId));var r=[];return gc(t).qt({range:n},(function(t,n,i){t[0]===e.userId?(t=Ka(t[1]),r.push(t)):i.done()})).next((function(){Pr(0===r.length)}))}))},pc.prototype.containsKey=function(t,e){return dc(t,this.userId,e)},pc.prototype.Zt=function(t){var e=this;return vc(t).get(this.userId).next((function(t){return t||new Qa(e.userId,-1,"")}))},pc);function pc(t,e,n,r){this.userId=t,this.D=e,this.Gt=n,this.referenceDelegate=r,this.zt={}}function dc(t,e,n){var r=(n=Ya.prefixForPath(e,n.path))[1],i=(n=IDBKeyRange.lowerBound(n),!1);return gc(t).qt({range:n,Bt:!0},(function(t,n,o){var s=t[0],a=t[1];t[2],s===e&&a===r&&(i=!0),o.done()})).next((function(){return i}))}function yc(t){return xu(t,Wa.store)}function gc(t){return xu(t,Ya.store)}function vc(t){return xu(t,Qa.store)}var mc=(Ec.prototype.next=function(){return this.te+=2,this.te},Ec.ee=function(){return new Ec(0)},Ec.ne=function(){return new Ec(-1)},Ec),bc=(wc.prototype.allocateTargetId=function(t){var e=this;return this.se(t).next((function(n){var r=new mc(n.highestTargetId);return n.highestTargetId=r.next(),e.ie(t,n).next((function(){return n.highestTargetId}))}))},wc.prototype.getLastRemoteSnapshotVersion=function(t){return this.se(t).next((function(t){return Mo.fromTimestamp(new pi(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},wc.prototype.getHighestSequenceNumber=function(t){return this.se(t).next((function(t){return t.highestListenSequenceNumber}))},wc.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.se(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.ie(t,i)}))},wc.prototype.addTargetData=function(t,e){var n=this;return this.re(t,e).next((function(){return n.se(t).next((function(r){return r.targetCount+=1,n.oe(e,r),n.ie(t,r)}))}))},wc.prototype.updateTargetData=function(t,e){return this.re(t,e)},wc.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return _c(t).delete(e.targetId)})).next((function(){return n.se(t)})).next((function(e){return Pr(0<e.targetCount),--e.targetCount,n.ie(t,e)}))},wc.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return _c(t).qt((function(s,a){(a=Qu(a)).sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.removeTargetData(t,a)))})).next((function(){return fu.waitFor(o)})).next((function(){return i}))},wc.prototype.forEachTarget=function(t,e){return _c(t).qt((function(t,n){n=Qu(n),e(n)}))},wc.prototype.se=function(t){return Ic(t).get(ru.key).next((function(t){return Pr(null!==t),t}))},wc.prototype.ie=function(t,e){return Ic(t).put(ru.key,e)},wc.prototype.re=function(t,e){return _c(t).put(Wu(this.D,e))},wc.prototype.oe=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},wc.prototype.getTargetCount=function(t){return this.se(t).next((function(t){return t.targetCount}))},wc.prototype.getTargetData=function(t,e){var n=Ui(e),r=(n=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),null);return _c(t).qt({range:n,index:eu.queryTargetsIndexName},(function(t,n,i){n=Qu(n),ji(e,n.target)&&(r=n,i.done())})).next((function(){return r}))},wc.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=Tc(t);return e.forEach((function(e){var s=Ba(e.path);i.push(o.put(new nu(n,s))),i.push(r.referenceDelegate.addReference(t,n,e))})),fu.waitFor(i)},wc.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=Tc(t);return fu.forEach(e,(function(e){var o=Ba(e.path);return fu.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])}))},wc.prototype.removeMatchingKeysForTargetId=function(t,e){return t=Tc(t),e=IDBKeyRange.bound([e],[e+1],!1,!0),t.delete(e)},wc.prototype.getMatchingKeysForTargetId=function(t,e){e=IDBKeyRange.bound([e],[e+1],!1,!0),t=Tc(t);var n=Zs();return t.qt({range:e,Bt:!0},(function(t,e,r){t=Ka(t[1]),t=new ei(t),n=n.add(t)})).next((function(){return n}))},wc.prototype.containsKey=function(t,e){e=Ba(e.path),e=IDBKeyRange.bound([e],[Ur(e)],!1,!0);var n=0;return Tc(t).qt({index:nu.documentTargetsIndex,Bt:!0,range:e},(function(t,e,r){var i=t[0];t[1],0!==i&&(n++,r.done())})).next((function(){return 0<n}))},wc.prototype.yt=function(t,e){return _c(t).get(e).next((function(t){return t?Qu(t):null}))},wc);function wc(t,e){this.referenceDelegate=t,this.D=e}function Ec(t){this.te=t}function _c(t){return xu(t,eu.store)}function Ic(t){return xu(t,ru.store)}function Tc(t){return xu(t,nu.store)}function Sc(t){return u(this,void 0,void 0,(function(){return c(this,(function(e){if(t.code!==Xr.FAILED_PRECONDITION||t.message!==hu)throw t;return kr("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}function Dc(t,e){var n=t[0],r=t[1];return t=e[0],e=e[1],0===(t=Vr(n,t))?Vr(r,e):t}var Ac=(Lc.prototype.ue=function(){return++this.ae},Lc.prototype.he=function(t){var e=[t,this.ue()];this.buffer.size<this.ce?this.buffer=this.buffer.add(e):Dc(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(Lc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),Lc),Nc=(Rc.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.de(t)},Rc.prototype.stop=function(){this.fe&&(this.fe.cancel(),this.fe=null)},Object.defineProperty(Rc.prototype,"started",{get:function(){return null!==this.fe},enumerable:!1,configurable:!0}),Rc.prototype.de=function(t){var e=this,n=this.le?3e5:6e4;kr("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.fe=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,(function(){return u(e,void 0,void 0,(function(){var e;return c(this,(function(n){switch(n.label){case 0:this.fe=null,this.le=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return Iu(e=n.sent())?(kr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Sc(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.de(t)];case 8:return n.sent(),[2]}}))}))}))},Rc),Cc=(xc.prototype.calculateTargetCount=function(t,e){return this.we._e(t).next((function(t){return Math.floor(e/100*t)}))},xc.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return fu.resolve(Dr.o);var r=new Ac(e);return this.we.forEachTarget(t,(function(t){return r.he(t.sequenceNumber)})).next((function(){return n.we.me(t,(function(t){return r.he(t)}))})).next((function(){return r.maxValue}))},xc.prototype.removeTargets=function(t,e,n){return this.we.removeTargets(t,e,n)},xc.prototype.removeOrphanedDocuments=function(t,e){return this.we.removeOrphanedDocuments(t,e)},xc.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(kr("LruGarbageCollector","Garbage collection skipped; disabled"),fu.resolve(ac)):this.getCacheSize(t).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(kr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),ac):n.ye(t,e)}))},xc.prototype.getCacheSize=function(t){return this.we.getCacheSize(t)},xc.prototype.ye=function(t,e){var n,r,o,s,a,u,c,h=this,l=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return r=e>h.params.maximumSequenceNumbersToCollect?(kr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.maximumSequenceNumbersToCollect+" from "+e),h.params.maximumSequenceNumbersToCollect):e,s=Date.now(),h.nthSequenceNumber(t,r)})).next((function(r){return n=r,a=Date.now(),h.removeTargets(t,n,e)})).next((function(e){return o=e,u=Date.now(),h.removeOrphanedDocuments(t,n)})).next((function(t){return c=Date.now(),Cr()<=i.DEBUG&&kr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-l)+"ms\n\tDetermined least recently used "+r+" in "+(a-s)+"ms\n\tRemoved "+o+" targets in "+(u-a)+"ms\n\tRemoved "+t+" documents in "+(c-u)+"ms\nTotal Duration: "+(c-l)+"ms"),fu.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:o,documentsRemoved:t})}))},xc),kc=(Oc.prototype._e=function(t){var e=this.ge(t);return this.db.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},Oc.prototype.ge=function(t){var e=0;return this.me(t,(function(t){e++})).next((function(){return e}))},Oc.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},Oc.prototype.me=function(t,e){return this.pe(t,(function(t,n){return e(n)}))},Oc.prototype.addReference=function(t,e,n){return Pc(t,n)},Oc.prototype.removeReference=function(t,e,n){return Pc(t,n)},Oc.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},Oc.prototype.markPotentiallyOrphaned=Pc,Oc.prototype.Ee=function(t,e){return r=e,i=!1,vc(n=t).Ut((function(t){return dc(n,t,r).next((function(t){return t&&(i=!0),fu.resolve(!t)}))})).next((function(){return i}));var n,r,i},Oc.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.pe(t,(function(s,a){a<=e&&(a=n.Ee(t,s).next((function(e){if(!e)return o++,r.getEntry(t,s).next((function(){return r.removeEntry(s),Tc(t).delete([0,Ba(s.path)])}))})),i.push(a))})).next((function(){return fu.waitFor(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},Oc.prototype.removeTarget=function(t,e){return e=e.withSequenceNumber(t.currentSequenceNumber),this.db.getTargetCache().updateTargetData(t,e)},Oc.prototype.updateLimboDocument=Pc,Oc.prototype.pe=function(t,e){t=Tc(t);var n,r=Dr.o;return t.qt({index:nu.documentTargetsIndex},(function(t,i){var o=t[0];t[1],t=i.path,i=i.sequenceNumber,0===o?(r!==Dr.o&&e(new ei(Ka(n)),r),r=i,n=t):r=Dr.o})).next((function(){r!==Dr.o&&e(new ei(Ka(n)),r)}))},Oc.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},Oc);function Oc(t,e){this.db=t,this.garbageCollector=new Cc(this,e)}function xc(t,e){this.we=t,this.params=e}function Rc(t,e){this.garbageCollector=t,this.asyncQueue=e,this.le=!1,this.fe=null}function Lc(t){this.ce=t,this.buffer=new zs(Dc),this.ae=0}function Pc(t,e){return Tc(t).put((t=t.currentSequenceNumber,new nu(0,Ba(e.path),t)))}var Mc,Fc=(Gc.prototype.get=function(t){var e=this.mapKeyFn(t);if(void 0!==(e=this.inner[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.equalsFn(i,t))return o}},Gc.prototype.has=function(t){return void 0!==this.get(t)},Gc.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},Gc.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},Gc.prototype.forEach=function(t){Br(this.inner,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=(s=i[r])[0],s=s[1];t(o,s)}}))},Gc.prototype.isEmpty=function(){return Gr(this.inner)},Gc),Vc=(Bc.prototype.getReadTime=function(t){return(t=this.changes.get(t))?t.readTime:Mo.min()},Bc.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{maybeDocument:t,readTime:e})},Bc.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{maybeDocument:null,readTime:e})},Bc.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?fu.resolve(n.maybeDocument):this.getFromCache(t,e)},Bc.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},Bc.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},Bc.prototype.assertNotApplied=function(){},Se=Bc,jc.prototype.addEntry=function(t,e,n){return zc(t).put(Hc(e),n)},jc.prototype.removeEntry=function(t,e){return t=zc(t),e=Hc(e),t.delete(e)},jc.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.Te(t,r)}))},jc.prototype.getEntry=function(t,e){var n=this;return zc(t).get(Hc(e)).next((function(t){return n.Ie(t)}))},jc.prototype.Ae=function(t,e){var n=this;return zc(t).get(Hc(e)).next((function(t){var e=n.Ie(t);return e?{maybeDocument:e,size:lc(t)}:null}))},jc.prototype.getEntries=function(t,e){var n=this,r=Qs;return this.Re(t,e,(function(t,e){e=n.Ie(e),r=r.insert(t,e)})).next((function(){return r}))},jc.prototype.be=function(t,e){var n=this,r=Qs,i=new Vs(ei.comparator);return this.Re(t,e,(function(t,e){var o=n.Ie(e);i=o?(r=r.insert(t,o),i.insert(t,lc(e))):(r=r.insert(t,null),i.insert(t,0))})).next((function(){return{ve:r,Pe:i}}))},jc.prototype.Re=function(t,e,n){if(e.isEmpty())return fu.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return zc(t).qt({range:r},(function(t,e,r){for(var s=ei.fromSegments(t);o&&ei.comparator(o,s)<0;)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ot(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},jc.prototype.getDocumentsMatchingQuery=function(t,e,n){var r,i=this,o=Xs,s=e.path.length+1,a={};return n.isEqual(Mo.min())?(r=e.path.toArray(),a.range=IDBKeyRange.lowerBound(r)):(r=e.path.toArray(),n=Bu(n),a.range=IDBKeyRange.lowerBound([r,n],!0),a.index=Za.collectionReadTimeIndex),zc(t).qt(a,(function(t,n,r){t.length===s&&(n=Uu(i.D,n),e.path.isPrefixOf(n.key.path)?n instanceof xi&&Lo(e,n)&&(o=o.insert(n.key,n)):r.done())})).next((function(){return o}))},jc.prototype.newChangeBuffer=function(t){return new qc(this,!!t&&t.trackRemovals)},jc.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},jc.prototype.getMetadata=function(t){return Kc(t).get(tu.key).next((function(t){return Pr(!!t),t}))},jc.prototype.Te=function(t,e){return Kc(t).put(tu.key,e)},jc.prototype.Ie=function(t){return t?(t=Uu(this.D,t))instanceof Ri&&t.version.isEqual(Mo.min())?null:t:null},jc),qc=(a(Uc,Mc=Se),Uc.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new zs((function(t,e){return Vr(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(o,s){var a,u=e.Se.get(o);s.maybeDocument?(a=ju(e.Ve.D,s.maybeDocument,e.getReadTime(o)),i=i.add(o.path.popLast()),s=lc(a),r+=s-u,n.push(e.Ve.addEntry(t,o,a))):(r-=u,e.trackRemovals?(u=ju(e.Ve.D,new Ri(o,Mo.min()),e.getReadTime(o)),n.push(e.Ve.addEntry(t,o,u))):n.push(e.Ve.removeEntry(t,o)))})),i.forEach((function(r){n.push(e.Ve.Gt.addToCollectionParentIndex(t,r))})),n.push(this.Ve.updateMetadata(t,r)),fu.waitFor(n)},Uc.prototype.getFromCache=function(t,e){var n=this;return this.Ve.Ae(t,e).next((function(t){return null===t?(n.Se.set(e,0),null):(n.Se.set(e,t.size),t.maybeDocument)}))},Uc.prototype.getAllFromCache=function(t,e){var n=this;return this.Ve.be(t,e).next((function(t){var e=t.ve;return t.Pe.forEach((function(t,e){n.Se.set(t,e)})),e}))},Uc);function Uc(t,e){var n=this;return(n=Mc.call(this)||this).Ve=t,n.trackRemovals=e,n.Se=new Fc((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),n}function jc(t,e){this.D=t,this.Gt=e}function Bc(){this.changes=new Fc((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.changesApplied=!1}function Gc(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}function Kc(t){return xu(t,tu.store)}function zc(t){return xu(t,Za.store)}function Hc(t){return t.path.toArray()}var Qc=(Wc.prototype.St=function(t,e,n,r){var i=this;Pr(n<r&&0<=n&&r<=11);var o=new pu("createOrUpgrade",e);n<1&&1<=r&&(t.createObjectStore(za.store),(s=t).createObjectStore(Qa.store,{keyPath:Qa.keyPath}),s.createObjectStore(Wa.store,{keyPath:Wa.keyPath,autoIncrement:!0}).createIndex(Wa.userMutationsIndex,Wa.userMutationsKeyPath,{unique:!0}),s.createObjectStore(Ya.store),Yc(t),t.createObjectStore(Za.store));var s,a=fu.resolve();return n<3&&3<=r&&(0!==n&&((s=t).deleteObjectStore(nu.store),s.deleteObjectStore(eu.store),s.deleteObjectStore(ru.store),Yc(t)),a=a.next((function(){return t=o.store(ru.store),e=new ru(0,0,Mo.min().toTimestamp(),0),t.put(ru.key,e);var t,e}))),n<4&&4<=r&&(a=(a=0!==n?a.next((function(){return e=t,(n=o).store(Wa.store).kt().next((function(t){e.deleteObjectStore(Wa.store),e.createObjectStore(Wa.store,{keyPath:Wa.keyPath,autoIncrement:!0}).createIndex(Wa.userMutationsIndex,Wa.userMutationsKeyPath,{unique:!0});var r=n.store(Wa.store);return t=t.map((function(t){return r.put(t)})),fu.waitFor(t)}));var e,n})):a).next((function(){t.createObjectStore(ou.store,{keyPath:ou.keyPath})}))),n<5&&5<=r&&(a=a.next((function(){return i.De(o)}))),n<6&&6<=r&&(a=a.next((function(){return t.createObjectStore(tu.store),i.Ce(o)}))),n<7&&7<=r&&(a=a.next((function(){return i.xe(o)}))),n<8&&8<=r&&(a=a.next((function(){return i.Ne(t,o)}))),n<9&&9<=r&&(a=a.next((function(){var n;(n=t).objectStoreNames.contains("remoteDocumentChanges")&&n.deleteObjectStore("remoteDocumentChanges"),(n=e.objectStore(Za.store)).createIndex(Za.readTimeIndex,Za.readTimeIndexPath,{unique:!1}),n.createIndex(Za.collectionReadTimeIndex,Za.collectionReadTimeIndexPath,{unique:!1})}))),n<10&&10<=r&&(a=a.next((function(){return i.$e(o)}))),n<11&&11<=r?a.next((function(){t.createObjectStore(su.store,{keyPath:su.keyPath}),t.createObjectStore(au.store,{keyPath:au.keyPath})})):a},Wc.prototype.Ce=function(t){var e=0;return t.store(Za.store).qt((function(t,n){e+=lc(n)})).next((function(){var n=new tu(e);return t.store(tu.store).put(tu.key,n)}))},Wc.prototype.De=function(t){var e=this,n=t.store(Qa.store),r=t.store(Wa.store);return n.kt().next((function(n){return fu.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.kt(Wa.userMutationsIndex,i).next((function(r){return fu.forEach(r,(function(r){return Pr(r.userId===n.userId),r=Hu(e.D,r),hc(t,n.userId,r).next((function(){}))}))}))}))}))},Wc.prototype.xe=function(t){var e=t.store(nu.store),n=t.store(Za.store);return t.store(ru.store).get(ru.key).next((function(t){var r=[];return n.qt((function(n,i){var o=new $r(n);n=[0,Ba(o)],r.push(e.get(n).next((function(n){return n?fu.resolve():e.put(new nu(0,Ba(o),t.highestListenSequenceNumber))})))})).next((function(){return fu.waitFor(r)}))}))},Wc.prototype.Ne=function(t,e){function n(t){if(i.add(t)){var e=t.lastSegment();return t=t.popLast(),r.put({collectionId:e,parent:Ba(t)})}}t.createObjectStore(iu.store,{keyPath:iu.keyPath});var r=e.store(iu.store),i=new ec;return e.store(Za.store).qt({Bt:!0},(function(t,e){return n((t=new $r(t)).popLast())})).next((function(){return e.store(Ya.store).qt({Bt:!0},(function(t,e){t[0];var r=t[1];return n((t[2],r=Ka(r)).popLast())}))}))},Wc.prototype.$e=function(t){var e=this,n=t.store(eu.store);return n.qt((function(t,r){return r=Qu(r),r=Wu(e.D,r),n.put(r)}))},Wc);function Wc(t){this.D=t}function Yc(t){t.createObjectStore(nu.store,{keyPath:nu.keyPath}).createIndex(nu.documentTargetsIndex,nu.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(eu.store,{keyPath:eu.keyPath}).createIndex(eu.queryTargetsIndexName,eu.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(ru.store)}var Xc="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Jc=($c.prototype.start=function(){var t=this;return this.Ye().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Jr(Xr.FAILED_PRECONDITION,Xc);return t.Xe(),t.Ze(),t.tn(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.Ge.getHighestSequenceNumber(e)}))})).then((function(e){t.Me=new Dr(e,t.Oe)})).then((function(){t.Le=!0})).catch((function(e){return t.je&&t.je.close(),Promise.reject(e)}))},$c.prototype.en=function(t){var e=this;return this.Ke=function(n){return u(e,void 0,void 0,(function(){return c(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},$c.prototype.setDatabaseDeletedListener=function(t){var e=this;this.je.Ct((function(n){return u(e,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},$c.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Fe.enqueueAndForget((function(){return u(e,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return this.started?[4,this.Ye()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},$c.prototype.Ye=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return th(e).put(new ou(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.nn(e).next((function(e){e||(t.isPrimary=!1,t.Fe.enqueueRetryable((function(){return t.Ke(!1)})))}))})).next((function(){return t.sn(e)})).next((function(n){return t.isPrimary&&!n?t.rn(e).next((function(){return!1})):!!n&&t.on(e).next((function(){return!0}))}))})).catch((function(e){if(Iu(e))return kr("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return kr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Fe.enqueueRetryable((function(){return t.Ke(e)})),t.isPrimary=e}))},$c.prototype.nn=function(t){var e=this;return Zc(t).get(za.key).next((function(t){return fu.resolve(e.cn(t))}))},$c.prototype.an=function(t){return th(t).delete(this.clientId)},$c.prototype.un=function(){return u(this,void 0,void 0,(function(){var t,e,n,r,i=this;return c(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.hn(this.Qe,18e5)?[3,2]:(this.Qe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=xu(t,ou.store);return e.kt().next((function(t){var n=i.ln(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return fu.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=o.sent(),this.Je)for(e=0,n=t;e<n.length;e++)r=n[e],this.Je.removeItem(this.fn(r.clientId));o.label=2;case 2:return[2]}}))}))},$c.prototype.tn=function(){var t=this;this.Ue=this.Fe.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return t.Ye().then((function(){return t.un()})).then((function(){return t.tn()}))}))},$c.prototype.cn=function(t){return!!t&&t.ownerId===this.clientId},$c.prototype.sn=function(t){var e=this;return this.ke?fu.resolve(!0):Zc(t).get(za.key).next((function(n){if(null!==n&&e.hn(n.leaseTimestampMs,5e3)&&!e.dn(n.ownerId)){if(e.cn(n)&&e.networkEnabled)return!0;if(!e.cn(n)){if(!n.allowTabSynchronization)throw new Jr(Xr.FAILED_PRECONDITION,Xc);return!1}}return!(!e.networkEnabled||!e.inForeground)||th(t).kt().next((function(t){return void 0===e.ln(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground;if(t=e.networkEnabled===t.networkEnabled,n||r&&t)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&kr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},$c.prototype.shutdown=function(){return u(this,void 0,void 0,(function(){var t=this;return c(this,(function(e){switch(e.label){case 0:return this.Le=!1,this.wn(),this.Ue&&(this.Ue.cancel(),this.Ue=null),this._n(),this.mn(),[4,this.je.runTransaction("shutdown","readwrite",[za.store,ou.store],(function(e){var n=new ku(e,Dr.o);return t.rn(n).next((function(){return t.an(n)}))}))];case 1:return e.sent(),this.je.close(),this.yn(),[2]}}))}))},$c.prototype.ln=function(t,e){var n=this;return t.filter((function(t){return n.hn(t.updateTimeMs,e)&&!n.dn(t.clientId)}))},$c.prototype.gn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return th(e).kt().next((function(e){return t.ln(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty($c.prototype,"started",{get:function(){return this.Le},enumerable:!1,configurable:!0}),$c.prototype.getMutationQueue=function(t){return fc.Ht(t,this.D,this.Gt,this.referenceDelegate)},$c.prototype.getTargetCache=function(){return this.Ge},$c.prototype.getRemoteDocumentCache=function(){return this.ze},$c.prototype.getIndexManager=function(){return this.Gt},$c.prototype.getBundleCache=function(){return this.He},$c.prototype.runTransaction=function(t,e,n){var r=this;kr("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.je.runTransaction(t,o,cu,(function(o){return i=new ku(o,r.Me?r.Me.next():Dr.o),"readwrite-primary"===e?r.nn(i).next((function(t){return!!t||r.sn(i)})).next((function(e){if(!e)throw Or("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Fe.enqueueRetryable((function(){return r.Ke(!1)})),new Jr(Xr.FAILED_PRECONDITION,hu);return n(i)})).next((function(t){return r.on(i).next((function(){return t}))})):r.pn(i).next((function(){return n(i)}))})).then((function(t){return i.raiseOnCommittedEvent(),t}))},$c.prototype.pn=function(t){var e=this;return Zc(t).get(za.key).next((function(t){if(null!==t&&e.hn(t.leaseTimestampMs,5e3)&&!e.dn(t.ownerId)&&!e.cn(t)&&!(e.ke||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Jr(Xr.FAILED_PRECONDITION,Xc)}))},$c.prototype.on=function(t){var e=new za(this.clientId,this.allowTabSynchronization,Date.now());return Zc(t).put(za.key,e)},$c.At=function(){return du.At()},$c.prototype.rn=function(t){var e=this,n=Zc(t);return n.get(za.key).next((function(t){return e.cn(t)?(kr("IndexedDbPersistence","Releasing primary lease."),n.delete(za.key)):fu.resolve()}))},$c.prototype.hn=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Or("Detected an update time that is in the future: "+t+" > "+n),1))},$c.prototype.Xe=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.qe=function(){t.Fe.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.Ye()}))},this.document.addEventListener("visibilitychange",this.qe),this.inForeground="visible"===this.document.visibilityState)},$c.prototype._n=function(){this.qe&&(this.document.removeEventListener("visibilitychange",this.qe),this.qe=null)},$c.prototype.Ze=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Be=function(){e.wn(),e.Fe.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("unload",this.Be))},$c.prototype.mn=function(){this.Be&&(this.window.removeEventListener("unload",this.Be),this.Be=null)},$c.prototype.dn=function(t){try{var e=null!==(null===(e=this.Je)||void 0===e?void 0:e.getItem(this.fn(t)));return kr("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Or("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},$c.prototype.wn=function(){if(this.Je)try{this.Je.setItem(this.fn(this.clientId),String(Date.now()))}catch(r){Or("Failed to set zombie client id.",r)}},$c.prototype.yn=function(){if(this.Je)try{this.Je.removeItem(this.fn(this.clientId))}catch(r){}},$c.prototype.fn=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},$c);function $c(t,e,n,r,i,o,s,a,u,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Fe=i,this.window=o,this.document=s,this.Oe=u,this.ke=c,this.Me=null,this.Le=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Be=null,this.inForeground=!1,this.qe=null,this.Ue=null,this.Qe=Number.NEGATIVE_INFINITY,this.Ke=function(t){return Promise.resolve()},!$c.At())throw new Jr(Xr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new kc(this,r),this.We=e+"main",this.D=new Mu(a),this.je=new du(this.We,11,new Qc(this.D)),this.Ge=new bc(this.referenceDelegate,this.D),this.Gt=new nc,this.ze=(e=this.D,a=this.Gt,new Vc(e,a)),this.He=new Xu,this.window&&this.window.localStorage?this.Je=this.window.localStorage:(this.Je=null,!1===c&&Or("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function Zc(t){return xu(t,za.store)}function th(t){return xu(t,ou.store)}function eh(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}function nh(t,e){this.progress=t,this.En=e}var rh=(hh.prototype.In=function(t,e){var n=this;return this.Tn.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.An(t,e,r)}))},hh.prototype.An=function(t,e,n){return this.ze.getEntry(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].applyToLocalView(e,t);return t}))},hh.prototype.Rn=function(t,e,n){var r=Qs;return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].applyToLocalView(t,e);r=r.insert(t,e)})),r},hh.prototype.bn=function(t,e){var n=this;return this.ze.getEntries(t,e).next((function(e){return n.vn(t,e)}))},hh.prototype.vn=function(t,e){var n=this;return this.Tn.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(r){r=n.Rn(t,e,r);var i=Qs;return r.forEach((function(t,e){e=e||new Ri(t,Mo.min()),i=i.insert(t,e)})),i}))},hh.prototype.getDocumentsMatchingQuery=function(t,e,n){return r=e,ei.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Pn(t,e.path):Ao(e)?this.Vn(t,e,n):this.Sn(t,e,n);var r},hh.prototype.Pn=function(t,e){return this.In(t,new ei(e)).next((function(t){var e=Xs;return t instanceof xi?e.insert(t.key,t):e}))},hh.prototype.Vn=function(t,e,n){var r=this,i=e.collectionGroup,o=Xs;return this.Gt.getCollectionParents(t,i).next((function(s){return fu.forEach(s,(function(s){var a=(a=e,s=s.child(i),new wo(s,null,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt));return r.Sn(t,a,n).next((function(t){t.forEach((function(t,e){o=o.insert(t,e)}))}))})).next((function(){return o}))}))},hh.prototype.Sn=function(t,e,n){var r,i,o=this;return this.ze.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,o.Tn.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return i=e,o.Dn(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=(c=a[s]).key,c=ys(c,r.get(u),o.localWriteTime);r=c instanceof xi?r.insert(u,c):r.remove(u)}}))})).next((function(){return r.forEach((function(t,n){Lo(e,n)||(r=r.remove(t))})),r}))},hh.prototype.Dn=function(t,e,n){for(var r=Zs(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof Es&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.ze.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof xi&&(c=c.insert(t,e))})),c}))},hh),ih=(ch.Nn=function(t,e){for(var n=Zs(),r=Zs(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new ch(t,e.fromCache,n,r)},ch),oh=(uh.prototype.$n=function(t){this.Fn=t},uh.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var o=this;return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())||n.isEqual(Mo.min())?this.On(t,e):this.Fn.bn(t,r).next((function(s){var a=o.kn(e,s);return(Io(e)||To(e))&&o.Mn(e.limitType,a,r,n)?o.On(t,e):(Cr()<=i.DEBUG&&kr("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Ro(e)),o.Fn.getDocumentsMatchingQuery(t,e,n).next((function(t){return a.forEach((function(e){t=t.insert(e.key,e)})),t})))}))},uh.prototype.kn=function(t,e){var n=new zs(Po(t));return e.forEach((function(e,r){r instanceof xi&&Lo(t,r)&&(n=n.add(r))})),n},uh.prototype.Mn=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.compareTo(r))},uh.prototype.On=function(t,e){return Cr()<=i.DEBUG&&kr("QueryEngine","Using full collection scan to execute query:",Ro(e)),this.Fn.getDocumentsMatchingQuery(t,e,Mo.min())},uh),sh=(ah.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.collect(n,e.Bn)}))},ah);function ah(t,e,n,r){this.persistence=t,this.Ln=e,this.D=r,this.Bn=new Vs(Vr),this.qn=new Fc(Ui,ji),this.Un=Mo.min(),this.Tn=t.getMutationQueue(n),this.Qn=t.getRemoteDocumentCache(),this.Ge=t.getTargetCache(),this.Kn=new rh(this.Qn,this.Tn,this.persistence.getIndexManager()),this.He=t.getBundleCache(),this.Ln.$n(this.Kn)}function uh(){}function ch(t,e,n,r){this.targetId=t,this.fromCache=e,this.Cn=n,this.xn=r}function hh(t,e,n){this.ze=t,this.Tn=e,this.Gt=n}function lh(t,e,n,r){return new sh(t,e,n,r)}function fh(t,e){return u(this,void 0,void 0,(function(){var n,r,i,o;return c(this,(function(s){switch(s.label){case 0:return r=(n=t).Tn,i=n.Kn,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n.Tn.getAllMutationBatches(t).next((function(s){return o=s,r=n.persistence.getMutationQueue(e),i=new rh(n.Qn,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)})).next((function(e){for(var n=[],r=[],s=Zs(),a=0,u=o;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++){var f=l[h];s=s.add(f.key)}}for(var p=0,d=e;p<d.length;p++){var y=d[p];r.push(y.batchId);for(var g=0,v=y.mutations;g<v.length;g++){var m=v[g];s=s.add(m.key)}}return i.bn(t,s).next((function(t){return{Wn:t,removedBatchIds:n,addedBatchIds:r}}))}))}))];case 1:return o=s.sent(),[2,(n.Tn=r,n.Kn=i,n.Ln.$n(n.Kn),o)]}}))}))}function ph(t,e){var n=t;return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r,i,o,s,a,u,c,h=e.batch.keys(),l=n.Qn.newChangeBuffer({trackRemovals:!0});return r=n,i=t,s=l,u=(a=(o=e).batch).keys(),c=fu.resolve(),u.forEach((function(t){c=c.next((function(){return s.getEntry(i,t)})).next((function(e){var n=e;Pr(null!==(e=o.docVersions.get(t))),(!n||n.version.compareTo(e)<0)&&(n=a.applyToRemoteDocument(t,n,o))&&s.addEntry(n,o.commitVersion)}))})),c.next((function(){return r.Tn.removeMutationBatch(i,a)})).next((function(){return l.apply(t)})).next((function(){return n.Tn.performConsistencyCheck(t)})).next((function(){return n.Kn.bn(t,h)}))}))}function dh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.Ge.getLastRemoteSnapshotVersion(t)}))}function yh(t,e){var n=t,r=e.snapshotVersion,i=n.Bn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.Qn.newChangeBuffer({trackRemovals:!0});i=n.Bn;var s=[];e.targetChanges.forEach((function(e,o){var a,u,c,h=i.get(o);h&&(s.push(n.Ge.removeMatchingKeys(t,e.removedDocuments,o).next((function(){return n.Ge.addMatchingKeys(t,e.addedDocuments,o)}))),0<(c=e.resumeToken).approximateByteSize()&&(a=h.withResumeToken(c,r).withSequenceNumber(t.currentSequenceNumber),i=i.insert(o,a),u=h,c=e,Pr(0<(h=a).resumeToken.approximateByteSize()),(0===u.resumeToken.approximateByteSize()||3e8<=h.snapshotVersion.toMicroseconds()-u.snapshotVersion.toMicroseconds()||0<c.addedDocuments.size+c.modifiedDocuments.size+c.removedDocuments.size)&&s.push(n.Ge.updateTargetData(t,a))))}));var a,u=Qs;return e.documentUpdates.forEach((function(r,i){e.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))})),s.push(gh(t,o,e.documentUpdates,r,void 0).next((function(t){u=t}))),r.isEqual(Mo.min())||(a=n.Ge.getLastRemoteSnapshotVersion(t).next((function(e){return n.Ge.setTargetsMetadata(t,t.currentSequenceNumber,r)})),s.push(a)),fu.waitFor(s).next((function(){return o.apply(t)})).next((function(){return n.Kn.vn(t,u)}))})).then((function(t){return n.Bn=i,t}))}function gh(t,e,n,r,i){var o=Zs();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=Qs;return n.forEach((function(n,s){var a=t.get(n),u=(null==i?void 0:i.get(n))||r;s instanceof Ri&&s.version.isEqual(Mo.min())?(e.removeEntry(n,u),o=o.insert(n,s)):null==a||0<s.version.compareTo(a.version)||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(s,u),o=o.insert(n,s)):kr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)})),o}))}function vh(t,e){var n=t;return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.Ge.getTargetData(t,e).next((function(i){return i?(r=i,fu.resolve(r)):n.Ge.allocateTargetId(t).next((function(i){return r=new Pu(e,i,0,t.currentSequenceNumber),n.Ge.addTargetData(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.Bn.get(t.targetId);return(null===r||0<t.snapshotVersion.compareTo(r.snapshotVersion))&&(n.Bn=n.Bn.insert(t.targetId,t),n.qn.set(e,t.targetId)),t}))}function mh(t,e,n){return u(this,void 0,void 0,(function(){var r,i,o;return c(this,(function(s){switch(s.label){case 0:i=(r=t).Bn.get(e),o=n?"readwrite":"readwrite-primary",s.label=1;case 1:return s.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.referenceDelegate.removeTarget(t,i)}))];case 2:s.sent(),s.label=3;case 3:return[3,5];case 4:if(!Iu(o=s.sent()))throw o;return kr("LocalStore","Failed to update sequence numbers for target "+e+": "+o),[3,5];case 5:return r.Bn=r.Bn.remove(e),r.qn.delete(i.target),[2]}}))}))}function bh(t,e,n){var r=t,i=Mo.min(),o=Zs();return r.persistence.runTransaction("Execute query","readonly",(function(t){return s=r,a=t,u=Co(e),(void 0!==(s=(c=s).qn.get(u))?fu.resolve(c.Bn.get(s)):c.Ge.getTargetData(a,u)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.Ge.getMatchingKeysForTargetId(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.Ln.getDocumentsMatchingQuery(t,e,n?i:Mo.min(),n?o:Zs())})).next((function(t){return{documents:t,jn:o}}));var s,a,u,c}))}function wh(t,e){var n=t,r=n.Ge;return(t=n.Bn.get(e))?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.yt(t,e).next((function(t){return t?t.target:null}))}))}function Eh(t){var e=t;return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return n=e.Qn,r=t,t=e.Un,i=n,o=Qs,s=Bu(t),t=zc(r),r=IDBKeyRange.lowerBound(s,!0),t.qt({index:Za.readTimeIndex,range:r},(function(t,e){var n=Uu(i.D,e);o=o.insert(n.key,n),s=e.readTime})).next((function(){return{En:o,readTime:Gu(s)}}));var n,r,i,o,s})).then((function(t){var n=t.En;return t=t.readTime,e.Un=t,n}))}function _h(t){return u(this,void 0,void 0,(function(){var e;return c(this,(function(n){return[2,(e=t).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return t=zc(t),e=Mo.min(),t.qt({index:Za.readTimeIndex,reverse:!0},(function(t,n,r){n.readTime&&(e=Gu(n.readTime)),r.done()})).next((function(){return e}));var e})).then((function(t){e.Un=t}))]}))}))}var Ih,Th,Sh=(Hh.prototype.getBundleMetadata=function(t,e){return fu.resolve(this.Jn.get(e))},Hh.prototype.saveBundleMetadata=function(t,e){return this.Jn.set(e.id,{id:e.id,version:e.version,createTime:ba(e.createTime)}),fu.resolve()},Hh.prototype.getNamedQuery=function(t,e){return fu.resolve(this.Yn.get(e))},Hh.prototype.saveNamedQuery=function(t,e){return this.Yn.set(e.name,{name:(e=e).name,query:Yu(e.bundledQuery),readTime:ba(e.readTime)}),fu.resolve()},Hh),Dh=(zh.prototype.isEmpty=function(){return this.Xn.isEmpty()},zh.prototype.addReference=function(t,e){e=new Ah(t,e),this.Xn=this.Xn.add(e),this.ts=this.ts.add(e)},zh.prototype.ns=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},zh.prototype.removeReference=function(t,e){this.ss(new Ah(t,e))},zh.prototype.rs=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},zh.prototype.os=function(t){var e=this,n=new ei(new $r([])),r=new Ah(n,t),i=(t=new Ah(n,t+1),[]);return this.ts.forEachInRange([r,t],(function(t){e.ss(t),i.push(t.key)})),i},zh.prototype.cs=function(){var t=this;this.Xn.forEach((function(e){return t.ss(e)}))},zh.prototype.ss=function(t){this.Xn=this.Xn.delete(t),this.ts=this.ts.delete(t)},zh.prototype.us=function(t){var e=new ei(new $r([])),n=new Ah(e,t),r=(t=new Ah(e,t+1),Zs());return this.ts.forEachInRange([n,t],(function(t){r=r.add(t.key)})),r},zh.prototype.containsKey=function(t){var e=new Ah(t,0);return null!==(e=this.Xn.firstAfterOrEqual(e))&&t.isEqual(e.key)},zh),Ah=(Kh.Zn=function(t,e){return ei.comparator(t.key,e.key)||Vr(t.hs,e.hs)},Kh.es=function(t,e){return Vr(t.hs,e.hs)||ei.comparator(t.key,e.key)},Kh),Nh=(Gh.prototype.checkEmpty=function(t){return fu.resolve(0===this.Tn.length)},Gh.prototype.addMutationBatch=function(t,e,n,r){var i=this.ls;this.ls++,0<this.Tn.length&&this.Tn[this.Tn.length-1],n=new Ru(i,e,n,r),this.Tn.push(n);for(var o=0,s=r;o<s.length;o++){var a=s[o];this.fs=this.fs.add(new Ah(a.key,i)),this.Gt.addToCollectionParentIndex(t,a.key.path.popLast())}return fu.resolve(n)},Gh.prototype.lookupMutationBatch=function(t,e){return fu.resolve(this.ds(e))},Gh.prototype.getNextMutationBatchAfterBatchId=function(t,e){return e+=1,e=(e=this.ws(e))<0?0:e,fu.resolve(this.Tn.length>e?this.Tn[e]:null)},Gh.prototype.getHighestUnacknowledgedBatchId=function(){return fu.resolve(0===this.Tn.length?-1:this.ls-1)},Gh.prototype.getAllMutationBatches=function(t){return fu.resolve(this.Tn.slice())},Gh.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new Ah(e,0),i=(e=new Ah(e,Number.POSITIVE_INFINITY),[]);return this.fs.forEachInRange([r,e],(function(t){t=n.ds(t.hs),i.push(t)})),fu.resolve(i)},Gh.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new zs(Vr);return e.forEach((function(t){var e=new Ah(t,0);t=new Ah(t,Number.POSITIVE_INFINITY),n.fs.forEachInRange([e,t],(function(t){r=r.add(t.hs)}))})),fu.resolve(this._s(r))},Gh.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1;e=n,ei.isDocumentKey(e)||(e=e.child("")),e=new Ah(new ei(e),0);var i=new zs(Vr);return this.fs.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(i=i.add(t.hs)),!0)}),e),fu.resolve(this._s(i))},Gh.prototype._s=function(t){var e=this,n=[];return t.forEach((function(t){null!==(t=e.ds(t))&&n.push(t)})),n},Gh.prototype.removeMutationBatch=function(t,e){var n=this;Pr(0===this.ys(e.batchId,"removed")),this.Tn.shift();var r=this.fs;return fu.forEach(e.mutations,(function(i){var o=new Ah(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((function(){n.fs=r}))},Gh.prototype.Xt=function(t){},Gh.prototype.containsKey=function(t,e){var n=new Ah(e,0);return n=this.fs.firstAfterOrEqual(n),fu.resolve(e.isEqual(n&&n.key))},Gh.prototype.performConsistencyCheck=function(t){return this.Tn.length,fu.resolve()},Gh.prototype.ys=function(t,e){return this.ws(t)},Gh.prototype.ws=function(t){return 0===this.Tn.length?0:t-this.Tn[0].batchId},Gh.prototype.ds=function(t){return(t=this.ws(t))<0||t>=this.Tn.length?null:this.Tn[t]},Gh),Ch=(Bh.prototype.addEntry=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.gs(e);return this.docs=this.docs.insert(r,{maybeDocument:e,size:o,readTime:n}),this.size+=o-i,this.Gt.addToCollectionParentIndex(t,r.path.popLast())},Bh.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Bh.prototype.getEntry=function(t,e){return e=this.docs.get(e),fu.resolve(e?e.maybeDocument:null)},Bh.prototype.getEntries=function(t,e){var n=this,r=Qs;return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.maybeDocument:null)})),fu.resolve(r)},Bh.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=Xs,i=new ei(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=(a=o.getNext()).key,a=(u=a.value).maybeDocument,u=u.readTime;if(!e.path.isPrefixOf(s.path))break;u.compareTo(n)<=0||a instanceof xi&&Lo(e,a)&&(r=r.insert(a.key,a))}return fu.resolve(r)},Bh.prototype.ps=function(t,e){return fu.forEach(this.docs,(function(t){return e(t)}))},Bh.prototype.newChangeBuffer=function(t){return new kh(this)},Bh.prototype.getSize=function(t){return fu.resolve(this.size)},Bh),kh=(a(jh,Th=Se),jh.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i&&i.maybeDocument?n.push(e.Ve.addEntry(t,i.maybeDocument,e.getReadTime(r))):e.Ve.removeEntry(r)})),fu.waitFor(n)},jh.prototype.getFromCache=function(t,e){return this.Ve.getEntry(t,e)},jh.prototype.getAllFromCache=function(t,e){return this.Ve.getEntries(t,e)},jh),Oh=(Uh.prototype.forEachTarget=function(t,e){return this.Es.forEach((function(t,n){return e(n)})),fu.resolve()},Uh.prototype.getLastRemoteSnapshotVersion=function(t){return fu.resolve(this.lastRemoteSnapshotVersion)},Uh.prototype.getHighestSequenceNumber=function(t){return fu.resolve(this.Ts)},Uh.prototype.allocateTargetId=function(t){return this.highestTargetId=this.As.next(),fu.resolve(this.highestTargetId)},Uh.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Ts&&(this.Ts=e),fu.resolve()},Uh.prototype.re=function(t){this.Es.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.As=new mc(e),this.highestTargetId=e),t.sequenceNumber>this.Ts&&(this.Ts=t.sequenceNumber)},Uh.prototype.addTargetData=function(t,e){return this.re(e),this.targetCount+=1,fu.resolve()},Uh.prototype.updateTargetData=function(t,e){return this.re(e),fu.resolve()},Uh.prototype.removeTargetData=function(t,e){return this.Es.delete(e.target),this.Is.os(e.targetId),--this.targetCount,fu.resolve()},Uh.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.Es.forEach((function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.Es.delete(s),o.push(r.removeMatchingKeysForTargetId(t,a.targetId)),i++)})),fu.waitFor(o).next((function(){return i}))},Uh.prototype.getTargetCount=function(t){return fu.resolve(this.targetCount)},Uh.prototype.getTargetData=function(t,e){return e=this.Es.get(e)||null,fu.resolve(e)},Uh.prototype.addMatchingKeys=function(t,e,n){return this.Is.ns(e,n),fu.resolve()},Uh.prototype.removeMatchingKeys=function(t,e,n){this.Is.rs(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.markPotentiallyOrphaned(t,e))})),fu.waitFor(i)},Uh.prototype.removeMatchingKeysForTargetId=function(t,e){return this.Is.os(e),fu.resolve()},Uh.prototype.getMatchingKeysForTargetId=function(t,e){return e=this.Is.us(e),fu.resolve(e)},Uh.prototype.containsKey=function(t,e){return fu.resolve(this.Is.containsKey(e))},Uh),xh=(qh.prototype.start=function(){return Promise.resolve()},qh.prototype.shutdown=function(){return this.Le=!1,Promise.resolve()},Object.defineProperty(qh.prototype,"started",{get:function(){return this.Le},enumerable:!1,configurable:!0}),qh.prototype.setDatabaseDeletedListener=function(){},qh.prototype.setNetworkEnabled=function(){},qh.prototype.getIndexManager=function(){return this.Gt},qh.prototype.getMutationQueue=function(t){var e=this.Rs[t.toKey()];return e||(e=new Nh(this.Gt,this.referenceDelegate),this.Rs[t.toKey()]=e),e},qh.prototype.getTargetCache=function(){return this.Ge},qh.prototype.getRemoteDocumentCache=function(){return this.ze},qh.prototype.getBundleCache=function(){return this.He},qh.prototype.runTransaction=function(t,e,n){var r=this;kr("MemoryPersistence","Starting transaction:",t);var i=new Rh(this.Me.next());return this.referenceDelegate.vs(),n(i).next((function(t){return r.referenceDelegate.Ps(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))},qh.prototype.Vs=function(t,e){return fu.or(Object.values(this.Rs).map((function(n){return function(){return n.containsKey(t,e)}})))},qh),Rh=(a(Vh,Ih=y),Vh),Lh=(Fh.Cs=function(t){return new Fh(t)},Object.defineProperty(Fh.prototype,"xs",{get:function(){if(this.Ds)return this.Ds;throw Lr()},enumerable:!1,configurable:!0}),Fh.prototype.addReference=function(t,e,n){return this.Ss.addReference(n,e),this.xs.delete(n.toString()),fu.resolve()},Fh.prototype.removeReference=function(t,e,n){return this.Ss.removeReference(n,e),this.xs.add(n.toString()),fu.resolve()},Fh.prototype.markPotentiallyOrphaned=function(t,e){return this.xs.add(e.toString()),fu.resolve()},Fh.prototype.removeTarget=function(t,e){var n=this;this.Ss.os(e.targetId).forEach((function(t){return n.xs.add(t.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.xs.add(t.toString())}))})).next((function(){return r.removeTargetData(t,e)}))},Fh.prototype.vs=function(){this.Ds=new Set},Fh.prototype.Ps=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return fu.forEach(this.xs,(function(r){var i=ei.fromPath(r);return e.Ns(t,i).next((function(t){t||n.removeEntry(i)}))})).next((function(){return e.Ds=null,n.apply(t)}))},Fh.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ns(t,e).next((function(t){t?n.xs.delete(e.toString()):n.xs.add(e.toString())}))},Fh.prototype.bs=function(t){return 0},Fh.prototype.Ns=function(t,e){var n=this;return fu.or([function(){return fu.resolve(n.Ss.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Vs(t,e)}])},Fh),Ph=(Mh.prototype.isAuthenticated=function(){return null!=this.uid},Mh.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},Mh.prototype.isEqual=function(t){return t.uid===this.uid},Mh);function Mh(t){this.uid=t}function Fh(t){this.persistence=t,this.Ss=new Dh,this.Ds=null}function Vh(t){var e=this;return(e=Ih.call(this)||this).currentSequenceNumber=t,e}function qh(t,e){var n=this;this.Rs={},this.Me=new Dr(0),this.Le=!1,this.Le=!0,this.referenceDelegate=t(this),this.Ge=new Oh(this),this.Gt=new tc,this.ze=(t=this.Gt,new Ch(t,(function(t){return n.referenceDelegate.bs(t)}))),this.D=new Mu(e),this.He=new Sh(this.D)}function Uh(t){this.persistence=t,this.Es=new Fc(Ui,ji),this.lastRemoteSnapshotVersion=Mo.min(),this.highestTargetId=0,this.Ts=0,this.Is=new Dh,this.targetCount=0,this.As=mc.ee()}function jh(t){var e=this;return(e=Th.call(this)||this).Ve=t,e}function Bh(t,e){this.Gt=t,this.gs=e,this.docs=new Vs(ei.comparator),this.size=0}function Gh(t,e){this.Gt=t,this.referenceDelegate=e,this.Tn=[],this.ls=1,this.fs=new zs(Ah.Zn)}function Kh(t,e){this.key=t,this.hs=e}function zh(){this.Xn=new zs(Ah.Zn),this.ts=new zs(Ah.es)}function Hh(t){this.D=t,this.Jn=new Map,this.Yn=new Map}function Qh(t,e){return"firestore_clients_"+t+"_"+e}function Wh(t,e,n){return n="firestore_mutations_"+t+"_"+n,e.isAuthenticated()&&(n+="_"+e.uid),n}function Yh(t,e){return"firestore_targets_"+t+"_"+e}Ph.UNAUTHENTICATED=new Ph(null),Ph.GOOGLE_CREDENTIALS=new Ph("google-credentials-uid"),Ph.FIRST_PARTY=new Ph("first-party-uid");var Xh,Jh=(wl.$s=function(t,e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new Jr(i.error.code,i.error.message)),o?new wl(t,e,i.state,r):(Or("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},wl.prototype.Fs=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},wl),$h=(bl.$s=function(t,e){var n,r=JSON.parse(e),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(n=new Jr(r.error.code,r.error.message)),i?new bl(t,r.state,n):(Or("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},bl.prototype.Fs=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},bl),Zh=(ml.$s=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=ta,o=0;r&&o<n.activeTargetIds.length;++o)r=Hr(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new ml(t,i):(Or("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},ml),tl=(vl.$s=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new vl(e.clientId,e.onlineState):(Or("SharedClientState","Failed to parse online state: "+t),null)},vl),el=(gl.prototype.Os=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},gl.prototype.ks=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},gl.prototype.Fs=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},gl),nl=(yl.At=function(t){return!(!t||!t.localStorage)},yl.prototype.start=function(){return u(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,a,u,h,l=this;return c(this,(function(c){switch(c.label){case 0:return[4,this.syncEngine.gn()];case 1:for(o=c.sent(),t=0,e=o;t<e.length;t++)(n=e[t])!==this.Ms&&(r=this.getItem(Qh(this.persistenceKey,n)))&&(i=Zh.$s(n,r))&&(this.qs=this.qs.insert(i.clientId,i));for(this.Js(),(o=this.storage.getItem(this.zs))&&(s=this.Ys(o))&&this.Xs(s),a=0,u=this.Us;a<u.length;a++)h=u[a],this.Bs(h);return this.Us=[],this.window.addEventListener("unload",(function(){return l.shutdown()})),this.started=!0,[2]}}))}))},yl.prototype.writeSequenceNumber=function(t){this.setItem(this.Ks,JSON.stringify(t))},yl.prototype.getAllActiveQueryTargets=function(){return this.Zs(this.qs)},yl.prototype.isActiveQueryTarget=function(t){var e=!1;return this.qs.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},yl.prototype.addPendingMutation=function(t){this.ti(t,"pending")},yl.prototype.updateMutationState=function(t,e,n){this.ti(t,e,n),this.ei(t)},yl.prototype.addLocalQueryTarget=function(t){var e,n="not-current";return this.isActiveQueryTarget(t)&&(!(e=this.storage.getItem(Yh(this.persistenceKey,t)))||(e=$h.$s(t,e))&&(n=e.state)),this.ni.Os(t),this.Js(),n},yl.prototype.removeLocalQueryTarget=function(t){this.ni.ks(t),this.Js()},yl.prototype.isLocalQueryTarget=function(t){return this.ni.activeTargetIds.has(t)},yl.prototype.clearQueryState=function(t){this.removeItem(Yh(this.persistenceKey,t))},yl.prototype.updateQueryState=function(t,e,n){this.si(t,e,n)},yl.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach((function(t){r.ei(t)})),this.currentUser=t,n.forEach((function(t){r.addPendingMutation(t)}))},yl.prototype.setOnlineState=function(t){this.ii(t)},yl.prototype.notifyBundleLoaded=function(){this.ri()},yl.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.Ls),this.removeItem(this.Qs),this.started=!1)},yl.prototype.getItem=function(t){var e=this.storage.getItem(t);return kr("SharedClientState","READ",t,e),e},yl.prototype.setItem=function(t,e){kr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},yl.prototype.removeItem=function(t){kr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},yl.prototype.Bs=function(t){var e=this,n=t;n.storageArea===this.storage&&(kr("SharedClientState","EVENT",n.key,n.newValue),n.key!==this.Qs?this.Fe.enqueueRetryable((function(){return u(e,void 0,void 0,(function(){var t,e,r,i;return c(this,(function(o){if(this.started){if(null!==n.key)if(this.Ws.test(n.key)){if(null==n.newValue)return t=this.oi(n.key),[2,this.ci(t,null)];if(t=this.ai(n.key,n.newValue))return[2,this.ci(t.clientId,t)]}else if(this.js.test(n.key)){if(null!==n.newValue&&(e=this.ui(n.key,n.newValue)))return[2,this.hi(e)]}else if(this.Gs.test(n.key)){if(null!==n.newValue&&(r=this.li(n.key,n.newValue)))return[2,this.fi(r)]}else if(n.key===this.zs){if(null!==n.newValue&&(i=this.Ys(n.newValue)))return[2,this.Xs(i)]}else if(n.key===this.Ks)(i=function(t){var e=Dr.o;if(null!=t)try{var n=JSON.parse(t);Pr("number"==typeof n),e=n}catch(t){Or("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Dr.o&&this.sequenceNumberHandler(i);else if(n.key===this.Hs)return[2,this.syncEngine.di()]}else this.Us.push(n);return[2]}))}))})):Or("Received WebStorage notification for local change. Another client might have garbage-collected our state"))},Object.defineProperty(yl.prototype,"ni",{get:function(){return this.qs.get(this.Ms)},enumerable:!1,configurable:!0}),yl.prototype.Js=function(){this.setItem(this.Qs,this.ni.Fs())},yl.prototype.ti=function(t,e,n){n=new Jh(this.currentUser,t,e,n),t=Wh(this.persistenceKey,this.currentUser,t),this.setItem(t,n.Fs())},yl.prototype.ei=function(t){t=Wh(this.persistenceKey,this.currentUser,t),this.removeItem(t)},yl.prototype.ii=function(t){t={clientId:this.Ms,onlineState:t},this.storage.setItem(this.zs,JSON.stringify(t))},yl.prototype.si=function(t,e,n){var r=Yh(this.persistenceKey,t);n=new $h(t,e,n),this.setItem(r,n.Fs())},yl.prototype.ri=function(){this.setItem(this.Hs,"value-not-used")},yl.prototype.oi=function(t){return(t=this.Ws.exec(t))?t[1]:null},yl.prototype.ai=function(t,e){return t=this.oi(t),Zh.$s(t,e)},yl.prototype.ui=function(t,e){var n=this.js.exec(t);return t=Number(n[1]),n=void 0!==n[2]?n[2]:null,Jh.$s(new Ph(n),t,e)},yl.prototype.li=function(t,e){return t=this.Gs.exec(t),t=Number(t[1]),$h.$s(t,e)},yl.prototype.Ys=function(t){return tl.$s(t)},yl.prototype.hi=function(t){return u(this,void 0,void 0,(function(){return c(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.wi(t.batchId,t.state,t.error)]:(kr("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},yl.prototype.fi=function(t){return this.syncEngine._i(t.targetId,t.state,t.error)},yl.prototype.ci=function(t,e){var n=this,r=e?this.qs.insert(t,e):this.qs.remove(t),i=this.Zs(this.qs),o=this.Zs(r),s=[],a=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||a.push(t)})),this.syncEngine.mi(s,a).then((function(){n.qs=r}))},yl.prototype.Xs=function(t){this.qs.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},yl.prototype.Zs=function(t){var e=ta;return t.forEach((function(t,n){e=e.unionWith(n.activeTargetIds)})),e},yl),rl=(dl.prototype.addPendingMutation=function(t){},dl.prototype.updateMutationState=function(t,e,n){},dl.prototype.addLocalQueryTarget=function(t){return this.yi.Os(t),this.gi[t]||"not-current"},dl.prototype.updateQueryState=function(t,e,n){this.gi[t]=e},dl.prototype.removeLocalQueryTarget=function(t){this.yi.ks(t)},dl.prototype.isLocalQueryTarget=function(t){return this.yi.activeTargetIds.has(t)},dl.prototype.clearQueryState=function(t){delete this.gi[t]},dl.prototype.getAllActiveQueryTargets=function(){return this.yi.activeTargetIds},dl.prototype.isActiveQueryTarget=function(t){return this.yi.activeTargetIds.has(t)},dl.prototype.start=function(){return this.yi=new el,Promise.resolve()},dl.prototype.handleUserChange=function(t,e,n){},dl.prototype.setOnlineState=function(t){},dl.prototype.shutdown=function(){},dl.prototype.writeSequenceNumber=function(t){},dl.prototype.notifyBundleLoaded=function(){},dl),il=(pl.prototype.pi=function(t){},pl.prototype.shutdown=function(){},pl),ol=(fl.prototype.pi=function(t){this.Ri.push(t)},fl.prototype.shutdown=function(){window.removeEventListener("online",this.Ei),window.removeEventListener("offline",this.Ii)},fl.prototype.bi=function(){window.addEventListener("online",this.Ei),window.addEventListener("offline",this.Ii)},fl.prototype.Ti=function(){kr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Ri;t<e.length;t++)(0,e[t])(0)},fl.prototype.Ai=function(){kr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Ri;t<e.length;t++)(0,e[t])(1)},fl.At=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},fl),sl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},al=(ll.prototype.Vi=function(t){this.Si=t},ll.prototype.Di=function(t){this.Ci=t},ll.prototype.onMessage=function(t){this.xi=t},ll.prototype.close=function(){this.Pi()},ll.prototype.send=function(t){this.vi(t)},ll.prototype.Ni=function(){this.Si()},ll.prototype.$i=function(t){this.Ci(t)},ll.prototype.Fi=function(t){this.xi(t)},ll),ul=(hl.prototype.Mi=function(t,e,n,r){var i=this.Li(t,e);return kr("RestConnection","Sending: ",i,n),e={},this.Bi(e,r),this.qi(t,i,e,n).then((function(t){return kr("RestConnection","Received: ",t),t}),(function(e){throw xr("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},hl.prototype.Ui=function(t,e,n,r){return this.Mi(t,e,n,r)},hl.prototype.Bi=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.3.1",t["Content-Type"]="text/plain",e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},hl.prototype.Li=function(t,e){return t=sl[t],this.Oi+"/v1/"+e+":"+t},a(cl,Xh=hl),cl.prototype.qi=function(t,e,n,r){return new Promise((function(i,o){var s=new Sr;s.listenOnce(wr.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case br.NO_ERROR:var e=s.getResponseJson();kr("Connection","XHR received:",JSON.stringify(e)),i(e);break;case br.TIMEOUT:kr("Connection",'RPC "'+t+'" timed out'),o(new Jr(Xr.DEADLINE_EXCEEDED,"Request time out"));break;case br.HTTP_ERROR:var n=s.getStatus();kr("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),0<n?(e=s.getResponseJson().error)&&e.status&&e.message?(n=e.status.toLowerCase().replace(/_/g,"-"),n=0<=Object.values(Xr).indexOf(n)?n:Xr.UNKNOWN,o(new Jr(n,e.message))):o(new Jr(Xr.UNKNOWN,"Server responded with status "+s.getStatus())):o(new Jr(Xr.UNAVAILABLE,"Connection failed."));break;default:Lr()}}finally{kr("Connection",'RPC "'+t+'" completed.')}}));var a=JSON.stringify(r);s.send(e,"POST",a,n,15)}))},cl.prototype.Qi=function(t,e){var n,r=[this.Oi,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new pr,o=mr();t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},this.Bi(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(v())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=v().indexOf("Electron/")||0<=(n=v()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=v().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),kr("Connection","Creating WebChannel: "+(r=r.join("")),t);var s=i.createWebChannel(r,t),a=!1,u=!1,c=new al({vi:function(t){u?kr("Connection","Not sending because WebChannel is closed:",t):(a||(kr("Connection","Opening WebChannel transport."),s.open(),a=!0),kr("Connection","WebChannel sending:",t),s.send(t))},Pi:function(){return s.close()}});return(t=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))})(s,Tr.EventType.OPEN,(function(){u||kr("Connection","WebChannel transport opened.")})),t(s,Tr.EventType.CLOSE,(function(){u||(u=!0,kr("Connection","WebChannel transport closed"),c.$i())})),t(s,Tr.EventType.ERROR,(function(t){u||(u=!0,xr("Connection","WebChannel transport errored:",t),c.$i(new Jr(Xr.UNAVAILABLE,"The operation could not be completed")))})),t(s,Tr.EventType.MESSAGE,(function(t){var e,n,r,i;u||(Pr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(kr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Cs[r];if(void 0!==t)return Fs(t)}(),i=n.message,void 0===t&&(t=Xr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,c.$i(new Jr(t,i)),s.close()):(kr("Connection","WebChannel received:",e),c.Fi(e)))})),t(o,Er.STAT_EVENT,(function(t){t.stat===_r?kr("Connection","Detected buffering proxy"):t.stat===Ir&&kr("Connection","Detected no buffering proxy")})),setTimeout((function(){c.Ni()}),0),c},cl);function cl(t){var e=this;return(e=Xh.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.autoDetectLongPolling=t.autoDetectLongPolling,e}function hl(t){this.databaseInfo=t,this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.Oi=e+"://"+t.host,this.ki="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}function ll(t){this.vi=t.vi,this.Pi=t.Pi}function fl(){var t=this;this.Ei=function(){return t.Ti()},this.Ii=function(){return t.Ai()},this.Ri=[],this.bi()}function pl(){}function dl(){this.yi=new el,this.gi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}function yl(t,e,n,r,i){this.window=t,this.Fe=e,this.persistenceKey=n,this.Ms=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Ls=this.Bs.bind(this),this.qs=new Vs(Vr),this.started=!1,this.Us=[],n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),this.storage=this.window.localStorage,this.currentUser=i,this.Qs=Qh(this.persistenceKey,this.Ms),this.Ks="firestore_sequence_number_"+this.persistenceKey,this.qs=this.qs.insert(this.Ms,new el),this.Ws=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.js=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.Gs=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.zs="firestore_online_state_"+this.persistenceKey,this.Hs="firestore_bundle_loaded_"+this.persistenceKey,this.window.addEventListener("storage",this.Ls)}function gl(){this.activeTargetIds=ta}function vl(t,e){this.clientId=t,this.onlineState=e}function ml(t,e){this.clientId=t,this.activeTargetIds=e}function bl(t,e,n){this.targetId=t,this.state=e,this.error=n}function wl(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function El(){return"undefined"!=typeof window?window:null}function _l(){return"undefined"!=typeof document?document:null}function Il(t){return new ga(t,!0)}function Tl(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.qr=[],this.Ur=new Map,this.Qr=new Set,this.Kr=[],this.Wr=i,this.Wr.pi((function(t){n.enqueueAndForget((function(){return u(o,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return Ql(this)?(kr("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return u(this,void 0,void 0,(function(){var e;return c(this,(function(n){switch(n.label){case 0:return(e=t).Qr.add(4),[4,Ul(e)];case 1:return n.sent(),e.jr.set("Unknown"),e.Qr.delete(4),[4,ql(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.jr=new xl(n,r)}var Sl,Dl,Al,Nl=(Vl.prototype.reset=function(){this.Gi=0},Vl.prototype.Ji=function(){this.Gi=this.ji},Vl.prototype.Yi=function(t){var e=this;this.cancel();var n=Math.floor(this.Gi+this.Xi()),r=Math.max(0,Date.now()-this.Hi),i=Math.max(0,n-r);0<i&&kr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Gi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.zi=this.Fe.enqueueAfterDelay(this.timerId,i,(function(){return e.Hi=Date.now(),t()})),this.Gi*=this.Wi,this.Gi<this.Ki&&(this.Gi=this.Ki),this.Gi>this.ji&&(this.Gi=this.ji)},Vl.prototype.Zi=function(){null!==this.zi&&(this.zi.skipDelay(),this.zi=null)},Vl.prototype.cancel=function(){null!==this.zi&&(this.zi.cancel(),this.zi=null)},Vl.prototype.Xi=function(){return(Math.random()-.5)*this.Gi},Vl),Cl=(Fl.prototype.cr=function(){return 1===this.state||2===this.state||4===this.state},Fl.prototype.ar=function(){return 2===this.state},Fl.prototype.start=function(){3!==this.state?this.auth():this.ur()},Fl.prototype.stop=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return this.cr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},Fl.prototype.hr=function(){this.state=0,this.rr.reset()},Fl.prototype.lr=function(){var t=this;this.ar()&&null===this.ir&&(this.ir=this.Fe.enqueueAfterDelay(this.tr,6e4,(function(){return t.dr()})))},Fl.prototype.wr=function(t){this._r(),this.stream.send(t)},Fl.prototype.dr=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){return this.ar()?[2,this.close(0)]:[2]}))}))},Fl.prototype._r=function(){this.ir&&(this.ir.cancel(),this.ir=null)},Fl.prototype.close=function(t,e){return u(this,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return this._r(),this.rr.cancel(),this.sr++,3!==t?this.rr.reset():e&&e.code===Xr.RESOURCE_EXHAUSTED?(Or(e.toString()),Or("Using maximum backoff delay to prevent overloading the backend."),this.rr.Ji()):e&&e.code===Xr.UNAUTHENTICATED&&this.nr.invalidateToken(),null!==this.stream&&(this.mr(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Di(e)];case 1:return n.sent(),[2]}}))}))},Fl.prototype.mr=function(){},Fl.prototype.auth=function(){var t=this;this.state=1;var e=this.yr(this.sr),n=this.sr;this.nr.getToken().then((function(e){t.sr===n&&t.gr(e)}),(function(n){e((function(){var e=new Jr(Xr.UNKNOWN,"Fetching auth token failed: "+n.message);return t.pr(e)}))}))},Fl.prototype.gr=function(t){var e=this,n=this.yr(this.sr);this.stream=this.Er(t),this.stream.Vi((function(){n((function(){return e.state=2,e.listener.Vi()}))})),this.stream.Di((function(t){n((function(){return e.pr(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},Fl.prototype.ur=function(){var t=this;this.state=4,this.rr.Yi((function(){return u(t,void 0,void 0,(function(){return c(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},Fl.prototype.pr=function(t){return kr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Fl.prototype.yr=function(t){var e=this;return function(n){e.Fe.enqueueAndForget((function(){return e.sr===t?n():(kr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},a(Ml,Al=Se=Fl),Ml.prototype.Er=function(t){return this.er.Qi("Listen",t)},Ml.prototype.onMessage=function(t){this.rr.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Lr(),r=e.targetChange.targetIds||[],i=(s=e.targetChange.resumeToken,t.V?(Pr(void 0===s||"string"==typeof s),ni.fromBase64String(s||"")):(Pr(void 0===s||s instanceof Uint8Array),ni.fromUint8Array(s||new Uint8Array))),o=(a=e.targetChange.cause)&&(u=void 0===(c=a).code?Xr.UNKNOWN:Fs(c.code),new Jr(u,c.message||"")),s=new oa(n,r,i,o||null)}else if("documentChange"in e){e.documentChange,(n=e.documentChange).document,n.document.name,n.document.updateTime,r=Ia(t,n.document.name),i=ba(n.document.updateTime);var a=new Vo({mapValue:{fields:n.document.fields}}),u=(o=new xi(r,i,a,{}),n.targetIds||[]),c=n.removedTargetIds||[];s=new ra(u,c,o.key,o)}else if("documentDelete"in e)e.documentDelete,(n=e.documentDelete).document,r=Ia(t,n.document),i=n.readTime?ba(n.readTime):Mo.min(),a=new Ri(r,i),o=n.removedTargetIds||[],s=new ra([],o,a.key,a);else if("documentRemove"in e)e.documentRemove,(n=e.documentRemove).document,r=Ia(t,n.document),i=n.removedTargetIds||[],s=new ra([],i,r,null);else{if(!("filter"in e))return Lr();e.filter,(e=e.filter).targetId,r=new Ns(n=e.count||0),i=e.targetId,s=new ia(i,r)}return s}(this.D,t);return t=function(t){return"targetChange"in t?(t=t.targetChange).targetIds&&t.targetIds.length||!t.readTime?Mo.min():ba(t.readTime):Mo.min()}(t),this.listener.Tr(e,t)},Ml.prototype.Ir=function(t){var e,n,r,i,o={};o.database=Da(this.D),o.addTarget=(e=this.D,(r=Bi(r=(n=t).target)?{documents:xa(e,r)}:{query:Ra(e,r)}).targetId=n.targetId,0<n.resumeToken.approximateByteSize()?r.resumeToken=ma(e,n.resumeToken):0<n.snapshotVersion.compareTo(Mo.min())&&(r.readTime=va(e,n.snapshotVersion.toTimestamp())),r),this.D,i=t,(t=null==(t=function(){switch(i.purpose){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Lr()}}())?null:{"goog-listen-tags":t})&&(o.labels=t),this.wr(o)},Ml.prototype.Ar=function(t){var e={};e.database=Da(this.D),e.removeTarget=t,this.wr(e)},Ml),kl=(a(Pl,Dl=Se),Object.defineProperty(Pl.prototype,"br",{get:function(){return this.Rr},enumerable:!1,configurable:!0}),Pl.prototype.start=function(){this.Rr=!1,this.lastStreamToken=void 0,Dl.prototype.start.call(this)},Pl.prototype.mr=function(){this.Rr&&this.vr([])},Pl.prototype.Er=function(t){return this.er.Qi("Write",t)},Pl.prototype.onMessage=function(t){if(Pr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Rr){this.rr.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Pr(void 0!==r),n.map((function(t){return n=r,(t=(e=t).updateTime?ba(e.updateTime):ba(n)).isEqual(Mo.min())&&(t=ba(n)),new hs(t,e.transformResults||[]);var e,n}))):[]),n=ba(t.commitTime);return this.listener.Pr(n,e)}var r;return Pr(!t.writeResults||0===t.writeResults.length),this.Rr=!0,this.listener.Vr()},Pl.prototype.Sr=function(){var t={};t.database=Da(this.D),this.wr(t)},Pl.prototype.vr=function(t){var e=this;t={streamToken:this.lastStreamToken,writes:t.map((function(t){return ka(e.D,t)}))},this.wr(t)},Pl),Ol=(a(Ll,Sl=function(){}),Ll.prototype.Cr=function(){if(this.Dr)throw new Jr(Xr.FAILED_PRECONDITION,"The client has already been terminated.")},Ll.prototype.Mi=function(t,e,n){var r=this;return this.Cr(),this.credentials.getToken().then((function(i){return r.er.Mi(t,e,n,i)})).catch((function(t){throw t.code===Xr.UNAUTHENTICATED&&r.credentials.invalidateToken(),t}))},Ll.prototype.Ui=function(t,e,n){var r=this;return this.Cr(),this.credentials.getToken().then((function(i){return r.er.Ui(t,e,n,i)})).catch((function(t){throw t.code===Xr.UNAUTHENTICATED&&r.credentials.invalidateToken(),t}))},Ll.prototype.terminate=function(){this.Dr=!1},Ll),xl=(Rl.prototype.Or=function(){var t=this;0===this.Nr&&(this.kr("Unknown"),this.$r=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return t.$r=null,t.Mr("Backend didn't respond within 10 seconds."),t.kr("Offline"),Promise.resolve()})))},Rl.prototype.Lr=function(t){"Online"===this.state?this.kr("Unknown"):(this.Nr++,1<=this.Nr&&(this.Br(),this.Mr("Connection failed 1 times. Most recent error: "+t.toString()),this.kr("Offline")))},Rl.prototype.set=function(t){this.Br(),this.Nr=0,"Online"===t&&(this.Fr=!1),this.kr(t)},Rl.prototype.kr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},Rl.prototype.Mr=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.Fr?(Or(t),this.Fr=!1):kr("OnlineStateTracker",t)},Rl.prototype.Br=function(){null!==this.$r&&(this.$r.cancel(),this.$r=null)},Rl);function Rl(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.Nr=0,this.$r=null,this.Fr=!0}function Ll(t,e,n){var r=this;return(r=Sl.call(this)||this).credentials=t,r.er=e,r.D=n,r.Dr=!1,r}function Pl(t,e,n,r,i){var o=this;return(o=Dl.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).D=r,o.Rr=!1,o}function Ml(t,e,n,r,i){var o=this;return(o=Al.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).D=r,o}function Fl(t,e,n,r,i,o){this.Fe=t,this.tr=n,this.er=r,this.nr=i,this.listener=o,this.state=0,this.sr=0,this.ir=null,this.stream=null,this.rr=new Nl(t,e)}function Vl(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Fe=t,this.timerId=e,this.Ki=n,this.Wi=r,this.ji=i,this.Gi=0,this.zi=null,this.Hi=Date.now(),this.reset()}function ql(t){return u(this,void 0,void 0,(function(){var e,n;return c(this,(function(r){switch(r.label){case 0:if(!Ql(t))return[3,4];e=0,n=t.Kr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Ul(t){return u(this,void 0,void 0,(function(){var e,n;return c(this,(function(r){switch(r.label){case 0:e=0,n=t.Kr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function jl(t,e){t.Ur.has(e.targetId)||(t.Ur.set(e.targetId,e),Hl(t)?zl(t):nf(t).ar()&&Gl(t,e))}function Bl(t,e){var n=t;t=nf(n),n.Ur.delete(e),t.ar()&&Kl(n,e),0===n.Ur.size&&(t.ar()?t.lr():Ql(n)&&n.jr.set("Unknown"))}function Gl(t,e){t.Gr.H(e.targetId),nf(t).Ir(e)}function Kl(t,e){t.Gr.H(e),nf(t).Ar(e)}function zl(t){t.Gr=new aa({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},yt:function(e){return t.Ur.get(e)||null}}),nf(t).start(),t.jr.Or()}function Hl(t){return Ql(t)&&!nf(t).cr()&&0<t.Ur.size}function Ql(t){return 0===t.Qr.size}function Wl(t){t.Gr=void 0}function Yl(t,e,n){return u(this,void 0,void 0,(function(){var r,i;return c(this,(function(o){switch(o.label){case 0:if(t.jr.set("Online"),!(e instanceof oa&&2===e.state&&e.cause))return[3,6];o.label=1;case 1:return o.trys.push([1,3,,5]),[4,function(t,e){return u(this,void 0,void 0,(function(){var n,r,i,o;return c(this,(function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?(o=i[r],t.Ur.has(o)?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]):[3,5];case 2:s.sent(),t.Ur.delete(o),t.Gr.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return o.sent(),[3,5];case 3:return r=o.sent(),kr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,Xl(t,r)];case 4:return o.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof ra?t.Gr.st(e):e instanceof ia?t.Gr.ht(e):t.Gr.ot(e),n.isEqual(Mo.min()))return[3,13];o.label=7;case 7:return o.trys.push([7,11,,13]),[4,dh(t.localStore)];case 8:return i=o.sent(),0<=n.compareTo(i)?[4,(a=n,(h=(s=t).Gr.dt(a)).targetChanges.forEach((function(t,e){var n;0<t.resumeToken.approximateByteSize()&&(n=s.Ur.get(e))&&s.Ur.set(e,n.withResumeToken(t.resumeToken,a))})),h.targetMismatches.forEach((function(t){var e=s.Ur.get(t);e&&(s.Ur.set(t,e.withResumeToken(ni.EMPTY_BYTE_STRING,e.snapshotVersion)),Kl(s,t),e=new Pu(e.target,t,1,e.sequenceNumber),Gl(s,e))})),s.remoteSyncer.applyRemoteEvent(h))]:[3,10];case 9:o.sent(),o.label=10;case 10:return[3,13];case 11:return kr("RemoteStore","Failed to raise snapshot:",i=o.sent()),[4,Xl(t,i)];case 12:return o.sent(),[3,13];case 13:return[2]}var s,a,h}))}))}function Xl(t,e,n){return u(this,void 0,void 0,(function(){var r=this;return c(this,(function(i){switch(i.label){case 0:if(!Iu(e))throw e;return t.Qr.add(1),[4,Ul(t)];case 1:return i.sent(),t.jr.set("Offline"),n=n||function(){return dh(t.localStore)},t.asyncQueue.enqueueRetryable((function(){return u(r,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return kr("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Qr.delete(1),[4,ql(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function Jl(t,e){return e().catch((function(n){return Xl(t,n,e)}))}function $l(t){return u(this,void 0,void 0,(function(){var e,n,r,i;return c(this,(function(o){switch(o.label){case 0:n=rf(e=t),r=0<e.qr.length?e.qr[e.qr.length-1].batchId:-1,o.label=1;case 1:if(!(Ql(e)&&e.qr.length<10))return[3,7];o.label=2;case 2:return o.trys.push([2,4,,6]),[4,(s=e.localStore,a=r,(u=s).persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===a&&(a=-1),u.Tn.getNextMutationBatchAfterBatchId(t,a)})))];case 3:return null===(i=o.sent())?(0===e.qr.length&&n.lr(),[3,7]):(r=i.batchId,function(t,e){t.qr.push(e),(t=rf(t)).ar()&&t.br&&t.vr(e.mutations)}(e,i),[3,6]);case 4:return i=o.sent(),[4,Xl(e,i)];case 5:return o.sent(),[3,6];case 6:return[3,1];case 7:return Zl(e)&&tf(e),[2]}var s,a,u}))}))}function Zl(t){return Ql(t)&&!rf(t).cr()&&0<t.qr.length}function tf(t){rf(t).start()}function ef(t,e){return u(this,void 0,void 0,(function(){var n;return c(this,(function(r){switch(r.label){case 0:return n=t,e?(n.Qr.delete(2),[4,ql(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Qr.add(2),[4,Ul(n)]);case 3:r.sent(),n.jr.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function nf(t){var e,n,r,i=this;return t.zr||(t.zr=(e=t.datastore,n=t.asyncQueue,r={Vi:function(t){return u(this,void 0,void 0,(function(){return c(this,(function(e){return t.Ur.forEach((function(e,n){Gl(t,e)})),[2]}))}))}.bind(null,t),Di:function(t,e){return u(this,void 0,void 0,(function(){return c(this,(function(n){return Wl(t),Hl(t)?(t.jr.Lr(e),zl(t)):t.jr.set("Unknown"),[2]}))}))}.bind(null,t),Tr:Yl.bind(null,t)},e.Cr(),new Cl(n,e.er,e.credentials,e.D,r)),t.Kr.push((function(e){return u(i,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return e?(t.zr.hr(),Hl(t)?zl(t):t.jr.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.zr.stop()];case 2:n.sent(),Wl(t),n.label=3;case 3:return[2]}}))}))}))),t.zr}function rf(t){var e,n,r,i=this;return t.Hr||(t.Hr=(e=t.datastore,n=t.asyncQueue,r={Vi:function(t){return u(this,void 0,void 0,(function(){return c(this,(function(e){return rf(t).Sr(),[2]}))}))}.bind(null,t),Di:function(t,e){return u(this,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return e&&rf(t).br?[4,function(t,e){return u(this,void 0,void 0,(function(){var n,r;return c(this,(function(i){switch(i.label){case 0:return Ms(r=e.code)&&r!==Xr.ABORTED?(n=t.qr.shift(),rf(t).hr(),[4,Jl(t,(function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,$l(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Zl(t)&&tf(t),[2]}}))}))}.bind(null,t),Vr:function(t){return u(this,void 0,void 0,(function(){var e,n,r,i;return c(this,(function(o){for(e=rf(t),n=0,r=t.qr;n<r.length;n++)i=r[n],e.vr(i.mutations);return[2]}))}))}.bind(null,t),Pr:function(t,e,n){return u(this,void 0,void 0,(function(){var r,i;return c(this,(function(o){switch(o.label){case 0:return r=t.qr.shift(),i=Lu.from(r,e,n),[4,Jl(t,(function(){return t.remoteSyncer.applySuccessfulWrite(i)}))];case 1:return o.sent(),[4,$l(t)];case 2:return o.sent(),[2]}}))}))}.bind(null,t)},e.Cr(),new kl(n,e.er,e.credentials,e.D,r)),t.Kr.push((function(e){return u(i,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return e?(t.Hr.hr(),[4,$l(t)]):[3,2];case 1:return n.sent(),[3,4];case 2:return[4,t.Hr.stop()];case 3:n.sent(),0<t.qr.length&&(kr("RemoteStore","Stopping write stream with "+t.qr.length+" pending writes"),t.qr=[]),n.label=4;case 4:return[2]}}))}))}))),t.Hr}var of=(sf.createAndSchedule=function(t,e,n,r,i){return(i=new sf(t,e,Date.now()+n,r,i)).start(n),i},sf.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},sf.prototype.skipDelay=function(){return this.handleDelayElapsed()},sf.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Jr(Xr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},sf.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},sf.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},sf);function sf(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new lu,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}function af(t,e){if(Or("AsyncQueue",e+": "+t),Iu(t))return new Jr(Xr.UNAVAILABLE,e+": "+t);throw t}function uf(){this.queries=new Fc(xo,Oo),this.onlineState="Unknown",this.Zr=new Set}var cf=(yf.emptySet=function(t){return new yf(t.comparator)},yf.prototype.has=function(t){return null!=this.keyedMap.get(t)},yf.prototype.get=function(t){return this.keyedMap.get(t)},yf.prototype.first=function(){return this.sortedSet.minKey()},yf.prototype.last=function(){return this.sortedSet.maxKey()},yf.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},yf.prototype.indexOf=function(t){return(t=this.keyedMap.get(t))?this.sortedSet.indexOf(t):-1},Object.defineProperty(yf.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),yf.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},yf.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},yf.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},yf.prototype.isEqual=function(t){if(!(t instanceof yf))return!1;if(this.size!==t.size)return!1;for(var e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();e.hasNext();){var r=e.getNext().key,i=n.getNext().key;if(!r.isEqual(i))return!1}return!0},yf.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},yf.prototype.copy=function(t,e){var n=new yf;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n},yf),hf=(df.prototype.track=function(t){var e=t.doc.key,n=this.Jr.get(e);!n||0!==t.type&&3===n.type?this.Jr=this.Jr.insert(e,t):3===t.type&&1!==n.type?this.Jr=this.Jr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Jr=this.Jr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Jr=this.Jr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Jr=this.Jr.remove(e):1===t.type&&2===n.type?this.Jr=this.Jr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Jr=this.Jr.insert(e,{type:2,doc:t.doc}):Lr()},df.prototype.Yr=function(){var t=[];return this.Jr.inorderTraversal((function(e,n){t.push(n)})),t},df),lf=(pf.fromInitialDocuments=function(t,e,n,r){var i=[];return e.forEach((function(t){i.push({type:0,doc:t})})),new pf(t,e,cf.emptySet(e),i,n,r,!0,!1)},Object.defineProperty(pf.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),pf.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Oo(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},pf),ff=function(){this.Xr=void 0,this.listeners=[]};function pf(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}function df(){this.Jr=new Vs(ei.comparator)}function yf(t){this.comparator=t?function(e,n){return t(e,n)||ei.comparator(e.key,n.key)}:function(t,e){return ei.comparator(t.key,e.key)},this.keyedMap=Xs,this.sortedSet=new Vs(this.comparator)}function gf(t,e){return u(this,void 0,void 0,(function(){var n,r,i,o,s;return c(this,(function(a){switch(a.label){case 0:if(n=t,r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new ff),!i)return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),s=o,[4,n.onListen(r)];case 2:return s.Xr=a.sent(),[3,4];case 3:return s=af(s=a.sent(),"Initialization of query '"+Ro(e.query)+"' failed"),[2,void e.onError(s)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.eo(n.onlineState),o.Xr&&e.no(o.Xr)&&mf(n),[2]}}))}))}function vf(t,e){return u(this,void 0,void 0,(function(){var n,r,i,o,s;return c(this,(function(a){return n=t,r=e.query,i=!1,(o=n.queries.get(r))&&0<=(s=o.listeners.indexOf(e))&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]}))}))}function mf(t){t.Zr.forEach((function(t){t.next()}))}var bf=(Df.prototype.no=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new lf(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.io?this.oo(t)&&(this.so.next(t),o=!0):this.co(t,this.onlineState)&&(this.ao(t),o=!0),this.ro=t,o},Df.prototype.onError=function(t){this.so.error(t)},Df.prototype.eo=function(t){this.onlineState=t;var e=!1;return this.ro&&!this.io&&this.co(this.ro,t)&&(this.ao(this.ro),e=!0),e},Df.prototype.co=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.uo&&n||t.docs.isEmpty()&&"Offline"!==e)},Df.prototype.oo=function(t){if(0<t.docChanges.length)return!0;var e=this.ro&&this.ro.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},Df.prototype.ao=function(t){t=lf.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.io=!0,this.so.next(t)},Df),wf=(Sf.prototype.ho=function(){return"metadata"in this.payload},Sf),Ef=(Tf.prototype.Gn=function(t){return Ia(this.D,t)},Tf.prototype.zn=function(t){return t.metadata.exists?Ca(this.D,t.document,!1):new Ri(this.Gn(t.metadata.name),this.Hn(t.metadata.readTime))},Tf.prototype.Hn=ba,Tf),_f=(If.prototype.fo=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},If.prototype.wo=function(t){for(var e=new Map,n=new Ef(this.D),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.Gn(o.metadata.name),a=0,u=o.metadata.queries;a<u.length;a++){var c=u[a],h=(e.get(c)||Zs()).add(s);e.set(c,h)}}return e},If.prototype.complete=function(){return u(this,void 0,void 0,(function(){var t,e,n,r;return c(this,(function(i){switch(i.label){case 0:return[4,function(t,e,n,r){return u(this,void 0,void 0,(function(){var i,o,s,a,u,h,l,f,p,d;return c(this,(function(c){switch(c.label){case 0:for(i=t,o=Zs(),s=Qs,a=Js,u=0,h=n;u<h.length;u++)l=h[u],f=e.Gn(l.metadata.name),l.document&&(o=o.add(f)),s=s.insert(f,e.zn(l)),a=a.insert(f,e.Hn(l.metadata.readTime));return p=i.Qn.newChangeBuffer({trackRemovals:!0}),[4,vh(i,Co(_o($r.fromString("__bundle__/docs/"+r))))];case 1:return d=c.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",(function(t){return gh(t,p,s,Mo.min(),a).next((function(e){return p.apply(t),e})).next((function(e){return i.Ge.removeMatchingKeysForTargetId(t,d.targetId).next((function(){return i.Ge.addMatchingKeys(t,o,d.targetId)})).next((function(){return i.Kn.vn(t,e)}))}))}))]}}))}))}(this.localStore,new Ef(this.D),this.documents,this.lo.id)];case 1:t=i.sent(),e=this.wo(this.documents),n=0,r=this.queries,i.label=2;case 2:return n<r.length?(r=r[n],[4,function(t,e,n){return void 0===n&&(n=Zs()),u(this,void 0,void 0,(function(){var r,i;return c(this,(function(o){switch(o.label){case 0:return[4,vh(t,Co(Yu(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=t).persistence.runTransaction("Save named query","readwrite",(function(t){var o=ba(e.readTime);return 0<=r.snapshotVersion.compareTo(o)?i.He.saveNamedQuery(t,e):(o=r.withResumeToken(ni.EMPTY_BYTE_STRING,o),i.Bn=i.Bn.insert(o.targetId,o),i.Ge.updateTargetData(t,o).next((function(){return i.Ge.removeMatchingKeysForTargetId(t,r.targetId)})).next((function(){return i.Ge.addMatchingKeys(t,n,r.targetId)})).next((function(){return i.He.saveNamedQuery(t,e)})))}))]}}))}))}(this.localStore,r,e.get(r.name))]):[3,5];case 3:i.sent(),i.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new nh(Object.assign({},this.progress),t))]}}))}))},If);function If(t,e,n){this.lo=t,this.localStore=e,this.D=n,this.queries=[],this.documents=[],this.progress=Af(t)}function Tf(t){this.D=t}function Sf(t,e){this.payload=t,this.byteLength=e}function Df(t,e,n){this.query=t,this.so=e,this.io=!1,this.ro=null,this.onlineState="Unknown",this.options=n||{}}function Af(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Nf=function(t){this.key=t},Cf=function(t){this.key=t},kf=(Object.defineProperty(Pf.prototype,"To",{get:function(){return this._o},enumerable:!1,configurable:!0}),Pf.prototype.Io=function(t,e){var n=this,r=e?e.Ao:new hf,i=(e||this).Eo,o=(e||this).mutatedKeys,s=i,a=!1,u=Io(this.query)&&i.size===this.query.limit?i.last():null,c=To(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var h=i.get(t),l=(l=e instanceof xi?e:null)&&(Lo(n.query,l)?l:null),f=!!h&&n.mutatedKeys.has(h.key),p=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations);e=!1,h&&l?h.data().isEqual(l.data())?f!==p&&(r.track({type:3,doc:l}),e=!0):n.Ro(h,l)||(r.track({type:2,doc:l}),e=!0,(u&&0<n.po(l,u)||c&&n.po(l,c)<0)&&(a=!0)):!h&&l?(r.track({type:0,doc:l}),e=!0):h&&!l&&(r.track({type:1,doc:h}),e=!0,(u||c)&&(a=!0)),e&&(o=l?(s=s.add(l),p?o.add(t):o.delete(t)):(s=s.delete(t),o.delete(t)))})),Io(this.query)||To(this.query))for(;s.size>this.query.limit;){var h=Io(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{Eo:s,Ao:r,Mn:a,mutatedKeys:o}},Pf.prototype.Ro=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},Pf.prototype.applyChanges=function(t,e,n){var r=this,i=this.Eo;this.Eo=t.Eo,this.mutatedKeys=t.mutatedKeys;var o=t.Ao.Yr();o.sort((function(t,e){return i=t.type,o=e.type,n(i)-n(o)||r.po(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Lr()}}var i,o})),this.bo(n);var s=e?this.vo():[];return e=(n=0===this.yo.size&&this.current?1:0)!==this.mo,this.mo=n,0!==o.length||e?{snapshot:new lf(this.query,t.Eo,i,o,t.mutatedKeys,0==n,e,!1),Po:s}:{Po:s}},Pf.prototype.eo=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({Eo:this.Eo,Ao:new hf,mutatedKeys:this.mutatedKeys,Mn:!1},!1)):{Po:[]}},Pf.prototype.Vo=function(t){return!this._o.has(t)&&!!this.Eo.has(t)&&!this.Eo.get(t).hasLocalMutations},Pf.prototype.bo=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e._o=e._o.add(t)})),t.modifiedDocuments.forEach((function(t){})),t.removedDocuments.forEach((function(t){return e._o=e._o.delete(t)})),this.current=t.current)},Pf.prototype.vo=function(){var t=this;if(!this.current)return[];var e=this.yo;this.yo=Zs(),this.Eo.forEach((function(e){t.Vo(e.key)&&(t.yo=t.yo.add(e.key))}));var n=[];return e.forEach((function(e){t.yo.has(e)||n.push(new Cf(e))})),this.yo.forEach((function(t){e.has(t)||n.push(new Nf(t))})),n},Pf.prototype.So=function(t){return this._o=t.jn,this.yo=Zs(),t=this.Io(t.documents),this.applyChanges(t,!0)},Pf.prototype.Do=function(){return lf.fromInitialDocuments(this.query,this.Eo,this.mutatedKeys,0===this.mo)},Pf),Of=function(t,e,n){this.query=t,this.targetId=e,this.view=n},xf=function(t){this.key=t,this.Co=!1},Rf=(Object.defineProperty(Lf.prototype,"isPrimaryClient",{get:function(){return!0===this.Uo},enumerable:!1,configurable:!0}),Lf);function Lf(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.xo={},this.No=new Fc(xo,Oo),this.$o=new Map,this.Fo=new Set,this.Oo=new Vs(ei.comparator),this.ko=new Map,this.Mo=new Dh,this.Lo={},this.Bo=new Map,this.qo=mc.ne(),this.onlineState="Unknown",this.Uo=void 0}function Pf(t,e){this.query=t,this._o=e,this.mo=null,this.current=!1,this.yo=Zs(),this.mutatedKeys=Zs(),this.po=Po(t),this.Eo=new cf(this.po)}function Mf(t,e,n,r){return u(this,void 0,void 0,(function(){var i,o,s;return c(this,(function(a){switch(a.label){case 0:return t.Qo=function(e,n,r){return function(t,e,n,r){return u(this,void 0,void 0,(function(){var i,o;return c(this,(function(s){switch(s.label){case 0:return(i=e.view.Io(n)).Mn?[4,bh(t.localStore,e.query,!1).then((function(t){return t=t.documents,e.view.Io(t,i)}))]:[3,2];case 1:i=s.sent(),s.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),o=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(Hf(t,e.targetId,o.Po),o.snapshot)]}}))}))}(t,e,n,r)},[4,bh(t.localStore,e,!0)];case 1:return o=a.sent(),s=new kf(e,o.jn),i=s.Io(o.documents),o=na.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),o=s.applyChanges(i,t.isPrimaryClient,o),Hf(t,n,o.Po),s=new Of(e,n,s),[2,(t.No.set(e,s),t.$o.has(n)?t.$o.get(n).push(e):t.$o.set(n,[e]),o.snapshot)]}}))}))}function Ff(t,e,n){return u(this,void 0,void 0,(function(){var r,i;return c(this,(function(o){switch(o.label){case 0:i=ep(t),o.label=1;case 1:return o.trys.push([1,5,,6]),[4,(c=i.localStore,h=e,f=c,p=pi.now(),d=h.reduce((function(t,e){return t.add(e.key)}),Zs()),f.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return f.Kn.bn(t,d).next((function(e){l=e;for(var n,r=[],i=0,o=h;i<o.length;i++){var s=o[i],a=(n=s,a=l.get(s.key),function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof xi?e.field(o.field):void 0;null!=(s=Qo(o.transform,s||null))&&(n=(null==n?new qo:n).set(o.field,s))}return n?n.v():null}(n.fieldTransforms,a));null!=a&&r.push(new Es(s.key,a,function t(e){var n=[];return Br(e.fields||{},(function(e,r){var i=new ti([e]);if(Ni(r))if(0===(r=t(r.mapValue).fields).length)n.push(i);else for(var o=0,s=r;o<s.length;o++){var a=s[o];n.push(i.child(a))}else n.push(i)})),new Fo(n)}(a.proto.mapValue),fs.exists(!0)))}return f.Tn.addMutationBatch(t,p,r,h)}))})).then((function(t){var e=t.applyToLocalDocumentSet(l);return{batchId:t.batchId,changes:e}})))];case 2:return r=o.sent(),i.sharedClientState.addPendingMutation(r.batchId),s=i,a=r.batchId,u=n,c=(c=(c=s.Lo[s.currentUser.toKey()])||new Vs(Vr)).insert(a,u),s.Lo[s.currentUser.toKey()]=c,[4,Wf(i,r.changes)];case 3:return o.sent(),[4,$l(i.remoteStore)];case 4:return o.sent(),[3,6];case 5:return i=af(i=o.sent(),"Failed to persist write"),n.reject(i),[3,6];case 6:return[2]}var s,a,u,c,h,l,f,p,d}))}))}function Vf(t,e){return u(this,void 0,void 0,(function(){var n,r;return c(this,(function(i){switch(i.label){case 0:n=t,i.label=1;case 1:return i.trys.push([1,4,,6]),[4,yh(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach((function(t,e){(e=n.ko.get(e))&&(Pr(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),0<t.addedDocuments.size?e.Co=!0:0<t.modifiedDocuments.size?Pr(e.Co):0<t.removedDocuments.size&&(Pr(e.Co),e.Co=!1))})),[4,Wf(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Sc(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function qf(t,e,n){var r;((t=t).isPrimaryClient&&0===n||!t.isPrimaryClient&&1===n)&&(r=[],t.No.forEach((function(t,n){(n=n.view.eo(e)).snapshot&&r.push(n.snapshot)})),function(t,e){t.onlineState=e;var n=!1;t.queries.forEach((function(t,r){for(var i=0,o=r.listeners;i<o.length;i++)o[i].eo(e)&&(n=!0)})),n&&mf(t)}(t.eventManager,e),r.length&&t.xo.Tr(r),t.onlineState=e,t.isPrimaryClient&&t.sharedClientState.setOnlineState(e))}function Uf(t,e,n){return u(this,void 0,void 0,(function(){var r,i;return c(this,(function(o){switch(o.label){case 0:r=t,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,(s=r.localStore,a=e,(u=s).persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var e;return u.Tn.lookupMutationBatch(t,a).next((function(n){return Pr(null!==n),e=n.keys(),u.Tn.removeMutationBatch(t,n)})).next((function(){return u.Tn.performConsistencyCheck(t)})).next((function(){return u.Kn.bn(t,e)}))})))];case 2:return i=o.sent(),Gf(r,e,n),Bf(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,Wf(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Sc(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}var s,a,u}))}))}function jf(t,e){return u(this,void 0,void 0,(function(){var n,r,i;return c(this,(function(o){switch(o.label){case 0:Ql((n=t).remoteStore)||kr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,(s=n.localStore).persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return s.Tn.getHighestUnacknowledgedBatchId(t)}))];case 2:return-1===(r=o.sent())?[2,void e.resolve()]:((i=n.Bo.get(r)||[]).push(e),n.Bo.set(r,i),[3,4]);case 3:return i=af(i=o.sent(),"Initialization of waitForPendingWrites() operation failed"),e.reject(i),[3,4];case 4:return[2]}var s}))}))}function Bf(t,e){(t.Bo.get(e)||[]).forEach((function(t){t.resolve()})),t.Bo.delete(e)}function Gf(t,e,n){var r=t,i=r.Lo[r.currentUser.toKey()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.Lo[r.currentUser.toKey()]=i)}function Kf(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.$o.get(e);r<i.length;r++){var o=i[r];t.No.delete(o),n&&t.xo.Ko(o,n)}t.$o.delete(e),t.isPrimaryClient&&t.Mo.os(e).forEach((function(e){t.Mo.containsKey(e)||zf(t,e)}))}function zf(t,e){t.Fo.delete(e.path.canonicalString());var n=t.Oo.get(e);null!==n&&(Bl(t.remoteStore,n),t.Oo=t.Oo.remove(e),t.ko.delete(n),Qf(t))}function Hf(t,e,n){for(var r,i,o,s=0,a=n;s<a.length;s++){var u=a[s];u instanceof Nf?(t.Mo.addReference(u.key,e),r=t,o=void 0,i=(o=(i=u).key).path.canonicalString(),r.Oo.get(o)||r.Fo.has(i)||(kr("SyncEngine","New document in limbo: "+o),r.Fo.add(i),Qf(r))):u instanceof Cf?(kr("SyncEngine","Document no longer in limbo: "+u.key),t.Mo.removeReference(u.key,e),t.Mo.containsKey(u.key)||zf(t,u.key)):Lr()}}function Qf(t){for(;0<t.Fo.size&&t.Oo.size<t.maxConcurrentLimboResolutions;){var e=t.Fo.values().next().value;t.Fo.delete(e);var n=new ei($r.fromString(e));e=t.qo.next(),t.ko.set(e,new xf(n)),t.Oo=t.Oo.insert(n,e),jl(t.remoteStore,new Pu(Co(_o(n.path)),e,2,Dr.o))}}function Wf(t,e,n){return u(this,void 0,void 0,(function(){var r,i,o,s;return c(this,(function(a){switch(a.label){case 0:return i=[],o=[],s=[],(r=t).No.isEmpty()?[3,3]:(r.No.forEach((function(t,a){s.push(r.Qo(a,e,n).then((function(t){t&&(r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),i.push(t),t=ih.Nn(a.targetId,t),o.push(t))})))})),[4,Promise.all(s)]);case 1:return a.sent(),r.xo.Tr(i),[4,function(t,e){return u(this,void 0,void 0,(function(){var n,r,i,o,s,a,u;return c(this,(function(c){switch(c.label){case 0:n=t,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return fu.forEach(e,(function(e){return fu.forEach(e.Cn,(function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)})).next((function(){return fu.forEach(e.xn,(function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)}))}))}))}))];case 2:return c.sent(),[3,4];case 3:if(!Iu(r=c.sent()))throw r;return kr("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)u=o[i],s=u.targetId,u.fromCache||(a=n.Bn.get(s),u=a.snapshotVersion,u=a.withLastLimboFreeSnapshotVersion(u),n.Bn=n.Bn.insert(s,u));return[2]}}))}))}(r.localStore,o)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function Yf(t,e){return u(this,void 0,void 0,(function(){var n,r;return c(this,(function(i){switch(i.label){case 0:return(n=t).currentUser.isEqual(e)?[3,3]:(kr("SyncEngine","User change. New user:",e.toKey()),[4,fh(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,(o=n).Bo.forEach((function(t){t.forEach((function(t){t.reject(new Jr(Xr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),o.Bo.clear(),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,Wf(n,r.Wn)];case 2:i.sent(),i.label=3;case 3:return[2]}var o}))}))}function Xf(t,e,n,r){return u(this,void 0,void 0,(function(){var i,o;return c(this,(function(s){switch(s.label){case 0:return[4,(a=(i=t).localStore,u=e,h=(c=a).Tn,c.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return h.Jt(t,u).next((function(e){return e?c.Kn.bn(t,e):fu.resolve(null)}))})))];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,$l(i.remoteStore)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Gf(i,e,r||null),Bf(i,e),i.localStore.Tn.Xt(e)):Lr(),s.label=4;case 4:return[4,Wf(i,o)];case 5:return s.sent(),[3,7];case 6:kr("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}var a,u,c,h}))}))}function Jf(t,e){return u(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,h;return c(this,(function(c){switch(c.label){case 0:return tp(n=t),ep(n),!0!==e||!0===n.Uo?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,$f(n,r.toArray())]);case 1:return i=c.sent(),n.Uo=!0,[4,ef(n.remoteStore,!0)];case 2:for(c.sent(),o=0,s=i;o<s.length;o++)a=s[o],jl(n.remoteStore,a);return[3,7];case 3:return!1!==e||!1===n.Uo?[3,7]:(u=[],h=Promise.resolve(),n.$o.forEach((function(t,e){n.sharedClientState.isLocalQueryTarget(e)?u.push(e):h=h.then((function(){return Kf(n,e),mh(n.localStore,e,!0)})),Bl(n.remoteStore,e)})),[4,h]);case 4:return c.sent(),[4,$f(n,u)];case 5:return c.sent(),(l=n).ko.forEach((function(t,e){Bl(l.remoteStore,e)})),l.Mo.cs(),l.ko=new Map,l.Oo=new Vs(ei.comparator),n.Uo=!1,[4,ef(n.remoteStore,!1)];case 6:c.sent(),c.label=7;case 7:return[2]}var l}))}))}function $f(t,e){return u(this,void 0,void 0,(function(){var n,r,i,o,s,a,h,l,f,p,d,y;return c(this,(function(g){switch(g.label){case 0:n=t,r=[],i=[],o=0,s=e,g.label=1;case 1:return o<s.length?(a=s[o],h=void 0,(l=n.$o.get(a))&&0!==l.length?[4,vh(n.localStore,Co(l[0]))]:[3,7]):[3,13];case 2:h=g.sent(),f=0,p=l,g.label=3;case 3:return f<p.length?(d=p[f],d=n.No.get(d),[4,function(t,e){return u(this,void 0,void 0,(function(){var n,r;return c(this,(function(i){switch(i.label){case 0:return[4,bh((n=t).localStore,e.query,!0)];case 1:return r=i.sent(),r=e.view.So(r),[2,(n.isPrimaryClient&&Hf(n,e.targetId,r.Po),r)]}}))}))}(n,d)]):[3,6];case 4:(d=g.sent()).snapshot&&i.push(d.snapshot),g.label=5;case 5:return f++,[3,3];case 6:return[3,11];case 7:return[4,wh(n.localStore,a)];case 8:return y=g.sent(),[4,vh(n.localStore,y)];case 9:return h=g.sent(),[4,Mf(n,Zf(y),a,!1)];case 10:g.sent(),g.label=11;case 11:r.push(h),g.label=12;case 12:return o++,[3,1];case 13:return[2,(n.xo.Tr(i),r)]}}))}))}function Zf(t){return Eo(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function tp(t){return t.remoteStore.remoteSyncer.applyRemoteEvent=Vf.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=function(t,e){var n=t;if((t=n.ko.get(e))&&t.Co)return Zs().add(t.key);var r=Zs();if(!(e=n.$o.get(e)))return r;for(var i=0,o=e;i<o.length;i++){var s=o[i];s=n.No.get(s),r=r.unionWith(s.view.To)}return r}.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=function(t,e,n){return u(this,void 0,void 0,(function(){var r,i,o,s;return c(this,(function(a){switch(a.label){case 0:return(r=t).sharedClientState.updateQueryState(e,"rejected",n),s=r.ko.get(e),(i=s&&s.key)?(o=(o=new Vs(ei.comparator)).insert(i,new Ri(i,Mo.min())),s=Zs().add(i),s=new ea(Mo.min(),new Map,new zs(Vr),o,s),[4,Vf(r,s)]):[3,2];case 1:return a.sent(),r.Oo=r.Oo.remove(i),r.ko.delete(e),Qf(r),[3,4];case 2:return[4,mh(r.localStore,e,!1).then((function(){return Kf(r,e,n)})).catch(Sc)];case 3:a.sent(),a.label=4;case 4:return[2]}}))}))}.bind(null,t),t.xo.Tr=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=s.query;if(a=n.queries.get(a)){for(var u=0,c=a.listeners;u<c.length;u++)c[u].no(s)&&(r=!0);a.Xr=s}}r&&mf(n)}.bind(null,t.eventManager),t.xo.Ko=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,t.eventManager),t}function ep(t){return t.remoteStore.remoteSyncer.applySuccessfulWrite=function(t,e){return u(this,void 0,void 0,(function(){var n,r,i;return c(this,(function(o){switch(o.label){case 0:n=t,r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,ph(n.localStore,e)];case 2:return i=o.sent(),Gf(n,r,null),Bf(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,Wf(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Sc(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Uf.bind(null,t),t}function np(t,e,n){var r=t;(function(t,e,n){return u(this,void 0,void 0,(function(){var r,i,o,s,a;return c(this,(function(u){switch(u.label){case 0:return u.trys.push([0,14,,15]),[4,e.getMetadata()];case 1:return r=u.sent(),[4,(l=t.localStore,p=l,d=ba((f=r).createTime),p.persistence.runTransaction("hasNewerBundle","readonly",(function(t){return p.He.getBundleMetadata(t,f.id)})).then((function(t){return!!t&&0<=t.createTime.compareTo(d)})))];case 2:return u.sent()?[4,e.close()]:[3,4];case 3:return[2,(u.sent(),void n._completeWith({taskState:"Success",documentsLoaded:r.totalDocuments,bytesLoaded:r.totalBytes,totalDocuments:r.totalDocuments,totalBytes:r.totalBytes}))];case 4:return n._updateProgress(Af(r)),i=new _f(r,t.localStore,e.D),[4,e.Wo()];case 5:o=u.sent(),u.label=6;case 6:return o?[4,i.fo(o)]:[3,10];case 7:return(s=u.sent())&&n._updateProgress(s),[4,e.Wo()];case 8:o=u.sent(),u.label=9;case 9:return[3,6];case 10:return[4,i.complete()];case 11:return a=u.sent(),[4,Wf(t,a.En,void 0)];case 12:return u.sent(),[4,(l=t.localStore,c=r,(h=l).persistence.runTransaction("Save bundle","readwrite",(function(t){return h.He.saveBundleMetadata(t,c)})))];case 13:return u.sent(),n._completeWith(a.progress),[3,15];case 14:return xr("SyncEngine","Loading bundle failed with "+(a=u.sent())),n._failWith(a),[3,15];case 15:return[2]}var c,h,l,f,p,d}))}))})(r,e,n).then((function(){r.sharedClientState.notifyBundleLoaded()}))}var rp,ip,op=(fp.prototype.initialize=function(t){return u(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return this.D=Il(t.databaseInfo.databaseId),this.sharedClientState=this.jo(t),this.persistence=this.Go(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.zo(t),this.localStore=this.Ho(t),[2]}}))}))},fp.prototype.zo=function(t){return null},fp.prototype.Ho=function(t){return lh(this.persistence,new oh,t.initialUser,this.D)},fp.prototype.Go=function(t){return new xh(Lh.Cs,this.D)},fp.prototype.jo=function(t){return new rl},fp.prototype.terminate=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}}))}))},fp),sp=(a(lp,ip=op),lp.prototype.initialize=function(t){return u(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,ip.prototype.initialize.call(this,t)];case 1:return e.sent(),[4,_h(this.localStore)];case 2:return e.sent(),[4,this.Jo.initialize(this,t)];case 3:return e.sent(),[4,ep(this.Jo.syncEngine)];case 4:return e.sent(),[4,$l(this.Jo.remoteStore)];case 5:return e.sent(),[2]}}))}))},lp.prototype.Ho=function(t){return lh(this.persistence,new oh,t.initialUser,this.D)},lp.prototype.zo=function(t){var e=this.persistence.referenceDelegate.garbageCollector;return new Nc(e,t.asyncQueue)},lp.prototype.Go=function(t){var e=eh(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?uc.withCacheSize(this.cacheSizeBytes):uc.DEFAULT;return new Jc(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,El(),_l(),this.D,this.sharedClientState,!!this.forceOwnership)},lp.prototype.jo=function(t){return new rl},lp),ap=(a(hp,rp=sp),hp.prototype.initialize=function(t){return u(this,void 0,void 0,(function(){var e,n=this;return c(this,(function(r){switch(r.label){case 0:return[4,rp.prototype.initialize.call(this,t)];case 1:return r.sent(),e=this.Jo.syncEngine,this.sharedClientState instanceof nl?(this.sharedClientState.syncEngine={wi:Xf.bind(null,e),_i:function(t,e,n,r){return u(this,void 0,void 0,(function(){var i,o,s;return c(this,(function(a){switch(a.label){case 0:return(i=t).Uo?(kr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.$o.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Eh(i.localStore)];case 3:return o=a.sent(),s=ea.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,Wf(i,o,s)];case 4:return a.sent(),[3,8];case 5:return[4,mh(i.localStore,e,!0)];case 6:return a.sent(),Kf(i,e,r),[3,8];case 7:Lr(),a.label=8;case 8:return[2]}}))}))}.bind(null,e),mi:function(t,e,n){return u(this,void 0,void 0,(function(){var r,i,o,s,a,u,h,l;return c(this,(function(f){switch(f.label){case 0:if(!(r=tp(t)).Uo)return[3,10];i=0,o=e,f.label=1;case 1:return i<o.length?(o=o[i],r.$o.has(o)?(kr("SyncEngine","Adding an already active target "+o),[3,5]):[4,wh(r.localStore,o)]):[3,6];case 2:return s=f.sent(),[4,vh(r.localStore,s)];case 3:return a=f.sent(),[4,Mf(r,Zf(s),a.targetId,!1)];case 4:f.sent(),jl(r.remoteStore,a),f.label=5;case 5:return i++,[3,1];case 6:u=function(t){return c(this,(function(e){switch(e.label){case 0:return r.$o.has(t)?[4,mh(r.localStore,t,!1).then((function(){Bl(r.remoteStore,t),Kf(r,t)})).catch(Sc)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},h=0,l=n,f.label=7;case 7:return h<l.length?(l=l[h],[5,u(l)]):[3,10];case 8:f.sent(),f.label=9;case 9:return h++,[3,7];case 10:return[2]}}))}))}.bind(null,e),gn:function(t){return t.localStore.persistence.gn()}.bind(null,e),di:function(t){return u(this,void 0,void 0,(function(){var e;return c(this,(function(n){return[2,Eh((e=t).localStore).then((function(t){return Wf(e,t)}))]}))}))}.bind(null,e)},[4,this.sharedClientState.start()]):[3,3];case 2:r.sent(),r.label=3;case 3:return[4,this.persistence.en((function(t){return u(n,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,Jf(this.Jo.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}}))}))}))];case 4:return r.sent(),[2]}}))}))},hp.prototype.jo=function(t){var e=El();if(!nl.At(e))throw new Jr(Xr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=eh(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new nl(e,t.asyncQueue,n,t.clientId,t.initialUser)},hp),up=(cp.prototype.initialize=function(t,e){return u(this,void 0,void 0,(function(){var n=this;return c(this,(function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return qf(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=Yf.bind(null,this.syncEngine),[4,ef(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},cp.prototype.createEventManager=function(t){return new uf},cp.prototype.createDatastore=function(t){var e=Il(t.databaseInfo.databaseId),n=(n=t.databaseInfo,new ul(n));return t=t.credentials,new Ol(t,n,e)},cp.prototype.createRemoteStore=function(t){var e=this;return new Tl(this.localStore,this.datastore,t.asyncQueue,(function(t){return qf(e.syncEngine,t,0)}),t=new(ol.At()?ol:il))},cp.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,s){return o=new Rf(t,e,n,r,i,o),s&&(o.Uo=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},cp.prototype.terminate=function(){return function(t){return u(this,void 0,void 0,(function(){var e;return c(this,(function(n){switch(n.label){case 0:return e=t,kr("RemoteStore","RemoteStore shutting down."),e.Qr.add(5),[4,Ul(e)];case 1:return n.sent(),e.Wr.shutdown(),e.jr.set("Unknown"),[2]}}))}))}(this.remoteStore)},cp);function cp(){}function hp(t,e){var n=this;return(n=rp.call(this,t,e,!1)||this).Jo=t,n.cacheSizeBytes=e,n.synchronizeTabs=!0,n}function lp(t,e,n){var r=this;return(r=ip.call(this)||this).Jo=t,r.cacheSizeBytes=e,r.forceOwnership=n,r.synchronizeTabs=!1,r}function fp(){this.synchronizeTabs=!1}function pp(t,e){void 0===e&&(e=10240);var n=0;return{read:function(){return u(this,void 0,void 0,(function(){var r;return c(this,(function(i){return n<t.byteLength?(r={value:t.slice(n,n+e),done:!1},[2,(n+=e,r)]):[2,{done:!0}]}))}))},cancel:function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){return[2]}))}))},releaseLock:function(){},closed:Promise.reject("unimplemented")}}var dp=(Ip.prototype.next=function(t){this.observer.next&&this.Yo(this.observer.next,t)},Ip.prototype.error=function(t){this.observer.error?this.Yo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Ip.prototype.Xo=function(){this.muted=!0},Ip.prototype.Yo=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},Ip),yp=(_p.prototype.close=function(){return this.Zo.cancel()},_p.prototype.getMetadata=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){return[2,this.metadata.promise]}))}))},_p.prototype.Wo=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.ec())]}}))}))},_p.prototype.ec=function(){return u(this,void 0,void 0,(function(){var t,e,n;return c(this,(function(r){switch(r.label){case 0:return[4,this.nc()];case 1:return null===(t=r.sent())?[2,null]:(n=this.tc.decode(t),e=Number(n),isNaN(e)&&this.sc("length string ("+n+") is not valid number"),[4,this.ic(e)]);case 2:return n=r.sent(),[2,new wf(JSON.parse(n),t.length+e)]}}))}))},_p.prototype.rc=function(){return this.buffer.findIndex((function(t){return t==="{".charCodeAt(0)}))},_p.prototype.nc=function(){return u(this,void 0,void 0,(function(){var t,e;return c(this,(function(n){switch(n.label){case 0:return this.rc()<0?[4,this.oc()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.rc())<0&&this.sc("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}}))}))},_p.prototype.ic=function(t){return u(this,void 0,void 0,(function(){var e;return c(this,(function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.oc()]:[3,3];case 1:n.sent()&&this.sc("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.tc.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}}))}))},_p.prototype.sc=function(t){throw this.Zo.cancel(),new Error("Invalid bundle format: "+t)},_p.prototype.oc=function(){return u(this,void 0,void 0,(function(){var t,e;return c(this,(function(n){switch(n.label){case 0:return[4,this.Zo.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}}))}))},_p),gp=(Ep.prototype.lookup=function(t){return u(this,void 0,void 0,(function(){var e,n=this;return c(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),0<this.mutations.length)throw new Jr(Xr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return u(this,void 0,void 0,(function(){var n,r,i,o,s;return c(this,(function(a){switch(a.label){case 0:return r=Da((n=t).D)+"/documents",i={documents:e.map((function(t){return _a(n.D,t)}))},[4,n.Ui("BatchGetDocuments",r,i)];case 1:return i=a.sent(),o=new Map,i.forEach((function(t){var e;e=n.D,t="found"in(t=t)?function(t,e){Pr(!!e.found),e.found.name,e.found.updateTime;var n=Ia(t,e.found.name);return t=ba(e.found.updateTime),e=new Vo({mapValue:{fields:e.found.fields}}),new xi(n,t,e,{})}(e,t):"missing"in t?function(t,e){return Pr(!!e.missing),Pr(!!e.readTime),t=Ia(t,e.missing),e=ba(e.readTime),new Ri(t,e)}(e,t):Lr(),o.set(t.key.toString(),t)})),s=[],[2,(e.forEach((function(t){Pr(!!(t=o.get(t.toString()))),s.push(t)})),s)]}}))}))}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach((function(t){t instanceof Ri||t instanceof xi?n.recordVersion(t):Lr()})),e)]}}))}))},Ep.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},Ep.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},Ep.prototype.delete=function(t){this.write(new xs(t,this.precondition(t))),this.writtenDocs.add(t.toString())},Ep.prototype.commit=function(){return u(this,void 0,void 0,(function(){var t,e=this;return c(this,(function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){n=ei.fromPath(n),e.mutations.push(new Rs(n,e.precondition(n)))})),[4,function(t,e){return u(this,void 0,void 0,(function(){var n,r,i;return c(this,(function(o){switch(o.label){case 0:return r=Da((n=t).D)+"/documents",i={writes:e.map((function(t){return ka(n.D,t)}))},[4,n.Mi("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}}))}))},Ep.prototype.recordVersion=function(t){var e;if(t instanceof xi)e=t.version;else{if(!(t instanceof Ri))throw Lr();e=Mo.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Jr(Xr.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},Ep.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?fs.updateTime(e):fs.none()},Ep.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(this.writtenDocs.has(t.toString())||!e)return fs.exists(!0);if(e.isEqual(Mo.min()))throw new Jr(Xr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return fs.updateTime(e)},Ep.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},Ep.prototype.ensureCommitNotCalled=function(){},Ep),vp=(wp.prototype.run=function(){this.ac()},wp.prototype.ac=function(){var t=this;this.rr.Yi((function(){return u(t,void 0,void 0,(function(){var t,e,n=this;return c(this,(function(r){return t=new gp(this.datastore),(e=this.uc(t))&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.hc(t)}))}))})).catch((function(t){n.hc(t)})),[2]}))}))}))},wp.prototype.uc=function(t){try{var e=this.updateFunction(t);return!Kr(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},wp.prototype.hc=function(t){var e=this;0<this.cc&&this.lc(t)?(--this.cc,this.asyncQueue.enqueueAndForget((function(){return e.ac(),Promise.resolve()}))):this.deferred.reject(t)},wp.prototype.lc=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!Ms(t))},wp),mp=(bp.prototype.getConfiguration=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return[4,this.receivedInitialUser.promise];case 1:return[2,(t.sent(),{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100})]}}))}))},bp.prototype.setCredentialChangeListener=function(t){var e=this;this.credentialListener=t,this.receivedInitialUser.promise.then((function(){return e.credentialListener(e.user)}))},bp.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new Jr(Xr.FAILED_PRECONDITION,"The client has already been terminated.")},bp.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new lu;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((function(){return u(t,void 0,void 0,(function(){var t;return c(this,(function(n){switch(n.label){case 0:return n.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:n.sent(),n.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:n.sent(),n.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=af(t=n.sent(),"Failed to shutdown persistence"),e.reject(t),[3,6];case 6:return[2]}}))}))})),e.promise},bp);function bp(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=Ph.UNAUTHENTICATED,this.clientId=Mr.u(),this.credentialListener=function(){},this.receivedInitialUser=new lu,this.credentials.setChangeListener((function(t){kr("FirestoreClient","Received user=",t.uid),r.user=t,r.credentialListener(t),r.receivedInitialUser.resolve()}))}function wp(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.cc=5,this.rr=new Nl(this.asyncQueue,"transaction_retry")}function Ep(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}function _p(t,e){var n=this;this.Zo=t,this.D=e,this.metadata=new lu,this.buffer=new Uint8Array,this.tc=new TextDecoder("utf-8"),this.ec().then((function(t){t&&t.ho()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))}),(function(t){return n.metadata.reject(t)}))}function Ip(t){this.observer=t,this.muted=!1}function Tp(t,e){return u(this,void 0,void 0,(function(){var n,r,i=this;return c(this,(function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),kr("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener((function(n){r.isEqual(n)||(r=n,t.asyncQueue.enqueueRetryable((function(){return u(i,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return[4,fh(e.localStore,n)];case 1:return t.sent(),[2]}}))}))})))})),e.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=e,[2]}}))}))}function Sp(t,e){return u(this,void 0,void 0,(function(){var n,r;return c(this,(function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,Dp(t)];case 1:return n=i.sent(),kr("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener((function(n){return t.asyncQueue.enqueueRetryable((function(){return function(t,e){return u(this,void 0,void 0,(function(){var n,r;return c(this,(function(i){switch(i.label){case 0:return(n=t).asyncQueue.verifyOperationInProgress(),kr("RemoteStore","RemoteStore received new credentials"),r=Ql(n),n.Qr.add(3),[4,Ul(n)];case 1:return i.sent(),r&&n.jr.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Qr.delete(3),[4,ql(n)];case 3:return i.sent(),[2]}}))}))}(e.remoteStore,n)}))})),t.onlineComponents=e,[2]}}))}))}function Dp(t){return u(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(kr("FirestoreClient","Using default OfflineComponentProvider"),[4,Tp(t,new op)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}}))}))}function Ap(t){return u(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(kr("FirestoreClient","Using default OnlineComponentProvider"),[4,Sp(t,new up)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}}))}))}function Np(t){return Dp(t).then((function(t){return t.persistence}))}function Cp(t){return Dp(t).then((function(t){return t.localStore}))}function kp(t){return Ap(t).then((function(t){return t.remoteStore}))}function Op(t){return Ap(t).then((function(t){return t.syncEngine}))}function xp(t){return u(this,void 0,void 0,(function(){var e,n;return c(this,(function(r){switch(r.label){case 0:return[4,Ap(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=function(t,e){return u(this,void 0,void 0,(function(){var n,r,i,o,s;return c(this,(function(a){switch(a.label){case 0:return n=tp(t),(s=n.No.get(e))?(r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Do(),[3,4]):[3,1];case 1:return[4,vh(n.localStore,Co(e))];case 2:return o=a.sent(),s=n.sharedClientState.addLocalQueryTarget(o.targetId),r=o.targetId,[4,Mf(n,e,r,"current"===s)];case 3:i=a.sent(),n.isPrimaryClient&&jl(n.remoteStore,o),a.label=4;case 4:return[2,i]}}))}))}.bind(null,e.syncEngine),n.onUnlisten=function(t,e){return u(this,void 0,void 0,(function(){var n,r,i;return c(this,(function(o){switch(o.label){case 0:return r=(n=t).No.get(e),1<(i=n.$o.get(r.targetId)).length?[2,(n.$o.set(r.targetId,i.filter((function(t){return!Oo(t,e)}))),void n.No.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,mh(n.localStore,r.targetId,!1).then((function(){n.sharedClientState.clearQueryState(r.targetId),Bl(n.remoteStore,r.targetId),Kf(n,r.targetId)})).catch(Sc)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Kf(n,r.targetId),[4,mh(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}.bind(null,e.syncEngine),n)]}}))}))}function Rp(t,e,n){var r=this;void 0===n&&(n={});var i=new lu;return t.asyncQueue.enqueueAndForget((function(){return u(r,void 0,void 0,(function(){var r;return c(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new dp({next:function(o){e.enqueueAndForget((function(){return vf(t,s)}));var a=o.docs.has(n);!a&&o.fromCache?i.reject(new Jr(Xr.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new Jr(Xr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new bf(_o(n.path),o,{includeMetadataChanges:!0,uo:!0});return gf(t,s)},[4,xp(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}function Lp(t,e,n){var r=this;void 0===n&&(n={});var i=new lu;return t.asyncQueue.enqueueAndForget((function(){return u(r,void 0,void 0,(function(){var r;return c(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new dp({next:function(n){e.enqueueAndForget((function(){return vf(t,s)})),n.fromCache&&"server"===r.source?i.reject(new Jr(Xr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new bf(n,o,{includeMetadataChanges:!0,uo:!0});return gf(t,s)},[4,xp(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}function Pp(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t}var Mp=function(t,e,n,r,i,o){this.databaseId=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.autoDetectLongPolling=o},Fp=(Object.defineProperty(Qp.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Qp.prototype.isEqual=function(t){return t instanceof Qp&&t.projectId===this.projectId&&t.database===this.database},Qp),Vp=new Map,qp=(Hp.prototype.getToken=function(){return Promise.resolve(null)},Hp.prototype.invalidateToken=function(){},Hp.prototype.setChangeListener=function(t){(this.changeListener=t)(Ph.UNAUTHENTICATED)},Hp.prototype.removeChangeListener=function(){this.changeListener=null},Hp),Up=(zp.prototype.getToken=function(){var t=this,e=this.dc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.dc!==e?(kr("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Pr("string"==typeof n.accessToken),new Pp(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},zp.prototype.invalidateToken=function(){this.forceRefresh=!0},zp.prototype.setChangeListener=function(t){this.changeListener=t,this.receivedInitialUser&&t(this.currentUser)},zp.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.fc),this.fc=null,this.changeListener=null},zp.prototype.wc=function(){var t=this.auth&&this.auth.getUid();return Pr(null===t||"string"==typeof t),new Ph(t)},zp),jp=(Object.defineProperty(Kp.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.mc},e=this._c.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Kp),Bp=(Gp.prototype.getToken=function(){return Promise.resolve(new jp(this._c,this.mc))},Gp.prototype.setChangeListener=function(t){t(Ph.FIRST_PARTY)},Gp.prototype.removeChangeListener=function(){},Gp.prototype.invalidateToken=function(){},Gp);function Gp(t,e){this._c=t,this.mc=e}function Kp(t,e){this._c=t,this.mc=e,this.type="FirstParty",this.user=Ph.FIRST_PARTY}function zp(t){var e=this;this.fc=null,this.currentUser=Ph.UNAUTHENTICATED,this.receivedInitialUser=!1,this.dc=0,this.changeListener=null,this.forceRefresh=!1,this.fc=function(){e.dc++,e.currentUser=e.wc(),e.receivedInitialUser=!0,e.changeListener&&e.changeListener(e.currentUser)},this.dc=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.fc):(this.fc(null),t.get().then((function(t){e.auth=t,e.fc&&e.auth.addAuthTokenListener(e.fc)}),(function(){})))}function Hp(){this.changeListener=null}function Qp(t,e){this.projectId=t,this.database=e||"(default)"}function Wp(t,e,n){if(!n)throw new Jr(Xr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Yp(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Jr(Xr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Xp(t,e,n,r){if(!0===e&&!0===r)throw new Jr(Xr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Jp(t){if(!ei.isDocumentKey(t))throw new Jr(Xr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function $p(t){if(ei.isDocumentKey(t))throw new Jr(Xr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Zp(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return 20<t.length&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"!=typeof t)return"function"==typeof t?"a function":Lr();if(t instanceof Array)return"an array";var e=function(){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&1<e.length)return e[1]}return null}();return e?"a custom "+e+" object":"an object"}function td(t,e){if((t="_delegate"in t?t._delegate:t)instanceof e)return t;if(e.name===t.constructor.name)throw new Jr(Xr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");throw t=Zp(t),new Jr(Xr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function ed(t,e){if(e<=0)throw new Jr(Xr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var nd,rd=(pd.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},pd),id=(Object.defineProperty(fd.prototype,"app",{get:function(){if(!this._app)throw new Jr(Xr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(fd.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(fd.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),fd.prototype._setSettings=function(t){if(this._settingsFrozen)throw new Jr(Xr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new rd(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new qp;switch(t.type){case"gapi":var e=t.client;return Pr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Bp(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Jr(Xr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},fd.prototype._getSettings=function(){return this._settings},fd.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},fd.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},fd.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},fd.prototype._terminate=function(){return(t=Vp.get(this))&&(kr("ComponentProvider","Removing Datastore"),Vp.delete(this),t.terminate()),Promise.resolve();var t},fd),od=function(t){this._delegate=t},sd=(Object.defineProperty(ld.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(ld.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(ld.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(ld.prototype,"parent",{get:function(){return new ud(this.firestore,this._converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),ld.prototype.withConverter=function(t){return new ld(this.firestore,t,this._key)},ld),ad=(hd.prototype.withConverter=function(t){return new hd(this.firestore,t,this._query)},hd),ud=(a(cd,nd=ad),Object.defineProperty(cd.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(cd.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(cd.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new sd(this.firestore,null,new ei(t))},enumerable:!1,configurable:!0}),cd.prototype.withConverter=function(t){return new cd(this.firestore,t,this._path)},cd);function cd(t,e,n){var r=this;return(r=nd.call(this,t,e,_o(n))||this).firestore=t,r._path=n,r.type="collection",r}function hd(t,e,n){this._converter=e,this._query=n,this.type="query",this.firestore=t}function ld(t,e,n){this._converter=e,this._key=n,this.type="document",this.firestore=t}function fd(t,e){this._persistenceKey="(lite)",this._settings=new rd({}),this._settingsFrozen=!1,t instanceof Fp?(this._databaseId=t,this._credentials=new qp):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Jr(Xr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Fp(t.options.projectId)}(t),this._credentials=new Up(e))}function pd(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Jr(Xr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Jr(Xr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Xp("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function dd(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof od&&(t=t._delegate),Wp("collection","path",e),t instanceof id)return $p(n=$r.fromString.apply($r,h([e],r))),new ud(t,null,n);if(!(t instanceof sd||t instanceof ud))throw new Jr(Xr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return $p(n=$r.fromString.apply($r,h([t.path],r)).child($r.fromString(e))),new ud(t.firestore,null,n)}function yd(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof od&&(t=t._delegate),Wp("doc","path",e=1===arguments.length?Mr.u():e),t instanceof id)return Jp(n=$r.fromString.apply($r,h([e],r))),new sd(t,null,new ei(n));if(!(t instanceof sd||t instanceof ud))throw new Jr(Xr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Jp(n=t._path.child($r.fromString.apply($r,h([e],r)))),new sd(t.firestore,t instanceof ud?t._converter:null,new ei(n))}function gd(t,e){return t instanceof od&&(t=t._delegate),e instanceof od&&(e=e._delegate),(t instanceof sd||t instanceof ud)&&(e instanceof sd||e instanceof ud)&&t.firestore===e.firestore&&t.path===e.path&&t._converter===e._converter}function vd(t,e){return t instanceof od&&(t=t._delegate),e instanceof od&&(e=e._delegate),t instanceof ad&&e instanceof ad&&t.firestore===e.firestore&&Oo(t._query,e._query)&&t._converter===e._converter}var md=(Object.defineProperty(bd.prototype,"isShuttingDown",{get:function(){return this.Ec},enumerable:!1,configurable:!0}),bd.prototype.enqueueAndForget=function(t){this.enqueue(t)},bd.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.vc(),this.Pc(t)},bd.prototype.enterRestrictedMode=function(){var t;this.Ec||(this.Ec=!0,(t=_l())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.bc))},bd.prototype.enqueue=function(t){return this.vc(),this.Ec?new Promise((function(t){})):this.Pc(t)},bd.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget((function(){return e.gc.push(t),e.Vc()}))},bd.prototype.Vc=function(){return u(this,void 0,void 0,(function(){var t,e=this;return c(this,(function(n){switch(n.label){case 0:if(0===this.gc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.gc[0]()];case 2:return n.sent(),this.gc.shift(),this.rr.reset(),[3,4];case 3:if(!Iu(t=n.sent()))throw t;return kr("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:0<this.gc.length&&this.rr.Yi((function(){return e.Vc()})),n.label=5;case 5:return[2]}}))}))},bd.prototype.Pc=function(t){var e=this,n=this.yc.then((function(){return e.Ac=!0,t().catch((function(t){throw e.Ic=t,e.Ac=!1,Or("INTERNAL UNHANDLED ERROR: ",(r=(n=t).message||"",r=n.stack?n.stack.includes(n.message)?n.stack:n.message+"\n"+n.stack:r)),t;var n,r})).then((function(t){return e.Ac=!1,t}))}));return this.yc=n},bd.prototype.enqueueAfterDelay=function(t,e,n){var r=this;return this.vc(),-1<this.Rc.indexOf(t)&&(e=0),n=of.createAndSchedule(this,t,e,n,(function(t){return r.Sc(t)})),this.Tc.push(n),n},bd.prototype.vc=function(){this.Ic&&Lr()},bd.prototype.verifyOperationInProgress=function(){},bd.prototype.Dc=function(){return u(this,void 0,void 0,(function(){var t;return c(this,(function(e){switch(e.label){case 0:return[4,t=this.yc];case 1:e.sent(),e.label=2;case 2:if(t!==this.yc)return[3,0];e.label=3;case 3:return[2]}}))}))},bd.prototype.Cc=function(t){for(var e=0,n=this.Tc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},bd.prototype.xc=function(t){var e=this;return this.Dc().then((function(){e.Tc.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,r=e.Tc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.Dc()}))},bd.prototype.Nc=function(t){this.Rc.push(t)},bd.prototype.Sc=function(t){t=this.Tc.indexOf(t),this.Tc.splice(t,1)},bd);function bd(){var t=this;this.yc=Promise.resolve(),this.gc=[],this.Ec=!1,this.Tc=[],this.Ic=null,this.Ac=!1,this.Rc=[],this.rr=new Nl(this,"async_queue_retry"),this.bc=function(){var e=_l();e&&kr("AsyncQueue","Visibility state changed to "+e.visibilityState),t.rr.Zi()};var e=_l();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.bc)}function wd(t){return function(){if("object"==typeof t&&null!==t)for(var e=t,n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return 1}}()}var Ed,_d=(Sd.prototype.onProgress=function(t,e,n){this._progressObserver={next:t,error:e,complete:n}},Sd.prototype.catch=function(t){return this._taskCompletionResolver.promise.catch(t)},Sd.prototype.then=function(t,e){return this._taskCompletionResolver.promise.then(t,e)},Sd.prototype._completeWith=function(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)},Sd.prototype._failWith=function(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)},Sd.prototype._updateProgress=function(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)},Sd),Id=(a(Td,Ed=id),Td.prototype._terminate=function(){return this._firestoreClient||Ad(this),this._firestoreClient.terminate()},Td);function Td(t,e){var n=this;return(n=Ed.call(this,t,e)||this)._queue=new md,n._persistenceKey="name"in t?t.name:"[DEFAULT]",n}function Sd(){this._progressObserver={},this._taskCompletionResolver=new lu,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function Dd(t){return t._firestoreClient||Ad(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Ad(t){var e,n,r=t._freezeSettings();e=t._databaseId,n=t._persistenceKey,r=new Mp(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling),t._firestoreClient=new mp(t._credentials,t._queue,r)}function Nd(t,e,n){var r=this,i=new lu;return t.asyncQueue.enqueue((function(){return u(r,void 0,void 0,(function(){var r;return c(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,Tp(t,n)];case 1:return o.sent(),[4,Sp(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!("FirebaseError"===(s=r=o.sent()).name?s.code===Xr.FAILED_PRECONDITION||s.code===Xr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&s instanceof DOMException)||22===s.code||20===s.code||11===s.code))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}var s}))}))})).then((function(){return i.promise}))}function Cd(t){if(t._initialized||t._terminated)throw new Jr(Xr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var kd=(jd.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},jd),Od=(Ud.fromBase64String=function(t){try{return new Ud(ni.fromBase64String(t))}catch(t){throw new Jr(Xr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},Ud.fromUint8Array=function(t){return new Ud(ni.fromUint8Array(t))},Ud.prototype.toBase64=function(){return this._byteString.toBase64()},Ud.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},Ud.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Ud.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},Ud),xd=function(t){this._methodName=t},Rd=(Object.defineProperty(qd.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(qd.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),qd.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},qd.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},qd.prototype._compareTo=function(t){return Vr(this._lat,t._lat)||Vr(this._long,t._long)},qd),Ld=/^__.*__$/,Pd=(Vd.prototype.toMutation=function(t,e){return null!==this.fieldMask?new Es(t,this.data,this.fieldMask,e,this.fieldTransforms):new ws(t,this.data,e,this.fieldTransforms)},Vd),Md=(Fd.prototype.toMutation=function(t,e){return new Es(t,this.data,this.fieldMask,e,this.fieldTransforms)},Fd);function Fd(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}function Vd(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}function qd(t,e){if(!isFinite(t)||t<-90||90<t)throw new Jr(Xr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Jr(Xr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}function Ud(t){this._byteString=t}function jd(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Jr(Xr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ti(t)}function Bd(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Lr()}}var Gd=(Object.defineProperty(Hd.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Hd.prototype,"Fc",{get:function(){return this.settings.Fc},enumerable:!1,configurable:!0}),Hd.prototype.Oc=function(t){return new Hd(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.D,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},Hd.prototype.kc=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.Oc({path:e,Mc:!1})).Lc(t),e},Hd.prototype.Bc=function(t){var e;return t=null===(e=this.path)||void 0===e?void 0:e.child(t),(t=this.Oc({path:t,Mc:!1})).$c(),t},Hd.prototype.qc=function(t){return this.Oc({path:void 0,Mc:!0})},Hd.prototype.Uc=function(t){return Ey(t,this.settings.methodName,this.settings.Qc||!1,this.path,this.settings.Kc)},Hd.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},Hd.prototype.$c=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Lc(this.path.get(t))},Hd.prototype.Lc=function(t){if(0===t.length)throw this.Uc("Document fields must not be empty");if(Bd(this.Fc)&&Ld.test(t))throw this.Uc('Document fields cannot begin and end with "__"')},Hd),Kd=(zd.prototype.Wc=function(t,e,n,r){return void 0===r&&(r=!1),new Gd({Fc:t,methodName:e,Kc:n,path:ti.emptyPath(),Mc:!1,Qc:r},this.databaseId,this.D,this.ignoreUndefinedProperties)},zd);function zd(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.D=n||Il(t)}function Hd(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.D=n,this.ignoreUndefinedProperties=r,void 0===i&&this.$c(),this.fieldTransforms=i||[],this.fieldMask=o||[]}function Qd(t){var e=t._freezeSettings(),n=Il(t._databaseId);return new Kd(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Wd(t,e,n,r,i,o){void 0===o&&(o={});var s,a,u=t.Wc(o.merge||o.mergeFields?2:0,e,n,i);if(vy("Data must be an object, but it was:",u,r),r=yy(r,u),o.merge)s=new Fo(u.fieldMask),a=u.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,l=o.mergeFields;h<l.length;h++){var f=my(e,l[h],n);if(!u.contains(f))throw new Jr(Xr.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");_y(c,f)||c.push(f)}s=new Fo(c),a=u.fieldTransforms.filter((function(t){return s.covers(t.field)}))}else s=null,a=u.fieldTransforms;return new Pd(new Vo(r),s,a)}var Yd,Xd=(a(Jd,Yd=xd),Jd.prototype._toFieldTransform=function(t){if(2!==t.Fc)throw 1===t.Fc?t.Uc(this._methodName+"() can only appear at the top level of your update data"):t.Uc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},Jd.prototype.isEqual=function(t){return t instanceof Jd},Jd);function Jd(){return null!==Yd&&Yd.apply(this,arguments)||this}function $d(t,e,n){return new Gd({Fc:3,Kc:e.settings.Kc,methodName:t._methodName,Mc:n},e.databaseId,e.D,e.ignoreUndefinedProperties)}var Zd,ty,ey,ny,ry=(a(hy,ny=xd),hy.prototype._toFieldTransform=function(t){return new ls(t.path,new Xo)},hy.prototype.isEqual=function(t){return t instanceof hy},hy),iy=(a(cy,ey=xd),cy.prototype._toFieldTransform=function(t){var e=$d(this,t,!0),n=this.jc.map((function(t){return dy(t,e)}));return n=new Jo(n),new ls(t.path,n)},cy.prototype.isEqual=function(t){return this===t},cy),oy=(a(uy,ty=xd),uy.prototype._toFieldTransform=function(t){var e=$d(this,t,!0),n=this.jc.map((function(t){return dy(t,e)}));return n=new ns(n),new ls(t.path,n)},uy.prototype.isEqual=function(t){return this===t},uy),sy=(a(ay,Zd=xd),ay.prototype._toFieldTransform=function(t){var e=new ss(t.D,Ho(t.D,this.Gc));return new ls(t.path,e)},ay.prototype.isEqual=function(t){return this===t},ay);function ay(t,e){var n=this;return(n=Zd.call(this,t)||this).Gc=e,n}function uy(t,e){var n=this;return(n=ty.call(this,t)||this).jc=e,n}function cy(t,e){var n=this;return(n=ey.call(this,t)||this).jc=e,n}function hy(){return null!==ny&&ny.apply(this,arguments)||this}function ly(t,e,n,r){var i=t.Wc(1,e,n);vy("Data must be an object, but it was:",i,r);var o=[],s=new qo;return Br(r,(function(t,r){var a=wy(e,t,n);r instanceof od&&(r=r._delegate),t=i.Bc(a),r instanceof Xd?o.push(a):null!=(t=dy(r,t))&&(o.push(a),s.set(a,t))})),r=new Fo(o),new Md(s.v(),r,i.fieldTransforms)}function fy(t,e,n,r,i,o){var s=t.Wc(1,e,n),a=[my(e,r,n)],u=[i];if(o.length%2!=0)throw new Jr(Xr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(my(e,o[c])),u.push(o[c+1]);for(var h,l,f,p=[],d=new qo,y=a.length-1;0<=y;--y)_y(p,a[y])||(h=a[y],(l=u[y])instanceof od&&(l=l._delegate),f=s.Bc(h),l instanceof Xd?p.push(h):null!=(f=dy(l,f))&&(p.push(h),d.set(h,f)));return i=new Fo(p),new Md(d.v(),i,s.fieldTransforms)}function py(t,e,n,r){return void 0===r&&(r=!1),dy(n,t.Wc(r?4:3,e))}function dy(t,e){if(gy(t=t instanceof od?t._delegate:t))return vy("Unsupported field value:",e,t),yy(t,e);if(t instanceof xd)return function(t,e){if(!Bd(e.Fc))throw e.Uc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Uc(t._methodName+"() is not currently supported inside arrays");(t=t._toFieldTransform(e))&&e.fieldTransforms.push(t)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Mc&&4!==e.Fc)throw e.Uc("Nested arrays are not supported");return function(e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=dy(o[i],e.qc(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(e)}return function(t,e){if(null===(t=t instanceof od?t._delegate:t))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Ho(e.D,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=pi.fromDate(t);return{timestampValue:va(e.D,n)}}if(t instanceof pi)return n=new pi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:va(e.D,n)};if(t instanceof Rd)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Od)return{bytesValue:ma(e.D,t._byteString)};if(t instanceof sd){n=e.databaseId;var r=t.firestore._databaseId;if(!r.isEqual(n))throw e.Uc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:wa(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Uc("Unsupported field value: "+Zp(t))}(t,e)}function yy(t,e){var n={};return Gr(t)?e.path&&0<e.path.length&&e.fieldMask.push(e.path):Br(t,(function(t,r){null!=(r=dy(r,e.kc(t)))&&(n[t]=r)})),{mapValue:{fields:n}}}function gy(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof pi||t instanceof Rd||t instanceof Od||t instanceof sd||t instanceof xd)}function vy(t,e,n){if(!gy(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))throw"an object"===(n=Zp(n))?e.Uc(t+" a custom object"):e.Uc(t+" "+n);var r}function my(t,e,n){if((e=e instanceof od?e._delegate:e)instanceof kd)return e._internalPath;if("string"==typeof e)return wy(t,e);throw Ey("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var by=new RegExp("[~\\*/\\[\\]]");function wy(t,e,n){if(0<=e.search(by))throw Ey("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(kd.bind.apply(kd,h([void 0],e.split(".")))))._internalPath}catch(r){throw Ey("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Ey(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i;return e="Function "+e+"() called with invalid data",n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Jr(Xr.INVALID_ARGUMENT,(e+=". ")+t+n)}function _y(t,e){return t.some((function(t){return t.isEqual(e)}))}var Iy,Ty=(Object.defineProperty(Ay.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(Ay.prototype,"ref",{get:function(){return new sd(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),Ay.prototype.exists=function(){return null!==this._document},Ay.prototype.data=function(){if(this._document){if(this._converter){var t=new Sy(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.toProto())}},Ay.prototype.get=function(t){if(this._document&&null!==(t=this._document.data().field(Ny("DocumentSnapshot.get",t))))return this._userDataWriter.convertValue(t)},Ay),Sy=(a(Dy,Iy=Ty),Dy.prototype.data=function(){return Iy.prototype.data.call(this)},Dy);function Dy(){return null!==Iy&&Iy.apply(this,arguments)||this}function Ay(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}function Ny(t,e){return"string"==typeof e?wy(t,e):(e instanceof od?e._delegate:e)._internalPath}var Cy,ky,Oy=(Vy.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Vy),xy=(a(Fy,ky=Ty),Fy.prototype.exists=function(){return ky.prototype.exists.call(this)},Fy.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new Ry(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.toProto(),t.serverTimestamps)}},Fy.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document&&null!==(t=this._document.data().field(Ny("DocumentSnapshot.get",t))))return this._userDataWriter.convertValue(t,e.serverTimestamps)},Fy),Ry=(a(My,Cy=xy),My.prototype.data=function(t){return void 0===t&&(t={}),Cy.prototype.data.call(this,t)},My),Ly=(Object.defineProperty(Py.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(Py.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Py.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Py.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach((function(r){t.call(e,new Ry(n._firestore,n._userDataWriter,r.key,r,new Oy(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query._converter))}))},Py.prototype.docChanges=function(t){if((t=!!(t=void 0===t?{}:t).includeMetadataChanges)&&this._snapshot.excludesMetadataChanges)throw new Jr(Xr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map((function(e){var r=new Ry(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Oy(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query._converter);return e.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new Ry(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Oy(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query._converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Lr()}}(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges},Py);function Py(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new Oy(r.hasPendingWrites,r.fromCache),this.query=n}function My(){return null!==Cy&&Cy.apply(this,arguments)||this}function Fy(t,e,n,r,i,o){var s=this;return(s=ky.call(this,t,e,n,r,o)||this)._firestore=t,s._firestoreImpl=t,s.metadata=i,s}function Vy(t,e){this.hasPendingWrites=t,this.fromCache=e}function qy(t,e){return t instanceof xy&&e instanceof xy?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Ly&&e instanceof Ly&&t._firestore===e._firestore&&vd(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function Uy(t){if(To(t)&&0===t.explicitOrderBy.length)throw new Jr(Xr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}function jy(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++)t=i[r]._apply(t);return t}var By,Gy,Ky,zy,Hy,Qy=(a(ng,Hy=y=function(){}),ng.prototype._apply=function(t){var e=Qd(t.firestore);return e=function(t,e,n,r,i,o){if(r.isKeyField()){if("array-contains"===i||"array-contains-any"===i)throw new Jr(Xr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){og(o,i);for(var s=[],a=0,u=o;a<u.length;a++){var c=u[a];s.push(ig(n,t,c))}h={arrayValue:{values:s}}}else h=ig(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||og(o,i),h=py(e,"where",o,"in"===i||"not-in"===i);var h=Ki.create(r,i,h);return function(t,e){if(e.g()){var n=Do(t);if(null!==n&&!n.isEqual(e.field))throw new Jr(Xr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=So(t))&&sg(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new Jr(Xr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Jr(Xr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t._query,e,t.firestore._databaseId,this.zc,this.Hc,this.Jc),new ad(t.firestore,t._converter,(e=(t=t._query).filters.concat([e]),new wo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},ng),Wy=(a(eg,zy=y),eg.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Jr(Xr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Jr(Xr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new vo(e,n);return e=r,null!==So(n=t)||null!==(t=Do(n))&&sg(0,t,e.field),r}(t._query,this.zc,this.Yc);return new ad(t.firestore,t._converter,(e=(t=t._query).explicitOrderBy.concat([e]),new wo(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},eg),Yy=(a(tg,Ky=y),tg.prototype._apply=function(t){return new ad(t.firestore,t._converter,ko(t._query,this.Xc,this.Zc))},tg),Xy=(a(Zy,Gy=y),Zy.prototype._apply=function(t){var e=rg(t,this.type,this.ta,this.ea);return new ad(t.firestore,t._converter,(t=t._query,e=e,new wo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},Zy),Jy=(a($y,By=y),$y.prototype._apply=function(t){var e=rg(t,this.type,this.ta,this.ea);return new ad(t.firestore,t._converter,(t=t._query,e=e,new wo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},$y);function $y(t,e,n){var r=this;return(r=By.call(this)||this).type=t,r.ta=e,r.ea=n,r}function Zy(t,e,n){var r=this;return(r=Gy.call(this)||this).type=t,r.ta=e,r.ea=n,r}function tg(t,e,n){var r=this;return(r=Ky.call(this)||this).type=t,r.Xc=e,r.Zc=n,r}function eg(t,e){var n=this;return(n=zy.call(this)||this).zc=t,n.Yc=e,n.type="orderBy",n}function ng(t,e,n){var r=this;return(r=Hy.call(this)||this).zc=t,r.Hc=e,r.Jc=n,r.type="where",r}function rg(t,e,n,r){if(n[0]instanceof od&&(n[0]=n[0]._delegate),n[0]instanceof Ty)return function(t,n,r,i){if(!r)throw new Jr(Xr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+e+"().");for(var o=[],s=0,a=No(t);s<a.length;s++){var u=a[s];if(u.field.isKeyField())o.push(Ii(n,r.key));else{var c=r.field(u.field);if(yi(c))throw new Jr(Xr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c)throw u=u.field.canonicalString(),new Jr(Xr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");o.push(c)}}return new ho(o,i)}(t._query,t.firestore._databaseId,n[0]._document,r);var i=Qd(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new Jr(Xr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.isKeyField()){if("string"!=typeof c)throw new Jr(Xr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Ao(t)&&-1!==c.indexOf("/"))throw new Jr(Xr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child($r.fromString(c));if(!ei.isDocumentKey(h))throw new Jr(Xr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new ei(h),a.push(Ii(e,h))}else c=py(n,r,c),a.push(c)}return new ho(a,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function ig(t,e,n){if("string"==typeof(n=n instanceof od?n._delegate:n)){if(""===n)throw new Jr(Xr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ao(e)&&-1!==n.indexOf("/"))throw new Jr(Xr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child($r.fromString(n)),!ei.isDocumentKey(e))throw new Jr(Xr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Ii(t,new ei(e))}if(n instanceof sd)return Ii(t,n._key);throw new Jr(Xr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Zp(n)+".")}function og(t,e){if(!Array.isArray(t)||0===t.length)throw new Jr(Xr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Jr(Xr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function sg(t,e,n){if(!n.isEqual(e))throw new Jr(Xr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function ag(){}function ug(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}ag.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),vi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return li(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(fi(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Lr()}},ag.prototype.convertObject=function(t,e){var n=this,r={};return Br(t.fields||{},(function(t,i){r[t]=n.convertValue(i,e)})),r},ag.prototype.convertGeoPoint=function(t){return new Rd(li(t.latitude),li(t.longitude))},ag.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.convertValue(t,e)}))},ag.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=function t(e){return yi(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(gi(t));default:return null}},ag.prototype.convertTimestamp=function(t){return t=hi(t),new pi(t.seconds,t.nanos)},ag.prototype.convertDocumentKey=function(t,e){var n=$r.fromString(t);return Pr(ja(n)),t=new Fp(n.get(1),n.get(3)),n=new ei(n.popFirst(5)),t.isEqual(e)||Or("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n};var cg,hg=(a(pg,cg=Se=ag),pg.prototype.convertBytes=function(t){return new Od(t)},pg.prototype.convertReference=function(t){return t=this.convertDocumentKey(t,this.firestore._databaseId),new sd(this.firestore,null,t)},pg),lg=(fg.prototype.set=function(t,e,n){return this._verifyNotCommitted(),e=ug((t=dg(t,this._firestore))._converter,e,n),n=Wd(this._dataReader,"WriteBatch.set",t._key,e,null!==t._converter,n),this._mutations.push(n.toMutation(t._key,fs.none())),this},fg.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return this._verifyNotCommitted(),t=dg(t,this._firestore),e="string"==typeof(e=e instanceof od?e._delegate:e)||e instanceof kd?fy(this._dataReader,"WriteBatch.update",t._key,e,n,r):ly(this._dataReader,"WriteBatch.update",t._key,e),this._mutations.push(e.toMutation(t._key,fs.exists(!0))),this},fg.prototype.delete=function(t){return this._verifyNotCommitted(),t=dg(t,this._firestore),this._mutations=this._mutations.concat(new xs(t._key,fs.none())),this},fg.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,0<this._mutations.length?this._commitHandler(this._mutations):Promise.resolve()},fg.prototype._verifyNotCommitted=function(){if(this._committed)throw new Jr(Xr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},fg);function fg(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=Qd(t)}function pg(t){var e=this;return(e=cg.call(this)||this).firestore=t,e}function dg(t,e){if((t=t instanceof od?t._delegate:t).firestore!==e)throw new Jr(Xr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var yg,gg=(a(vg,yg=Se),vg.prototype.convertBytes=function(t){return new Od(t)},vg.prototype.convertReference=function(t){return t=this.convertDocumentKey(t,this.firestore._databaseId),new sd(this.firestore,null,t)},vg);function vg(t){var e=this;return(e=yg.call(this)||this).firestore=t,e}function mg(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=td(t,sd);var o=td(t.firestore,Id),s=Qd(o);return wg(o,[("string"==typeof(e=e instanceof od?e._delegate:e)||e instanceof kd?fy(s,"updateDoc",t._key,e,n,r):ly(s,"updateDoc",t._key,e)).toMutation(t._key,fs.exists(!0))])}function bg(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t instanceof od&&(t=t._delegate);var r={includeMetadataChanges:!1},i=0;"object"!=typeof e[i]||wd(e[i])||(r=e[i],i++);var o,s,a,h,l,f,p={includeMetadataChanges:r.includeMetadataChanges};return wd(e[i])&&(o=e[i],e[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),e[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),e[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),t instanceof sd?(a=td(t.firestore,Id),h=_o(t._key.path),f={next:function(n){e[i]&&e[i](Eg(a,t,n))},error:e[i+1],complete:e[i+2]}):(s=td(t,ad),a=td(s.firestore,Id),h=s._query,l=new gg(a),f={next:function(t){e[i]&&e[i](new Ly(a,l,s,t))},error:e[i+1],complete:e[i+2]},Uy(t._query)),function(t,e,n){var r=this,i=new dp(f),o=new bf(e,i,n);return t.asyncQueue.enqueueAndForget((function(){return u(r,void 0,void 0,(function(){var e;return c(this,(function(n){switch(n.label){case 0:return e=gf,[4,xp(t)];case 1:return[2,e.apply(void 0,[n.sent(),o])]}}))}))})),function(){i.Xo(),t.asyncQueue.enqueueAndForget((function(){return u(r,void 0,void 0,(function(){var e;return c(this,(function(n){switch(n.label){case 0:return e=vf,[4,xp(t)];case 1:return[2,e.apply(void 0,[n.sent(),o])]}}))}))}))}}(Dd(a),h,p)}function wg(t,e){return function(t,e){var n=this,r=new lu;return t.asyncQueue.enqueueAndForget((function(){return u(n,void 0,void 0,(function(){var n;return c(this,(function(i){switch(i.label){case 0:return n=Ff,[4,Op(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(Dd(t),e)}function Eg(t,e,n){var r=n.docs.get(e._key),i=new gg(t);return new xy(t,i,e._key,r,new Oy(n.hasPendingWrites,n.fromCache),e._converter)}var _g,Ig=(Sg.prototype.get=function(t){var e=this,n=dg(t,this._firestore),r=new hg(this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return Lr();if((t=t[0])instanceof Ri)return new Ty(e._firestore,r,n._key,null,n._converter);if(t instanceof xi)return new Ty(e._firestore,r,t.key,t,n._converter);throw Lr()}))},Sg.prototype.set=function(t,e,n){return e=ug((t=dg(t,this._firestore))._converter,e,n),n=Wd(this._dataReader,"Transaction.set",t._key,e,null!==t._converter,n),this._transaction.set(t._key,n),this},Sg.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return t=dg(t,this._firestore),e="string"==typeof(e=e instanceof od?e._delegate:e)||e instanceof kd?fy(this._dataReader,"Transaction.update",t._key,e,n,r):ly(this._dataReader,"Transaction.update",t._key,e),this._transaction.update(t._key,e),this},Sg.prototype.delete=function(t){return t=dg(t,this._firestore),this._transaction.delete(t._key),this},a(Tg,_g=Sg),Tg.prototype.get=function(t){var e=this,n=dg(t,this._firestore),r=new gg(this._firestore);return _g.prototype.get.call(this,t).then((function(t){return new xy(e._firestore,r,n._key,t._document,new Oy(!1,!1),n._converter)}))},Tg);function Tg(t,e){var n=this;return(n=_g.call(this,t,e)||this)._firestore=t,n}function Sg(t,e){this._firestore=t,this._transaction=e,this._dataReader=Qd(t)}function Dg(){if("undefined"==typeof Uint8Array)throw new Jr(Xr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Ag(){if("undefined"==typeof atob)throw new Jr(Xr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Ng,Cg,kg,Og=(a(Vg,kg=od),Vg.fromBase64String=function(t){return Ag(),new Vg(Od.fromBase64String(t))},Vg.fromUint8Array=function(t){return Dg(),new Vg(Od.fromUint8Array(t))},Vg.prototype.toBase64=function(){return Ag(),this._delegate.toBase64()},Vg.prototype.toUint8Array=function(){return Dg(),this._delegate.toUint8Array()},Vg.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},Vg.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Vg),xg=(Fg.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Cd(t=td(t,Id));var n=Dd(t),r=t._freezeSettings();return Nd(n,t=new up,new sp(t,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},Fg.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Cd(t=td(t,Id));var e=Dd(t),n=t._freezeSettings();return Nd(e,t=new up,new ap(t,n.cacheSizeBytes))}(t._delegate)},Fg.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new Jr(Xr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new lu;return t._queue.enqueueAndForgetEvenWhileRestricted((function(){return u(e,void 0,void 0,(function(){var e;return c(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return u(this,void 0,void 0,(function(){var e;return c(this,(function(n){switch(n.label){case 0:return du.At()?(e=t+"main",[4,du.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(eh(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._delegate)},Fg),Rg=(a(Mg,Cg=od),Object.defineProperty(Mg.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),Mg.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._delegate._getSettings()),t)).merge,this._delegate._setSettings(t)},Mg.prototype.useEmulator=function(t,e){var n,r;r=t,t=e,"firestore.googleapis.com"!==(e=(n=td(n=this._delegate,id))._getSettings()).host&&e.host!==r&&xr("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},e),{host:r+":"+t,ssl:!1}))},Mg.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return u(e,void 0,void 0,(function(){var e,n;return c(this,(function(r){switch(r.label){case 0:return[4,Np(t)];case 1:return e=r.sent(),[4,kp(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),(i=n).Qr.delete(0),ql(i))]}var i}))}))}))}(Dd(td(this._delegate,Id)))},Mg.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return u(e,void 0,void 0,(function(){var e,n;return c(this,(function(r){switch(r.label){case 0:return[4,Np(t)];case 1:return e=r.sent(),[4,kp(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return u(this,void 0,void 0,(function(){var e;return c(this,(function(n){switch(n.label){case 0:return(e=t).Qr.add(0),[4,Ul(e)];case 1:return n.sent(),e.jr.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(Dd(td(this._delegate,Id)))},Mg.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Xp("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.na.enableMultiTabIndexedDbPersistence(this):this.na.enableIndexedDbPersistence(this,n)},Mg.prototype.clearPersistence=function(){return this.na.clearIndexedDbPersistence(this)},Mg.prototype.terminate=function(){return this.sa&&(this.sa._removeServiceInstance("firestore"),this.sa._removeServiceInstance("firestore-exp")),this._delegate._delete()},Mg.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new lu;return t.asyncQueue.enqueueAndForget((function(){return u(e,void 0,void 0,(function(){var e;return c(this,(function(r){switch(r.label){case 0:return e=jf,[4,Op(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(Dd(td(this._delegate,Id)))},Mg.prototype.onSnapshotsInSync=function(t){return t=t,function(t,e){var n=this,r=new dp(e);return t.asyncQueue.enqueueAndForget((function(){return u(n,void 0,void 0,(function(){var e;return c(this,(function(n){switch(n.label){case 0:return e=function(t,e){t.Zr.add(e),e.next()},[4,xp(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.Xo(),t.asyncQueue.enqueueAndForget((function(){return u(n,void 0,void 0,(function(){var e;return c(this,(function(n){switch(n.label){case 0:return e=function(t,e){t.Zr.delete(e)},[4,xp(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(Dd(td(this._delegate,Id)),wd(t)?t:{next:t})},Object.defineProperty(Mg.prototype,"app",{get:function(){if(!this.sa)throw new Jr(Xr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.sa},enumerable:!1,configurable:!0}),Mg.prototype.collection=function(t){try{return new pv(this,dd(this._delegate,t))}catch(t){throw Jg(t,"collection()","Firestore.collection()")}},Mg.prototype.doc=function(t){try{return new Yg(this,yd(this._delegate,t))}catch(t){throw Jg(t,"doc()","Firestore.doc()")}},Mg.prototype.collectionGroup=function(t){try{return new hv(this,function(t,e){if(t=td(t,id),Wp("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new Jr(Xr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new ad(t,null,(e=e,new wo($r.emptyPath(),e)))}(this._delegate,t))}catch(t){throw Jg(t,"collectionGroup()","Firestore.collectionGroup()")}},Mg.prototype.runTransaction=function(t){var e,n=this;return function(t,e){var n=this,r=new lu;return t.asyncQueue.enqueueAndForget((function(){return u(n,void 0,void 0,(function(){var n;return c(this,(function(i){switch(i.label){case 0:return[4,Ap(t).then((function(t){return t.datastore}))];case 1:return n=i.sent(),new vp(t.asyncQueue,n,e,r).run(),[2]}}))}))})),r.promise}(Dd(e=this._delegate),(function(r){return r=new Ig(e,r),t(new Bg(n,r))}))},Mg.prototype.batch=function(){var t=this;return Dd(this._delegate),new Gg(new lg(this._delegate,(function(e){return wg(t._delegate,e)})))},Mg.prototype.loadBundle=function(t){throw new Jr(Xr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},Mg.prototype.namedQuery=function(t){throw new Jr(Xr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},Mg),Lg=(a(Pg,Ng=Se),Pg.prototype.convertBytes=function(t){return new Og(new Od(t))},Pg.prototype.convertReference=function(t){return t=this.convertDocumentKey(t,this.firestore._databaseId),Yg.ia(t,this.firestore,null)},Pg);function Pg(t){var e=this;return(e=Ng.call(this)||this).firestore=t,e}function Mg(t,e,n){var r=this;return(r=Cg.call(this,e)||this).na=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof Fp||(r.sa=t),r}function Fg(){}function Vg(){return null!==kg&&kg.apply(this,arguments)||this}var qg,Ug,jg,Bg=(a(Qg,jg=od),Qg.prototype.get=function(t){var e=this,n=wv(t);return this._delegate.get(n).then((function(t){return new uv(e._firestore,new xy(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n._converter))}))},Qg.prototype.set=function(t,e,n){return t=wv(t),n?(Yp("Transaction.set",n),this._delegate.set(t,e,n)):this._delegate.set(t,e),this},Qg.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=wv(t);return 2===arguments.length?this._delegate.update(o,e):(t=this._delegate).update.apply(t,h([o,e,n],r)),this},Qg.prototype.delete=function(t){return t=wv(t),this._delegate.delete(t),this},Qg),Gg=(a(Hg,Ug=od),Hg.prototype.set=function(t,e,n){return t=wv(t),n?(Yp("WriteBatch.set",n),this._delegate.set(t,e,n)):this._delegate.set(t,e),this},Hg.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=wv(t);return 2===arguments.length?this._delegate.update(o,e):(t=this._delegate).update.apply(t,h([o,e,n],r)),this},Hg.prototype.delete=function(t){return t=wv(t),this._delegate.delete(t),this},Hg.prototype.commit=function(){return this._delegate.commit()},Hg),Kg=(a(zg,qg=od),zg.prototype.fromFirestore=function(t,e){return t=new Ry(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null),this._delegate.fromFirestore(new cv(this._firestore,t),null!=e?e:{})},zg.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},zg.ra=function(t,e){var n=zg.oa,r=n.get(t);return r||(r=new WeakMap,n.set(t,r)),(n=r.get(e))||(n=new zg(t,new Lg(t),e),r.set(e,n)),n},zg);function zg(t,e,n){var r=this;return(r=qg.call(this,n)||this)._firestore=t,r._userDataWriter=e,r}function Hg(){return null!==Ug&&Ug.apply(this,arguments)||this}function Qg(t,e){var n=this;return(n=jg.call(this,e)||this)._firestore=t,n._userDataWriter=new Lg(t),n}Kg.oa=new WeakMap;var Wg,Yg=(a(Xg,Wg=od),Xg.ca=function(t,e,n){if(t.length%2!=0)throw new Jr(Xr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.canonicalString()+" has "+t.length);return new Xg(e,new sd(e._delegate,n,new ei(t)))},Xg.ia=function(t,e,n){return new Xg(e,new sd(e._delegate,n,t))},Object.defineProperty(Xg.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(Xg.prototype,"parent",{get:function(){return new pv(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(Xg.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Xg.prototype.collection=function(t){try{return new pv(this.firestore,dd(this._delegate,t))}catch(t){throw Jg(t,"collection()","DocumentReference.collection()")}},Xg.prototype.isEqual=function(t){return(t=t instanceof od?t._delegate:t)instanceof sd&&gd(this._delegate,t)},Xg.prototype.set=function(t,e){e=Yp("DocumentReference.set",e);try{return function(t,e,n){t=td(t,sd);var r=td(t.firestore,Id);return e=ug(t._converter,e,n),wg(r,[Wd(Qd(r),"setDoc",t._key,e,null!==t._converter,n).toMutation(t._key,fs.none())])}(this._delegate,t,e)}catch(t){throw Jg(t,"setDoc()","DocumentReference.set()")}},Xg.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?mg(this._delegate,t):mg.apply(void 0,h([this._delegate,t,e],n))}catch(t){throw Jg(t,"updateDoc()","DocumentReference.update()")}},Xg.prototype.delete=function(){return wg(td((t=this._delegate).firestore,Id),[new xs(t._key,fs.none())]);var t},Xg.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=$g(e),i=Zg(e,(function(e){return new uv(t.firestore,new xy(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate._converter))}));return bg(this._delegate,r,i)},Xg.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=td(t,sd);var e=td(t.firestore,Id),n=Dd(e),r=new gg(e);return function(t,e){var n=this,r=new lu;return t.asyncQueue.enqueueAndForget((function(){return u(n,void 0,void 0,(function(){var n;return c(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return u(this,void 0,void 0,(function(){var r,i;return c(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,(s=e,(a=t).persistence.runTransaction("read document","readonly",(function(t){return a.Kn.In(t,s)})))];case 1:return(i=o.sent())instanceof xi?n.resolve(i):i instanceof Ri?n.resolve(null):n.reject(new Jr(Xr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=af(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}var s,a}))}))},[4,Cp(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._key).then((function(n){return new xy(e,r,t._key,n,new Oy(n instanceof xi&&n.hasLocalMutations,!0),t._converter)}))}:"server"===(null==t?void 0:t.source)?function(t){t=td(t,sd);var e=td(t.firestore,Id);return Rp(Dd(e),t._key,{source:"server"}).then((function(n){return Eg(e,t,n)}))}:function(t){t=td(t,sd);var e=td(t.firestore,Id);return Rp(Dd(e),t._key).then((function(n){return Eg(e,t,n)}))})(this._delegate).then((function(t){return new uv(e.firestore,new xy(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate._converter))}))},Xg.prototype.withConverter=function(t){return new Xg(this.firestore,t?this._delegate.withConverter(Kg.ra(this.firestore,t)):this._delegate.withConverter(null))},Xg);function Xg(t,e){var n=this;return(n=Wg.call(this,e)||this).firestore=t,n._userDataWriter=new Lg(t),n}function Jg(t,e,n){return t.message=t.message.replace(e,n),t}function $g(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!wd(r))return r}return{}}function Zg(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=wd(t[0])?t[0]:wd(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var tv,ev,nv,rv,iv,ov,sv,av,uv=(a(bv,ov=od),Object.defineProperty(bv.prototype,"ref",{get:function(){return new Yg(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(bv.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(bv.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(bv.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),bv.prototype.data=function(t){return this._delegate.data(t)},bv.prototype.get=function(t,e){return this._delegate.get(t,e)},bv.prototype.isEqual=function(t){return qy(this._delegate,t._delegate)},bv),cv=(a(mv,iv=uv),mv.prototype.data=function(t){return this._delegate.data(t)},mv),hv=(a(vv,rv=od),vv.prototype.where=function(t,e,n){try{return new vv(this.firestore,jy(this._delegate,(r=n,i=e,o=Ny("where",t),new Qy(o,i,r))))}catch(t){throw Jg(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},vv.prototype.orderBy=function(t,e){try{return new vv(this.firestore,jy(this._delegate,(n=void 0===e?"asc":e,r=Ny("orderBy",t),new Wy(r,n))))}catch(t){throw Jg(t,/(orderBy|where)\(\)/,"Query.$1()")}var n,r},vv.prototype.limit=function(t){try{return new vv(this.firestore,jy(this._delegate,(ed("limit",e=t),new Yy("limit",e,"F"))))}catch(t){throw Jg(t,"limit()","Query.limit()")}var e},vv.prototype.limitToLast=function(t){try{return new vv(this.firestore,jy(this._delegate,(ed("limitToLast",e=t),new Yy("limitToLast",e,"L"))))}catch(t){throw Jg(t,"limitToLast()","Query.limitToLast()")}var e},vv.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new vv(this.firestore,jy(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Xy("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Jg(t,"startAt()","Query.startAt()")}},vv.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new vv(this.firestore,jy(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Xy("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Jg(t,"startAfter()","Query.startAfter()")}},vv.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new vv(this.firestore,jy(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Jy("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Jg(t,"endBefore()","Query.endBefore()")}},vv.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new vv(this.firestore,jy(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Jy("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Jg(t,"endAt()","Query.endAt()")}},vv.prototype.isEqual=function(t){return vd(this._delegate,t._delegate)},vv.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=td(t,ad);var e=td(t.firestore,Id),n=Dd(e),r=new gg(e);return function(t,e){var n=this,r=new lu;return t.asyncQueue.enqueueAndForget((function(){return u(n,void 0,void 0,(function(){var n;return c(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return u(this,void 0,void 0,(function(){var r,i,o;return c(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,bh(t,e,!0)];case 1:return o=s.sent(),r=new kf(e,o.jn),i=r.Io(o.documents),i=r.applyChanges(i,!1),n.resolve(i.snapshot),[3,3];case 2:return i=s.sent(),o=af(i,"Failed to execute query '"+e+" against cache"),n.reject(o),[3,3];case 3:return[2]}}))}))},[4,Cp(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._query).then((function(n){return new Ly(e,r,t,n)}))}:"server"===(null==t?void 0:t.source)?function(t){t=td(t,ad);var e=td(t.firestore,Id),n=Dd(e),r=new gg(e);return Lp(n,t._query,{source:"server"}).then((function(n){return new Ly(e,r,t,n)}))}:function(t){t=td(t,ad);var e=td(t.firestore,Id),n=Dd(e),r=new gg(e);return Uy(t._query),Lp(n,t._query).then((function(n){return new Ly(e,r,t,n)}))})(this._delegate).then((function(t){return new fv(e.firestore,new Ly(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}))},vv.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=$g(e),i=Zg(e,(function(e){return new fv(t.firestore,new Ly(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}));return bg(this._delegate,r,i)},vv.prototype.withConverter=function(t){return new vv(this.firestore,t?this._delegate.withConverter(Kg.ra(this.firestore,t)):this._delegate.withConverter(null))},vv),lv=(a(gv,nv=od),Object.defineProperty(gv.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(gv.prototype,"doc",{get:function(){return new cv(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(gv.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(gv.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),gv),fv=(a(yv,ev=od),Object.defineProperty(yv.prototype,"query",{get:function(){return new hv(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(yv.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(yv.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(yv.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(yv.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map((function(e){return new cv(t._firestore,e)}))},enumerable:!1,configurable:!0}),yv.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map((function(t){return new lv(e._firestore,t)}))},yv.prototype.forEach=function(t,e){var n=this;this._delegate.forEach((function(r){t.call(e,new cv(n._firestore,r))}))},yv.prototype.isEqual=function(t){return qy(this._delegate,t._delegate)},yv),pv=(a(dv,tv=hv),Object.defineProperty(dv.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(dv.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(dv.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new Yg(this.firestore,t):null},enumerable:!1,configurable:!0}),dv.prototype.doc=function(t){try{return new Yg(this.firestore,void 0===t?yd(this._delegate):yd(this._delegate,t))}catch(t){throw Jg(t,"doc()","CollectionReference.doc()")}},dv.prototype.add=function(t){var e,n,r,i=this;return n=t,t=td((e=this._delegate).firestore,Id),r=yd(e),n=ug(e._converter,n),wg(t,[Wd(Qd(e.firestore),"addDoc",r._key,n,null!==e._converter,{}).toMutation(r._key,fs.exists(!1))]).then((function(){return r})).then((function(t){return new Yg(i.firestore,t)}))},dv.prototype.isEqual=function(t){return gd(this._delegate,t._delegate)},dv.prototype.withConverter=function(t){return new dv(this.firestore,t?this._delegate.withConverter(Kg.ra(this.firestore,t)):this._delegate.withConverter(null))},dv);function dv(t,e){var n=this;return(n=tv.call(this,t,e)||this).firestore=t,n._delegate=e,n}function yv(t,e){var n=this;return(n=ev.call(this,e)||this)._firestore=t,n}function gv(t,e){var n=this;return(n=nv.call(this,e)||this)._firestore=t,n}function vv(t,e){var n=this;return(n=rv.call(this,e)||this).firestore=t,n._userDataWriter=new Lg(t),n}function mv(){return null!==iv&&iv.apply(this,arguments)||this}function bv(t,e){var n=this;return(n=ov.call(this,e)||this)._firestore=t,n}function wv(t){return td(t=t instanceof od?t._delegate:t,sd)}function Ev(){return null!==sv&&sv.apply(this,arguments)||this}function _v(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return av.call(this,new(kd.bind.apply(kd,h([void 0],t))))||this}function Iv(t){return e=this._delegate,n=t,r=Dd(e=td(e,Id)),t=new _d,function(t,e,r){var i,o=this,s=(i=n,e=Il(e),i=function(t){if(t instanceof Uint8Array)return pp(t,void 0);if(t instanceof ArrayBuffer)return pp(new Uint8Array(t),void 0);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof i?(new TextEncoder).encode(i):i),new yp(i,e));t.asyncQueue.enqueueAndForget((function(){return u(o,void 0,void 0,(function(){var e;return c(this,(function(n){switch(n.label){case 0:return e=np,[4,Op(t)];case 1:return e.apply(void 0,[n.sent(),s,r]),[2]}}))}))}))}(r,e._databaseId,t),t;var e,n,r}function Tv(t){var e=this,n=this._delegate;return t=t,function(t,e){var n=this;return t.asyncQueue.enqueue((function(){return u(n,void 0,void 0,(function(){var n;return c(this,(function(r){switch(r.label){case 0:return n=function(t,e){var n=t;return n.persistence.runTransaction("Get named query","readonly",(function(t){return n.He.getNamedQuery(t,e)}))},[4,Cp(t)];case 1:return[2,n.apply(void 0,[r.sent(),e])]}}))}))}))}(Dd(n=td(n,Id)),t).then((function(t){return t?new ad(n,null,t.query):null})).then((function(t){return t?new hv(e,t):null}))}a(_v,av=od),_v.documentId=function(){return new _v(ti.keyField().canonicalString())},_v.prototype.isEqual=function(t){return(t=t instanceof od?t._delegate:t)instanceof kd&&this._delegate._internalPath.isEqual(t._internalPath)},y=_v,a(Ev,sv=od),Ev.serverTimestamp=function(){var t=new ry("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new Ev(t)},Ev.delete=function(){var t=new Xd("deleteField");return t._methodName="FieldValue.delete",new Ev(t)},Ev.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new iy("arrayUnion",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayUnion",new Ev(n)},Ev.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new oy("arrayRemove",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayRemove",new Ev(n)},Ev.increment=function(t){return(t=new sy("increment",t))._methodName="FieldValue.increment",new Ev(t)},Ev.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},Se=Ev;var Sv=(Dv.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Dv.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Dv.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Dv);function Dv(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Av,Nv,Cv={Firestore:Rg,GeoPoint:Rd,Timestamp:pi,Blob:Og,Transaction:Bg,WriteBatch:Gg,DocumentReference:Yg,DocumentSnapshot:uv,Query:hv,QueryDocumentSnapshot:cv,QuerySnapshot:fv,CollectionReference:pv,FieldPath:y,FieldValue:Se,setLogLevel:function(t){Nr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(Av=o.default).INTERNAL.registerComponent(new Sv("firestore",(function(t){var e=t.getProvider("app").getImmediate();return e=e,t=t.getProvider("auth-internal"),new Rg(e,new Id(e,t),new xg)}),"PUBLIC").setServiceProps(Object.assign({},Cv))),Av.registerVersion("@firebase/firestore","2.2.1"),(Nv=Rg).prototype.loadBundle=Iv,Nv.prototype.namedQuery=Tv}).apply(this,arguments)}catch(r){throw console.error(r),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}}(n(586))}).call(this,n(82),n(144))},952:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function i(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}Object.create;Object.create}}]);
//# sourceMappingURL=7.92cb9094.chunk.js.map