(this["webpackJsonpshlok-zanwar"]=this["webpackJsonpshlok-zanwar"]||[]).push([[28],{1134:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return W}));var n=a(2),s=a(128),c=a(401),i=a.n(c),r=a(697),o=a(444),l=a(21),d=a(26),u=a(525),p=a(399),j=a(1135),b=a(1113),f=a(527),x=a(1123),O=a(1094),h=a(1124),g=a(1136),m=a(490),w=a(1131),y=a(134),v=a.n(y),k=a(1),S=a.n(k),T=a(180),P=a(9),C=function(e){var t=e.label,a=e.children,s=e.isInline,c=void 0!==s&&s,i=e.labelWidth,o=void 0===i?"auto":i,l=e.divStyle,d=void 0===l?{}:l;return Object(n.jsxs)("div",{style:Object(r.a)({display:"inline-flex",flexDirection:c?"row":"column",alignItems:c?"center":"flex-start",width:"100%"},d),children:[Object(n.jsx)("label",{style:{color:"var(--inputLabelColor)",fontWeight:"bold",marginRight:"10px",width:o,display:"inline-flex",alignItems:"center",justifyContent:"space-between"},children:t}),a]})},_=a(391),A=a.n(_),D=a(98),I=a(121),M=a(1125),E=a(133),Y=u.a.RangePicker;function W(){var e,t=Object(P.i)().id;document.title="Expense tracker | Shlok Zanwar";var a=S.a.useState(!0),c=Object(d.a)(a,2),u=c[0],O=c[1],h=S.a.useState({id:t,password:localStorage.expenseTrackerPasswords&&JSON.parse(localStorage.expenseTrackerPasswords)[t]||"",is_protected:!1,isAuthenticated:!1,isProtected:!1,changePasswordOpen:!1}),g=Object(d.a)(h,2),m=g[0],w=g[1],y=S.a.useState((e={transactionId:null,title:"",description:"",amount:0,tags:[],timestamp:A()().unix()},Object(l.a)(e,"tags",[]),Object(l.a)(e,"editOpen",!1),e)),_=Object(d.a)(y,2),I=_[0],M=_[1],W=S.a.useState([A()().subtract(7,"days").startOf("day"),A()().endOf("day")]),J=Object(d.a)(W,2),B=J[0],q=J[1],z=S.a.useState([]),R=Object(d.a)(z,2),U=R[0],H=R[1],Z=S.a.useState([]),K=Object(d.a)(Z,2),Q=K[0],V=K[1],X=S.a.useState({}),$=Object(d.a)(X,2),ee=$[0],te=$[1],ae=S.a.useState([]),ne=Object(d.a)(ae,2),se=ne[0],ce=ne[1],ie=S.a.useState(""),re=Object(d.a)(ie,2),oe=re[0],le=re[1],de=S.a.useState([]),ue=Object(d.a)(de,2),pe=ue[0],je=ue[1],be=S.a.useState("all"),fe=Object(d.a)(be,2),xe=fe[0],Oe=fe[1],he=function(){var e=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(!0),e.next=3,v.a.post("/ep_tracker/login",{route_name:m.id,password:m.password}).then((function(e){w(Object(r.a)(Object(r.a)({},m),{},{isAuthenticated:!0,isProtected:e.data.is_protected,changePasswordOpen:!1}))})).catch((function(e){console.log(e),404===e.request.status?w(Object(r.a)(Object(r.a)({},m),{},{isAuthenticated:!0,password:"",isProtected:!1})):401===e.request.status&&w(Object(r.a)(Object(r.a)({},m),{},{isAuthenticated:!1,isProtected:!0}))}));case 3:O(!1);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(k.useEffect)((function(){he(),localStorage.setItem("lastUsedExpenseTracker",t)}),[t]);var ge=function(){var e=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.get("/ep_tracker/get_tags",{params:{route_name:m.id}}).then((function(e){V(e.data.tags);var t,a=Object(r.a)({},ee),n=Object(s.a)(e.data.tags);try{for(n.s();!(t=n.n()).done;){var c=t.value;a[c.key]=c}}catch(i){n.e(i)}finally{n.f()}te(a)})).catch((function(e){console.log(e)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),me=function(){var e=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.get("/ep_tracker/get_transactions",{params:{route_name:m.id,start_time:B[0].startOf("day").unix(),end_time:B[1].endOf("day").unix()}}).then((function(e){var t=e.data.transactions.sort((function(e,t){return t.timestamp-e.timestamp}));H(t)})).catch((function(e){console.log(e)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(k.useEffect)((function(){m.isAuthenticated&&!I.editOpen&&me()}),[B,I.editOpen,m.isAuthenticated]),Object(k.useEffect)((function(){m.isAuthenticated&&ge()}),[m.isAuthenticated]);return Object(k.useEffect)((function(){ce(U.filter((function(e){if("expense"===xe&&e.amount>0)return!1;if("income"===xe&&e.amount<0)return!1;if(oe.length>0&&-1===e.title.toLowerCase().indexOf(oe.toLowerCase())&&-1===e.description.toLowerCase().indexOf(oe.toLowerCase()))return!1;if(pe.length>0){var t,a=Object(s.a)(e.tags);try{for(a.s();!(t=a.n()).done;){var n=t.value;if(-1!==pe.indexOf(n))return!0}}catch(c){a.e(c)}finally{a.f()}return!1}return!0})))}),[Q,U,oe,pe,xe]),Object(n.jsxs)("div",{style:{padding:"10px",paddingBottom:"300px"},children:[Object(n.jsx)(T.a,{children:Object(n.jsx)("style",{children:"            \n                    body {\n                        text-align: center;\n                        background-color: #161a2b;\n                        background-image: none;\n                    }\n\n                    ::selection {\n                        background: rgba(0, 0, 0, 0.489);\n                    }\n                "})}),u?Object(n.jsx)(E.SemipolarLoading,{size:"large",color:"rgba(255, 84, 17, 1)"}):m.isAuthenticated?Object(n.jsxs)("div",{style:{width:"100%",display:"inline-flex",flexDirection:"column",maxWidth:"600px",rowGap:"10px"},children:[m.changePasswordOpen&&Object(n.jsx)(N,{userDetails:m,setUserDetails:w}),I.editOpen&&Object(n.jsx)(G,{userDetails:m,editTransaction:I,setEditTransaction:M,tags:Q,setTags:V,getTags:ge}),Object(n.jsxs)("h3",{style:{color:"#fff"},children:["ID : ",m.id," | ",m.isProtected?"Protected":"Public"]}),Object(n.jsxs)("div",{style:{display:"inline-flex",columnGap:"10px",width:"100%",justifyContent:"space-between",color:"#fff",alignItems:"flex-end"},children:[Object(n.jsx)(C,{label:"Select Date Range",children:Object(n.jsx)(Y,{value:B,onChange:function(e){q(e)},format:"MMM Do, YYYY",allowClear:!1})}),Object(n.jsx)(p.a,{type:"primary",icon:Object(n.jsx)(D.g,{}),onClick:function(){w(Object(r.a)(Object(r.a)({},m),{},{changePasswordOpen:!0}))}}),Object(n.jsx)(j.a,{title:"Are you sure you want to logout?",onConfirm:function(){localStorage.removeItem("lastUsedExpenseTracker"),window.location.pathname="/apps/expense-tracker"},okText:"Yes",cancelText:"No",children:Object(n.jsx)(p.a,{type:"danger",icon:Object(n.jsx)(D.d,{})})})]}),Object(n.jsx)(b.a,{style:{background:"#fff"}}),Object(n.jsxs)("div",{style:{display:"inline-flex",flexDirection:"row",width:"100%",columnGap:"10px",color:"#fff",alignItems:"flex-start",marginTop:"0px",justifyContent:"space-between"},children:[Object(n.jsx)(C,{label:"Type",divStyle:{width:"auto"},children:Object(n.jsxs)(f.a,{style:{width:"100px"},placeholder:"Select Type",value:xe,onChange:function(e){Oe(e)},children:[Object(n.jsx)(f.a.Option,{value:"all",children:"All"}),Object(n.jsx)(f.a.Option,{value:"expense",children:"Expense"}),Object(n.jsx)(f.a.Option,{value:"income",children:"Income"})]})}),Object(n.jsx)(C,{label:"Search",divStyle:{width:"100%"},children:Object(n.jsx)(x.a,{placeholder:"Search",value:oe,onChange:function(e){le(e.target.value)},style:{width:"100%"}})})]}),Object(n.jsx)("div",{style:{display:"inline-flex",flexDirection:"row",width:"100%",rowGap:"10px",columnGap:"10px",color:"#fff",alignItems:"flex-start",marginTop:"10px",justifyContent:"space-between",flexFlow:"wrap"},children:Object(n.jsx)(C,{label:"Filter by Tags",children:Object(n.jsx)(f.a,{mode:"multiple",style:{width:"100%",minWidth:"200px"},placeholder:"Select Tags",value:pe,onChange:function(e){je(e)},showSearch:!0,filterOption:function(e,t){return t.name.toLowerCase().indexOf(e.toLowerCase())>=0},children:Q.map((function(e){return Object(n.jsx)(f.a.Option,{value:e.key,name:e.tag,children:e.tag},e.key)}))})})}),Object(n.jsxs)("div",{style:{marginTop:"50px",color:"#fff",fontSize:"18px",display:"inline-flex",justifyContent:"space-between",alignItems:"flex-end"},children:[Object(n.jsxs)("div",{style:{display:"inline-flex",flexDirection:"column",textAlign:"left"},children:[Object(n.jsxs)("div",{children:[Object(n.jsx)("div",{style:{display:"inline-flex",minWidth:"150px"},children:"Amount Received"}),Object(n.jsx)("span",{style:{color:"rgb(69, 163, 25)"},children:se.reduce((function(e,t){return t.amount>0?e+t.amount:e}),0)})]}),Object(n.jsxs)("div",{children:[Object(n.jsx)("div",{style:{display:"inline-flex",minWidth:"150px"},children:"Amount Spent"}),Object(n.jsx)("span",{style:{color:"rgb(255, 20, 79)"},children:Math.abs(se.reduce((function(e,t){return t.amount<0?e+t.amount:e}),0))})]})]}),Object(n.jsx)(p.a,{type:"primary",icon:Object(n.jsx)(D.a,{}),onClick:function(){var e;M((e={transactionId:null,title:"",description:"",amount:0,tags:[],timestamp:A()().unix()},Object(l.a)(e,"tags",[]),Object(l.a)(e,"editOpen",!0),e))},children:"Add"})]}),Object(n.jsx)("div",{style:{marginTop:"10px",maxHeight:"400px",overflow:"auto"},children:se.map((function(e,t){return Object(n.jsx)(F,{transaction:e,userDetails:m,editTransaction:I,setEditTransaction:M,tagsMap:ee,getTags:ge},t)}))}),Object(n.jsx)(b.a,{style:{background:"#fff",marginTop:"50px"}}),Object(n.jsx)("div",{style:{marginTop:"0px"},children:Object(n.jsx)(L,{tags:Q,tagsMap:ee,filteredTransactions:se})})]}):Object(n.jsx)(N,{userDetails:m,setUserDetails:w})]})}function N(e){var t=e.userDetails,a=e.setUserDetails,s=Object(k.useState)(!1),c=Object(d.a)(s,2),l=c[0],u=c[1],p=Object(k.useState)(Object(r.a)({},t)),j=Object(d.a)(p,2),b=j[0],f=j[1],m=Object(I.b)().enqueueSnackbar,w=function(){var e=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!b.isProtected||""!==b.password.trim()){e.next=3;break}return m("Please enter a password",{variant:"error"}),e.abrupt("return");case 3:if(u(!0),t.isAuthenticated||!b.isProtected){e.next=9;break}return e.next=7,v.a.post("/ep_tracker/login",{route_name:t.id,password:b.password}).then((function(e){a(Object(r.a)(Object(r.a)({},t),{},{isAuthenticated:!0,isProtected:e.data.is_protected,changePasswordOpen:!1}));var n=localStorage.expenseTrackerPasswords?JSON.parse(localStorage.expenseTrackerPasswords):{};n[t.id]=b.password,localStorage.setItem("expenseTrackerPasswords",JSON.stringify(n))})).catch((function(e){console.log("err",e.request.status),404===e.request.status?a(Object(r.a)(Object(r.a)({},t),{},{isAuthenticated:!1,password:"",isProtected:!1})):401===e.request.status&&m("Incorrect password",{variant:"error"})}));case 7:e.next=11;break;case 9:return e.next=11,v.a.post("/ep_tracker/change-password",{route_name:t.id,is_protected:b.isProtected,password:localStorage.expenseTrackerPasswords?JSON.parse(localStorage.expenseTrackerPasswords)[t.id]:"",new_password:b.password}).then((function(e){a(Object(r.a)(Object(r.a)({},t),{},{changePasswordOpen:!1,isAuthenticated:!0,isProtected:b.isProtected,password:b.password}));var n=localStorage.expenseTrackerPasswords?JSON.parse(localStorage.expenseTrackerPasswords):{};n[t.id]=b.password,localStorage.setItem("expenseTrackerPasswords",JSON.stringify(n))})).catch((function(e){O.b.error("Error changing password")}));case 11:u(!1);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.jsx)(h.a,{title:"Login",visible:!0,okButtonProps:{disabled:l,loading:l},okText:"Save",onOk:function(){w()},cancelButtonProps:{disabled:l||!t.isAuthenticated,loading:l},cancelText:"Cancel",onCancel:function(){t.isAuthenticated&&a(Object(r.a)(Object(r.a)({},t),{},{changePasswordOpen:!1}))},children:Object(n.jsxs)("div",{style:{display:"inline-flex",flexFlow:"wrap",columnGap:"10px"},children:[(!t.isProtected||t.isAuthenticated)&&Object(n.jsx)(C,{label:"Is Protected",children:Object(n.jsx)(g.a,{checked:b.isProtected,onChange:function(e){f(Object(r.a)(Object(r.a)({},b),{},{isProtected:e}))}})}),Object(n.jsx)(C,{label:t.isAuthenticated?"New Password":"Password",isInline:!1,children:Object(n.jsx)(x.a.Password,{placeholder:"Password",value:b.password,onChange:function(e){f(Object(r.a)(Object(r.a)({},b),{},{password:e.target.value}))}})})]})})}function F(e){var t=e.transaction,a=(e.userDetails,e.editTransaction),s=e.setEditTransaction,c=e.tagsMap,i=S.a.useState(!0),o=Object(d.a)(i,2);o[0],o[1];return Object(n.jsxs)("div",{style:{display:"inline-flex",border:"1px solid #fff",color:"#fff",padding:"10px",width:"100%",maxWidth:"600px"},onDoubleClick:function(){s(Object(r.a)(Object(r.a)({},a),{},{transactionId:t.key,title:t.title,description:t.description,amount:t.amount,tags:t.tags,timestamp:t.timestamp,editOpen:!0}))},children:[Object(n.jsxs)("div",{style:{display:"inline-flex",width:"100%",justifyContent:"space-between",alignItems:"flex-end",wordBreak:"break-all"},children:[Object(n.jsxs)("div",{style:{display:"inline-flex",flexDirection:"column",textAlign:"left",width:"100%"},children:[Object(n.jsx)("span",{style:{fontSize:"20px"},children:t.title}),Object(n.jsx)("span",{children:t.description}),Object(n.jsx)("div",{style:{display:"inline-flex",width:"100%",flexFlow:"wrap"},children:t.tags.map((function(e,t){var a;return Object(n.jsx)(m.a,{color:"green",closable:!1,style:{marginRight:3,marginBottom:3},children:null===(a=c[e])||void 0===a?void 0:a.tag})}))})]}),Object(n.jsxs)("div",{style:{display:"inline-flex",flexDirection:"column",textAlign:"right",width:"100%"},children:[Object(n.jsx)("span",{style:{color:t.amount>0?"rgb(69, 163, 25)":"rgb(255, 20, 79)",fontSize:"25px"},children:Math.abs(t.amount)}),Object(n.jsx)("span",{children:A.a.unix(t.timestamp).format("MMM DD, YYYY [at] hh:mm a")})]})]}),Object(n.jsx)("div",{})]})}function G(e){var t=e.userDetails,a=e.editTransaction,s=e.setEditTransaction,c=e.tags,l=(e.setTags,e.getTags),O=Object(k.useState)(!1),g=Object(d.a)(O,2),m=g[0],y=g[1],T=Object(k.useState)(a.amount<=0?"expense":"income"),P=Object(d.a)(T,2),_=P[0],D=P[1];Object(k.useEffect)((function(){s(Object(r.a)(Object(r.a)({},a),{},{amount:Math.abs(a.amount)}))}),[]);var I=function(){var e=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y(!0),a.transactionId){e.next=6;break}return e.next=4,v.a.post("/ep_tracker/add_transaction",{route_name:t.id,password:t.password,transaction_id:a.transactionId||"New",title:a.title,description:a.description,amount:("expense"===_?-1:1)*parseInt(a.amount),timestamp:a.timestamp,tags:a.tags}).then((function(e){s(Object(r.a)(Object(r.a)({},a),{},{editOpen:!1}))})).catch((function(e){console.log(e)}));case 4:e.next=8;break;case 6:return e.next=8,v.a.post("/ep_tracker/edit_transaction",{route_name:t.id,password:t.password,transaction_id:a.transactionId||"New",title:a.title,description:a.description,amount:("expense"===_?-1:1)*parseInt(a.amount),timestamp:a.timestamp,tags:a.tags}).then((function(e){s(Object(r.a)(Object(r.a)({},a),{},{editOpen:!1}))})).catch((function(e){console.log(e)}));case 8:y(!1);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){s(Object(r.a)(Object(r.a)({},a),{},{editOpen:!1}))},E=S.a.useState(!1),Y=Object(d.a)(E,2),W=(Y[0],Y[1]),N=S.a.useState(""),F=Object(d.a)(N,2),G=F[0],L=F[1],J=function(){var e=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return W(!0),e.next=3,v.a.post("/ep_tracker/create_tag",{route_name:t.id,password:t.password,tag_id:G,tag:G}).then((function(e){l(),L("")})).catch((function(e){console.log(e)}));case 3:W(!1);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.jsx)(h.a,{title:"".concat(a.transactionId?"Edit":"Add"," Transaction"),visible:!0,onCancel:function(){M()},footer:[Object(n.jsx)(p.a,{disabled:m,loading:m,onClick:function(){M()},children:"Cancel"},"back"),a.transactionId&&Object(n.jsx)(j.a,{title:"Are you sure you want to delete this transaction?",onConfirm:Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y(!0),e.next=3,v.a.get("/ep_tracker/delete_transaction",{params:{route_name:t.id,password:t.password,transaction_id:a.transactionId}}).then((function(e){s(Object(r.a)(Object(r.a)({},a),{},{editOpen:!1}))})).catch((function(e){console.log(e)}));case 3:y(!1);case 4:case"end":return e.stop()}}),e)}))),okText:"Yes",cancelText:"No",children:Object(n.jsx)(p.a,{disabled:m,loading:m,type:"danger",children:"Delete"},"delete")}),Object(n.jsx)(p.a,{type:"primary",loading:m,onClick:function(){I()},children:"Save"},"submit")],children:Object(n.jsxs)("div",{style:{display:"inline-flex",flexDirection:"column",flexFlow:"wrap",rowGap:"20px",width:"100%"},children:[Object(n.jsx)(C,{label:"Title",children:Object(n.jsx)(x.a,{placeholder:"Title",value:a.title,onChange:function(e){s(Object(r.a)(Object(r.a)({},a),{},{title:e.target.value}))},disabled:m})}),Object(n.jsx)(C,{label:"Description",children:Object(n.jsx)(x.a.TextArea,{placeholder:"Description",value:a.description,onChange:function(e){s(Object(r.a)(Object(r.a)({},a),{},{description:e.target.value}))},disabled:m})}),Object(n.jsxs)("div",{style:{display:"inline-flex",columnGap:"10px"},children:[Object(n.jsx)(C,{label:"Transaction Type",children:Object(n.jsxs)(f.a,{placeholder:"Type",value:_,onChange:function(e){D(e)},disabled:m,children:[Object(n.jsx)(f.a.Option,{value:"expense",children:"Expense"}),Object(n.jsx)(f.a.Option,{value:"income",children:"Income"})]})}),Object(n.jsx)(C,{label:"Amount",children:Object(n.jsx)(x.a,{placeholder:"Amount",type:"number",value:Math.abs(a.amount),onChange:function(e){s(Object(r.a)(Object(r.a)({},a),{},{amount:Math.abs(e.target.value)}))},disabled:m})})]}),Object(n.jsx)(C,{label:"Time Stamp",children:Object(n.jsx)(u.a,{disabled:m,value:A.a.unix(a.timestamp),showTime:{format:"hh:mm A"},format:"DD MMM YYYY, hh:mm A",allowClear:!1,onChange:function(e){s(Object(r.a)(Object(r.a)({},a),{},{timestamp:e.unix()}))}})}),Object(n.jsx)(C,{label:"Tags",children:Object(n.jsx)(f.a,{mode:"multiple",placeholder:"Tags",value:a.tags,style:{width:"100%",minWidth:"200px"},onChange:function(e){s(Object(r.a)(Object(r.a)({},a),{},{tags:e}))},disabled:m,dropdownRender:function(e){return Object(n.jsxs)(n.Fragment,{children:[e,Object(n.jsx)(b.a,{style:{margin:"8px 0"}}),Object(n.jsxs)(w.b,{style:{padding:"0 8px 4px"},children:[Object(n.jsx)(x.a,{placeholder:"Add Tag",value:G,onChange:function(e){L(e.target.value)},disabled:m,width:"100%"}),Object(n.jsx)(p.a,{onClick:function(){J()},children:"Add"})]})]})},children:c.map((function(e){return Object(n.jsx)(f.a.Option,{value:e.key,children:e.tag},e.key)}))})})]})})}function L(e){e.tags;var t=e.tagsMap,a=e.filteredTransactions,c=S.a.useState([]),i=Object(d.a)(c,2),r=i[0],o=i[1];return S.a.useEffect((function(){var e,n={},c=Object(s.a)(a);try{for(c.s();!(e=c.n()).done;){var i=e.value;if(!(i.amount>0)){var r,l=Object(s.a)(i.tags);try{for(l.s();!(r=l.n()).done;){var d,u=r.value;if(!n[u])n[u]={key:u,tag:null===(d=t[u])||void 0===d?void 0:d.tag,amount:0};n[u].amount+=Math.abs(i.amount)}}catch(p){l.e(p)}finally{l.f()}}}}catch(p){c.e(p)}finally{c.f()}o(Object.values(n))}),[t,a]),Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("h3",{style:{color:"#fff"},children:"Tag Wise Graph (Expenses)"}),Object(n.jsx)(M.a,{data:r,xField:"amount",yField:"tag",legend:!0,label:{content:function(e){return e.amount},offset:10},minBarWidth:30,maxBarWidth:30,style:{maxWidth:"100%",height:"100%",margin:"auto"}})]})}}}]);
//# sourceMappingURL=28.e6b7e319.chunk.js.map